<?php
error_reporting(0);
defined('BASEPATH') OR exit('No direct script access allowed'); 

include(dirname(dirname(__FILE__)).'/Tglindo.php');
require_once(APPPATH.'controllers/Secure_area.php');
 
class Curilaporan extends Secure_area {
    public function __construct() {
            parent::__construct(); 
            // $this->load->model('ina-cbg/M_irj','',TRUE);
            // $this->load->model('ina-cbg/M_iri','',TRUE);
            $this->load->model('irj/rjmpelayanan','',TRUE); 
            $this->load->model('lab/labmdaftar','',TRUE); 
            $this->load->model('urikes/Murikes','',TRUE);
            $this->load->model('irj/rjmpencarian','',TRUE);
            $this->load->helper('pdf_helper');    
            $this->load->helper('tgl_indo_helper');      
        }

    
    public function index()
    {
        $data['title'] = 'Daftar Pasien urikes';
        $data['data_pasien']="";
        $this->load->view('urikes/vurikes',$data);
        
    }
 
   


    public function data_lap($tampil_per='', $param1='')
    {
        $data['title'] = 'Laporan Rekapitulasi Urikes';               

        $tgl_indo=new Tglindo();

        $data['date_title']='<b>'.date("d F Y").'</b>';
        $data['tgl']=date("Y-m-d");

        $data['message_nodata']="<div class=\"content-header\">
            <div class=\"alert alert-danger alert-dismissable\">
                <button class=\"close\" aria-hidden=\"true\" data-dismiss=\"alert\" type=\"button\">×</button>              
            <h4><i class=\"icon fa fa-close\"></i>
                Silahkan Pilih Tanggal dan Download untuk Melihat Laporan Rekapitulasi.
            </h4>                           
            </div>
        </div>";

        $this->load->view('urikes/vlaporan',$data);
    }



   

    static function SaveViaTempFile($objWriter){
        $filePath = sys_get_temp_dir() . "/" . rand(0, getrandmax()) . rand(0, getrandmax()) . ".tmp";
        $objWriter->save($filePath);
        readfile($filePath);
        unlink($filePath);
    }
   
    function download_laporan()
    {   
        $result = $this->Murikes->download_laporan(); 
        

        $this->load->view('urikes/vurikes_tes',$data);
    }

    //KHUSUS MABESAL DAN PUSHIDROSAL 
    public function download_lap_bul($param1='',$param2='',$tingkatan=''){
        ////EXCEL 
        $this->load->library('Excel');  
           
        // Create new PHPExcel object  
        $objPHPExcel = new PHPExcel();   
           
        // Set document properties  
        $objPHPExcel->getProperties()->setCreator("RSAL Mintohardjo")  
                ->setLastModifiedBy("RSAL Mintohardjo")  
                ->setTitle("Laporan Rekapitulasi RSAL Mintohardjo")  
                ->setSubject("Laporan Rekapitulasi RSAL Mintohardjo Document")  
                ->setDescription("Laporan Rekapitulasi RSAL Mintohardjo, generated by HMIS.")  
                ->setKeywords("RSAL Mintohardjo")  
                ->setCategory("Laporan Rekapitulasi Urikkes");  

        //$objReader = PHPExcel_IOFactory::createReader('Excel2007');    
        //$objPHPExcel = $objReader->load("project.xlsx");
           
        $objReader= PHPExcel_IOFactory::createReader('Excel2007');
        $objReader->setReadDataOnly(true);

        // $awal = $this->input->post('tanggal_awal');
        // $akhir = $this->input->post('tanggal_akhir');

        $tahun=date('Y');
        $bulan=date('m');
        switch ($bulan) {
            case '1':
                $blnrmw='I';
                break;
            case '2':
                $blnrmw='II';
                break;
            case '3':
                $blnrmw='III';
                break;
            case '4':
                $blnrmw='IV';
                break;
            case '5':
                $blnrmw='V';
                break;
            case '6':
                $blnrmw='VI';
                break;
            case '7':
                $blnrmw='VII';
                break;
            case '8':
                $blnrmw='VIII';
                break;
            case '9':
                $blnrmw='IX';
                break;
            case '10':
                $blnrmw='X';
                break;
            case '11':
                $blnrmw='XI';
                break;
            case '12':
                $blnrmw='XII';
                break;
            default:
                break;
        }
        $tanggal=date('d F Y'); 

        //$data_keuangan=$this->Murikes->data_rekapitulasi($param1, $param2 )->result();
    
        $objPHPExcel=$objReader->load(APPPATH.'third_party/laporan_bulanan_urikes.xlsx');
        // Set active sheet index to the first sheet, so Excel opens this as the first sheet  
        $objPHPExcel->setActiveSheetIndex(0);  
        // Add some data  
        $objPHPExcel->getActiveSheet()->mergeCells('A2:C2');
        $objPHPExcel->getActiveSheet()->getStyle('A2')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('A3:C3');
        $objPHPExcel->getActiveSheet()->getStyle('A3')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);

        $objPHPExcel->getActiveSheet()->mergeCells('N2:O2');
        $objPHPExcel->getActiveSheet()->getColumnDimension('N')->setAutoSize(true);
        $objPHPExcel->getActiveSheet()->SetCellValue('o3', "R/     / ".$blnrmw." / ".$tahun);
        $objPHPExcel->getActiveSheet()->getStyle('o3')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet()->SetCellValue('o4', " " .$tanggal);
        $objPHPExcel->getActiveSheet()->getStyle('o4')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet()->mergeCells('A6:O6');
        $objPHPExcel->getActiveSheet()->getStyle('A6')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->SetCellValue('H9', "MABESAL");
        $objPHPExcel->getActiveSheet()->SetCellValue('H10', "".$tingkatan);
        $objPHPExcel->getActiveSheet()->SetCellValue('H8', "".date('F Y'));
        $objPHPExcel->getActiveSheet()->mergeCells('A13:O13');
        $objPHPExcel->getActiveSheet()->SetCellValue('A13', "INTENSIF I");
        $objPHPExcel->getActiveSheet()->getStyle('A13')->getFont()->setBold(true);




        $result = $this->Murikes->getdata_laporan_bulanan($param1, $param2)->result();
         $no=1; $rowCount = 14;
        
        foreach($result as $key) {
            $intensif=strtoupper($key->intensif);
            if ($intensif=='INTENSIF I') {
               
            $objPHPExcel->getActiveSheet()->setCellValue('A'.$rowCount, $no++);
            $objPHPExcel->getActiveSheet()->setCellValue('B'.$rowCount, $key->nama);
            $objPHPExcel->getActiveSheet()->setCellValue('C'.$rowCount, $key->umur);
            $objPHPExcel->getActiveSheet()->getStyle('D'.$rowCount)->getAlignment()->setWrapText(TRUE);
            $objPHPExcel->getActiveSheet()->setCellValue('D'.$rowCount, $key->nm_pangkat. "\n".$key->nip);
            $objPHPExcel->getActiveSheet()->setCellValue('E'.$rowCount, $key->kesatuan_gab);
            $objPHPExcel->getActiveSheet()->setCellValue('F'.$rowCount, date('d-m-Y', strtotime($key->tgl_pemeriksaan)));
            $objPHPExcel->getActiveSheet()->setCellValue('G'.$rowCount, $key->sf_umum);
            $objPHPExcel->getActiveSheet()->setCellValue('H'.$rowCount, $key->sf_atas);
            $objPHPExcel->getActiveSheet()->setCellValue('I'.$rowCount, $key->sf_bawah);
            $objPHPExcel->getActiveSheet()->setCellValue('J'.$rowCount, $key->sf_dengar);
            $objPHPExcel->getActiveSheet()->setCellValue('K'.$rowCount, $key->sf_lihat);
            $objPHPExcel->getActiveSheet()->setCellValue('L'.$rowCount, $key->sf_gigi);
            $objPHPExcel->getActiveSheet()->setCellValue('M'.$rowCount, $key->sf_jiwa);
            $objPHPExcel->getActiveSheet()->setCellValue('N'.$rowCount, $key->statkes);
            $objPHPExcel->getActiveSheet()->setCellValue('O'.$rowCount, strip_tags($key->kesimpulan_saran));
             $rowCount++;
            }
       }    
            $objPHPExcel->getActiveSheet()->mergeCells('A'.$rowCount.':O'.$rowCount);
             $objPHPExcel->getActiveSheet()->SetCellValue('A'.$rowCount, "INTENSIF II");
            $objPHPExcel->getActiveSheet()->getStyle('A'.$rowCount)->getFont()->setBold(true);
            $rowCount++;

            $nos=1;
        foreach($result as $key) {
            $intensif=strtoupper($key->intensif);
            if ($intensif=='INTENSIF II') {
               
            $objPHPExcel->getActiveSheet()->setCellValue('A'.$rowCount, $nos++);
            $objPHPExcel->getActiveSheet()->setCellValue('B'.$rowCount, $key->nama);
            $objPHPExcel->getActiveSheet()->setCellValue('C'.$rowCount, $key->umur);
            $objPHPExcel->getActiveSheet()->getStyle('D'.$rowCount)->getAlignment()->setWrapText(TRUE);
            $objPHPExcel->getActiveSheet()->setCellValue('D'.$rowCount, $key->nm_pangkat. "\n".$key->nip);
            $objPHPExcel->getActiveSheet()->setCellValue('E'.$rowCount, $key->kesatuan_gab);
            $objPHPExcel->getActiveSheet()->setCellValue('F'.$rowCount, date('d-m-Y', strtotime($key->tgl_pemeriksaan)));
            $objPHPExcel->getActiveSheet()->setCellValue('G'.$rowCount, $key->sf_umum);
            $objPHPExcel->getActiveSheet()->setCellValue('H'.$rowCount, $key->sf_atas);
            $objPHPExcel->getActiveSheet()->setCellValue('I'.$rowCount, $key->sf_bawah);
            $objPHPExcel->getActiveSheet()->setCellValue('J'.$rowCount, $key->sf_dengar);
            $objPHPExcel->getActiveSheet()->setCellValue('K'.$rowCount, $key->sf_lihat);
            $objPHPExcel->getActiveSheet()->setCellValue('L'.$rowCount, $key->sf_gigi);
            $objPHPExcel->getActiveSheet()->setCellValue('M'.$rowCount, $key->sf_jiwa);
            $objPHPExcel->getActiveSheet()->setCellValue('N'.$rowCount, $key->statkes);
            $objPHPExcel->getActiveSheet()->setCellValue('O'.$rowCount, strip_tags($key->kesimpulan_saran));
             $rowCount++;
            }
            
        }

             $objPHPExcel->getActiveSheet()->mergeCells('A'.$rowCount.':O'.$rowCount);
             $objPHPExcel->getActiveSheet()->SetCellValue('A'.$rowCount, "INTENSIF III");
            $objPHPExcel->getActiveSheet()->getStyle('A'.$rowCount)->getFont()->setBold(true);
            $rowCount++;
            
            $not=1;
        foreach($result as $key) {
            $intensif=strtoupper($key->intensif);
            if ($intensif=='INTENSIF III') {
                
            $objPHPExcel->getActiveSheet()->setCellValue('A'.$rowCount, $not++);
            $objPHPExcel->getActiveSheet()->setCellValue('B'.$rowCount, $key->nama);
            $objPHPExcel->getActiveSheet()->setCellValue('C'.$rowCount, $key->umur);
            $objPHPExcel->getActiveSheet()->getStyle('D'.$rowCount)->getAlignment()->setWrapText(TRUE);
            $objPHPExcel->getActiveSheet()->setCellValue('D'.$rowCount, $key->nm_pangkat. "\n".$key->nip);
            $objPHPExcel->getActiveSheet()->setCellValue('E'.$rowCount, $key->kesatuan_gab);
            $objPHPExcel->getActiveSheet()->setCellValue('F'.$rowCount, date('d-m-Y', strtotime($key->tgl_pemeriksaan)));
            $objPHPExcel->getActiveSheet()->setCellValue('G'.$rowCount, $key->sf_umum);
            $objPHPExcel->getActiveSheet()->setCellValue('H'.$rowCount, $key->sf_atas);
            $objPHPExcel->getActiveSheet()->setCellValue('I'.$rowCount, $key->sf_bawah);
            $objPHPExcel->getActiveSheet()->setCellValue('J'.$rowCount, $key->sf_dengar);
            $objPHPExcel->getActiveSheet()->setCellValue('K'.$rowCount, $key->sf_lihat);
            $objPHPExcel->getActiveSheet()->setCellValue('L'.$rowCount, $key->sf_gigi);
            $objPHPExcel->getActiveSheet()->setCellValue('M'.$rowCount, $key->sf_jiwa);
            $objPHPExcel->getActiveSheet()->setCellValue('N'.$rowCount, $key->statkes);
            $objPHPExcel->getActiveSheet()->setCellValue('O'.$rowCount, strip_tags($key->kesimpulan_saran));
            $rowCount++;
            }
            
        }

         $objPHPExcel->getActiveSheet()->setTitle('Rekapitulasi Militer');   

         $objPHPExcel->setActiveSheetIndex(1);  
        // Add some data  
        $objPHPExcel->getActiveSheet()->mergeCells('A2:C2');
        $objPHPExcel->getActiveSheet()->getStyle('A2')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('A3:C3');
        $objPHPExcel->getActiveSheet()->getStyle('A3')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);

        // $objPHPExcel->getActiveSheet()->mergeCells('N2:O2');
        $objPHPExcel->getActiveSheet()->getColumnDimension('N')->setAutoSize(true);
        $objPHPExcel->getActiveSheet()->SetCellValue('N2', "Laporan Hasil Pelaksanaan Urikkes");
        $objPHPExcel->getActiveSheet()->SetCellValue('N3', "Nomor : R/      / ".$blnrmw." / ".$tahun);
        $objPHPExcel->getActiveSheet()->getStyle('N3')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet()->SetCellValue('N4', "Tanggal : " .$tanggal);
        $objPHPExcel->getActiveSheet()->getStyle('N4')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        // $objPHPExcel->getActiveSheet()->mergeCells('A6:O6');
        // $objPHPExcel->getActiveSheet()->getStyle('A6')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->SetCellValue('I6', "".date('F Y'));

        $results = $this->Murikes->getdata_laporan_bulanan_umum($param1, $param2)->result();
         $nos=1; $rowCounts = 11;


        foreach($results as $keys) {
            $objPHPExcel->getActiveSheet()->setCellValue('A'.$rowCounts, $nos++);
            $objPHPExcel->getActiveSheet()->setCellValue('B'.$rowCounts, $keys->nama);
            $objPHPExcel->getActiveSheet()->setCellValue('C'.$rowCounts, $keys->umur);
            // $objPHPExcel->getActiveSheet()->getStyle('D'.$rowCount)->getAlignment()->setWrapText(TRUE);
            $objPHPExcel->getActiveSheet()->setCellValue('D'.$rowCounts, $keys->nip);
            $objPHPExcel->getActiveSheet()->setCellValue('E'.$rowCounts, date('d-m-Y', strtotime($keys->tgl_pemeriksaan)));
            $objPHPExcel->getActiveSheet()->setCellValue('F'.$rowCounts, $keys->statkes);
            $objPHPExcel->getActiveSheet()->setCellValue('G'.$rowCounts, $keys->sf_umum);
            $objPHPExcel->getActiveSheet()->setCellValue('H'.$rowCounts, $keys->sf_atas);
            $objPHPExcel->getActiveSheet()->setCellValue('I'.$rowCounts, $keys->sf_bawah);
            $objPHPExcel->getActiveSheet()->setCellValue('J'.$rowCounts, $keys->sf_dengar);
            $objPHPExcel->getActiveSheet()->setCellValue('K'.$rowCounts, $keys->sf_lihat);
            $objPHPExcel->getActiveSheet()->setCellValue('L'.$rowCounts, $keys->sf_gigi);
            $objPHPExcel->getActiveSheet()->setCellValue('M'.$rowCounts, $keys->sf_jiwa);
            $objPHPExcel->getActiveSheet()->setCellValue('N'.$rowCounts, strip_tags($keys->kesimpulan_saran));
             $rowCounts++;
        }
        $objPHPExcel->getActiveSheet()->setTitle('Rekapitulasi umum');    
        
        $filename = "Laporan Lengkap Militer dan Umum".date('d F Y', strtotime($param1))." - ".date('d F Y', strtotime($param2));
        header('Content-Disposition: attachment;filename="'.$filename.'.xls"');  
                
        // Rename worksheet (worksheet, not filename)  
        
           
        // Redirect output to a client’s web browser (Excel2007)  
        //clean the output buffer  
        ob_end_clean();  
           
        //this is the header given from PHPExcel examples.   
        //but the output seems somewhat corrupted in some cases.  
        //header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');  
        //so, we use this header instead.  
        header('Content-type: application/vnd.ms-excel');  
        header('Cache-Control: max-age=0');  
           
        $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');  
        // $objWriter->save('php://output');  
        $this->SaveViaTempFile($objWriter);

        // $awal = $this->input->post('tanggal_awal');
        // $akhir = $this->input->post('tanggal_akhir');
        // $data_keuangan=$this->Labmlaporan->get_data_keu_tind($awal, $akhir)->result();
        // echo json_encode($data_keuangan);
    }

    //KHUSUS MT
    public function laporan_khusus_mt($param1='',$param2=''){
        ////EXCEL 
        $this->load->library('Excel');  
           
        // Create new PHPExcel object  
        $objPHPExcel = new PHPExcel();   
           
        // Set document properties  
        $objPHPExcel->getProperties()->setCreator("RSAL Mintohardjo")  
                ->setLastModifiedBy("RSAL Mintohardjo")  
                ->setTitle("Laporan Rekapitulasi RSAL Mintohardjo")  
                ->setSubject("Laporan Rekapitulasi RSAL Mintohardjo Document")  
                ->setDescription("Laporan Rekapitulasi RSAL Mintohardjo, generated by HMIS.")  
                ->setKeywords("RSAL Mintohardjo")  
                ->setCategory("Laporan Rekapitulasi Urikkes");  

        //$objReader = PHPExcel_IOFactory::createReader('Excel2007');    
        //$objPHPExcel = $objReader->load("project.xlsx");
           
        $objReader= PHPExcel_IOFactory::createReader('Excel2007');
        $objReader->setReadDataOnly(true);

        // $awal = $this->input->post('tanggal_awal');
        // $akhir = $this->input->post('tanggal_akhir');

        $tahun=date('Y');
        $bulan=date('m');
        switch ($bulan) {
            case '1':
                $blnrmw='I';
                break;
            case '2':
                $blnrmw='II';
                break;
            case '3':
                $blnrmw='III';
                break;
            case '4':
                $blnrmw='IV';
                break;
            case '5':
                $blnrmw='V';
                break;
            case '6':
                $blnrmw='VI';
                break;
            case '7':
                $blnrmw='VII';
                break;
            case '8':
                $blnrmw='VIII';
                break;
            case '9':
                $blnrmw='IX';
                break;
            case '10':
                $blnrmw='X';
                break;
            case '11':
                $blnrmw='XI';
                break;
            case '12':
                $blnrmw='XII';
                break;
            default:
                break;
        }
        $tanggal=date('d F Y'); 

        //$data_keuangan=$this->Murikes->data_rekapitulasi($param1, $param2 )->result();
    
        $objPHPExcel=$objReader->load(APPPATH.'third_party/laporan_bulanan_urikes.xlsx');
        // Set active sheet index to the first sheet, so Excel opens this as the first sheet  
        $objPHPExcel->setActiveSheetIndex(0);  
        // Add some data  
        $objPHPExcel->getActiveSheet()->mergeCells('A2:C2');
        $objPHPExcel->getActiveSheet()->getStyle('A2')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('A3:C3');
        $objPHPExcel->getActiveSheet()->getStyle('A3')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);

        $objPHPExcel->getActiveSheet()->mergeCells('N2:O2');
        $objPHPExcel->getActiveSheet()->getColumnDimension('N')->setAutoSize(true);
        $objPHPExcel->getActiveSheet()->SetCellValue('o3', "R/     / ".$blnrmw." / ".$tahun);
        $objPHPExcel->getActiveSheet()->getStyle('o3')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet()->SetCellValue('o4', " " .$tanggal);
        $objPHPExcel->getActiveSheet()->getStyle('o4')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet()->mergeCells('A6:O6');
        $objPHPExcel->getActiveSheet()->getStyle('A6')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->SetCellValue('H9', "MABESAL");
        $objPHPExcel->getActiveSheet()->SetCellValue('H10', "");
        $objPHPExcel->getActiveSheet()->SetCellValue('H8', "".date('F Y'));
        $objPHPExcel->getActiveSheet()->mergeCells('A13:O13');
        $objPHPExcel->getActiveSheet()->SetCellValue('A13', "INTENSIF I");
        $objPHPExcel->getActiveSheet()->getStyle('A13')->getFont()->setBold(true);




        $result = $this->Murikes->getdata_laporan_bulanan_mt($param1, $param2)->result();
         $no=1; $rowCount = 14;
        
        foreach($result as $key) {
            $intensif=strtoupper($key->intensif);
            if ($intensif=='INTENSIF I') {
               
            $objPHPExcel->getActiveSheet()->setCellValue('A'.$rowCount, $no++);
            $objPHPExcel->getActiveSheet()->setCellValue('B'.$rowCount, $key->nama);
            $objPHPExcel->getActiveSheet()->setCellValue('C'.$rowCount, $key->umur);
            $objPHPExcel->getActiveSheet()->getStyle('D'.$rowCount)->getAlignment()->setWrapText(TRUE);
            $objPHPExcel->getActiveSheet()->setCellValue('D'.$rowCount, $key->nm_pangkat. "\n".$key->nip);
            $objPHPExcel->getActiveSheet()->setCellValue('E'.$rowCount, $key->kesatuan_gab);
            $objPHPExcel->getActiveSheet()->setCellValue('F'.$rowCount, date('d-m-Y', strtotime($key->tgl_pemeriksaan)));
            $objPHPExcel->getActiveSheet()->setCellValue('G'.$rowCount, $key->sf_umum);
            $objPHPExcel->getActiveSheet()->setCellValue('H'.$rowCount, $key->sf_atas);
            $objPHPExcel->getActiveSheet()->setCellValue('I'.$rowCount, $key->sf_bawah);
            $objPHPExcel->getActiveSheet()->setCellValue('J'.$rowCount, $key->sf_dengar);
            $objPHPExcel->getActiveSheet()->setCellValue('K'.$rowCount, $key->sf_lihat);
            $objPHPExcel->getActiveSheet()->setCellValue('L'.$rowCount, $key->sf_gigi);
            $objPHPExcel->getActiveSheet()->setCellValue('M'.$rowCount, $key->sf_jiwa);
            $objPHPExcel->getActiveSheet()->setCellValue('N'.$rowCount, $key->statkes);
            $objPHPExcel->getActiveSheet()->setCellValue('O'.$rowCount, strip_tags($key->kesimpulan_saran));
             $rowCount++;
            }
       }    
            $objPHPExcel->getActiveSheet()->mergeCells('A'.$rowCount.':O'.$rowCount);
             $objPHPExcel->getActiveSheet()->SetCellValue('A'.$rowCount, "INTENSIF II");
            $objPHPExcel->getActiveSheet()->getStyle('A'.$rowCount)->getFont()->setBold(true);
            $rowCount++;

            $nos=1;
        foreach($result as $key) {
            $intensif=strtoupper($key->intensif);
            if ($intensif=='INTENSIF II') {
               
            $objPHPExcel->getActiveSheet()->setCellValue('A'.$rowCount, $nos++);
            $objPHPExcel->getActiveSheet()->setCellValue('B'.$rowCount, $key->nama);
            $objPHPExcel->getActiveSheet()->setCellValue('C'.$rowCount, $key->umur);
            $objPHPExcel->getActiveSheet()->getStyle('D'.$rowCount)->getAlignment()->setWrapText(TRUE);
            $objPHPExcel->getActiveSheet()->setCellValue('D'.$rowCount, $key->nm_pangkat. "\n".$key->nip);
            $objPHPExcel->getActiveSheet()->setCellValue('E'.$rowCount, $key->kesatuan_gab);
            $objPHPExcel->getActiveSheet()->setCellValue('F'.$rowCount, date('d-m-Y', strtotime($key->tgl_pemeriksaan)));
            $objPHPExcel->getActiveSheet()->setCellValue('G'.$rowCount, $key->sf_umum);
            $objPHPExcel->getActiveSheet()->setCellValue('H'.$rowCount, $key->sf_atas);
            $objPHPExcel->getActiveSheet()->setCellValue('I'.$rowCount, $key->sf_bawah);
            $objPHPExcel->getActiveSheet()->setCellValue('J'.$rowCount, $key->sf_dengar);
            $objPHPExcel->getActiveSheet()->setCellValue('K'.$rowCount, $key->sf_lihat);
            $objPHPExcel->getActiveSheet()->setCellValue('L'.$rowCount, $key->sf_gigi);
            $objPHPExcel->getActiveSheet()->setCellValue('M'.$rowCount, $key->sf_jiwa);
            $objPHPExcel->getActiveSheet()->setCellValue('N'.$rowCount, $key->statkes);
            $objPHPExcel->getActiveSheet()->setCellValue('O'.$rowCount, strip_tags($key->kesimpulan_saran));
             $rowCount++;
            }
            
        }

             $objPHPExcel->getActiveSheet()->mergeCells('A'.$rowCount.':O'.$rowCount);
             $objPHPExcel->getActiveSheet()->SetCellValue('A'.$rowCount, "INTENSIF III");
            $objPHPExcel->getActiveSheet()->getStyle('A'.$rowCount)->getFont()->setBold(true);
            $rowCount++;
            
            $not=1;
        foreach($result as $key) {
            $intensif=strtoupper($key->intensif);
            if ($intensif=='INTENSIF III') {
                
            $objPHPExcel->getActiveSheet()->setCellValue('A'.$rowCount, $not++);
            $objPHPExcel->getActiveSheet()->setCellValue('B'.$rowCount, $key->nama);
            $objPHPExcel->getActiveSheet()->setCellValue('C'.$rowCount, $key->umur);
            $objPHPExcel->getActiveSheet()->getStyle('D'.$rowCount)->getAlignment()->setWrapText(TRUE);
            $objPHPExcel->getActiveSheet()->setCellValue('D'.$rowCount, $key->nm_pangkat. "\n".$key->nip);
            $objPHPExcel->getActiveSheet()->setCellValue('E'.$rowCount, $key->kesatuan_gab);
            $objPHPExcel->getActiveSheet()->setCellValue('F'.$rowCount, date('d-m-Y', strtotime($key->tgl_pemeriksaan)));
            $objPHPExcel->getActiveSheet()->setCellValue('G'.$rowCount, $key->sf_umum);
            $objPHPExcel->getActiveSheet()->setCellValue('H'.$rowCount, $key->sf_atas);
            $objPHPExcel->getActiveSheet()->setCellValue('I'.$rowCount, $key->sf_bawah);
            $objPHPExcel->getActiveSheet()->setCellValue('J'.$rowCount, $key->sf_dengar);
            $objPHPExcel->getActiveSheet()->setCellValue('K'.$rowCount, $key->sf_lihat);
            $objPHPExcel->getActiveSheet()->setCellValue('L'.$rowCount, $key->sf_gigi);
            $objPHPExcel->getActiveSheet()->setCellValue('M'.$rowCount, $key->sf_jiwa);
            $objPHPExcel->getActiveSheet()->setCellValue('N'.$rowCount, $key->statkes);
            $objPHPExcel->getActiveSheet()->setCellValue('O'.$rowCount, strip_tags($key->kesimpulan_saran));
            $rowCount++;
            }
            
        }

        
        $filename = "Laporan Hasil Uji".date('d F Y', strtotime($param1))." - ".date('d F Y', strtotime($param2));
        header('Content-Disposition: attachment;filename="'.$filename.'.xls"');  
                
        // Rename worksheet (worksheet, not filename)  
        $objPHPExcel->getActiveSheet()->setTitle('RSAL Mintohardjo');    
           
        // Redirect output to a client’s web browser (Excel2007)  
        //clean the output buffer  
        ob_end_clean();  
           
        //this is the header given from PHPExcel examples.   
        //but the output seems somewhat corrupted in some cases.  
        //header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');  
        //so, we use this header instead.  
        header('Content-type: application/vnd.ms-excel');  
        header('Cache-Control: max-age=0');  
           
        $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');  
        // $objWriter->save('php://output');  
        $this->SaveViaTempFile($objWriter);

        // $awal = $this->input->post('tanggal_awal');
        // $akhir = $this->input->post('tanggal_akhir');
        // $data_keuangan=$this->Labmlaporan->get_data_keu_tind($awal, $akhir)->result();
        // echo json_encode($data_keuangan);
    }

    // REKAPITULASI URIKES khusus mabes 
    public function download_rekap_khusus_mabes($param1='',$param2=''){
        ////EXCEL 
        $this->load->library('Excel');  
           
        // Create new PHPExcel object  
        $objPHPExcel = new PHPExcel();   
           
        // Set document properties  
        $objPHPExcel->getProperties()->setCreator("RSAL Mintohardjo")  
                ->setLastModifiedBy("RSAL Mintohardjo")  
                ->setTitle("Laporan Rekapitulasi RSAL Mintohardjo")  
                ->setSubject("Laporan Rekapitulasi RSAL Mintohardjo Document")  
                ->setDescription("Laporan Rekapitulasi RSAL Mintohardjo, generated by HMIS.")  
                ->setKeywords("RSAL Mintohardjo")  
                ->setCategory("Laporan Rekapitulasi Urikkes");  

        //$objReader = PHPExcel_IOFactory::createReader('Excel2007');    
        //$objPHPExcel = $objReader->load("project.xlsx");
           
        $objReader= PHPExcel_IOFactory::createReader('Excel2007');
        $objReader->setReadDataOnly(true);

        // $awal = $this->input->post('tanggal_awal');
        // $akhir = $this->input->post('tanggal_akhir');

        $tahun=date('Y');
        $bulan=date('m');
        switch ($bulan) {
            case '1':
                $blnrmw='I';
                break;
            case '2':
                $blnrmw='II';
                break;
            case '3':
                $blnrmw='III';
                break;
            case '4':
                $blnrmw='IV';
                break;
            case '5':
                $blnrmw='V';
                break;
            case '6':
                $blnrmw='VI';
                break;
            case '7':
                $blnrmw='VII';
                break;
            case '8':
                $blnrmw='VIII';
                break;
            case '9':
                $blnrmw='IX';
                break;
            case '10':
                $blnrmw='X';
                break;
            case '11':
                $blnrmw='XI';
                break;
            case '12':
                $blnrmw='XII';
                break;
            default:
                break;
        }
        $tanggal=date('d F Y'); 

        //$data_keuangan=$this->Murikes->data_rekapitulasi($param1, $param2 )->result();
    
        $objPHPExcel=$objReader->load(APPPATH.'third_party/rek_usia_urikes.xlsx');
        // Set active sheet index to the first sheet, so Excel opens this as the first sheet  
        $objPHPExcel->setActiveSheetIndex(0);  
        // Add some data  

        
        $objPHPExcel->getActiveSheet(0)->getStyle('A10:A13')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        // $objPHPExcel->getActiveSheet()->getStyle('F10:F13')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        // $objPHPExcel->getActiveSheet()->getStyle('I10:I13')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet(0)->mergeCells('A15:A16');
        $objPHPExcel->getActiveSheet(0)->getStyle('A15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet(0)->mergeCells('B15:Q15');
        $objPHPExcel->getActiveSheet()->getStyle('B15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('R15:AA15');
        $objPHPExcel->getActiveSheet()->getStyle('L15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('B16:H16');
        $objPHPExcel->getActiveSheet()->getStyle('B16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('J16:P16');
        $objPHPExcel->getActiveSheet()->getStyle('J16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('R16:U16');
        $objPHPExcel->getActiveSheet()->getStyle('R16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('W16:Z16');
        $objPHPExcel->getActiveSheet()->getStyle('W16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('I16:I17');
        $objPHPExcel->getActiveSheet()->getStyle('I16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('Q16:Q17');
        $objPHPExcel->getActiveSheet()->getStyle('Q16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('V16:V17');  
        $objPHPExcel->getActiveSheet()->getStyle('V16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);        
        $objPHPExcel->getActiveSheet()->mergeCells('AA16:AA17');  
        $objPHPExcel->getActiveSheet()->getStyle('AA16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);       
        $objPHPExcel->getActiveSheet()->mergeCells('AB16:AB17');  
        $objPHPExcel->getActiveSheet()->getStyle('AB16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);        
                

         $result = $this->Murikes->get_rek_mabesal($param1,$param2)->result();
      
        $count_bintara_1 = '';
        $count_bintara_2p = '';
        $count_bintara_2 = '';
        $count_bintara_3p = '';
        $count_bintara_3 = '';
        $count_bintara_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'BINTARA' && $row->statkes == 'I' && ($row->umur>='35' && $row->umur<='45')) {
                $count_bintara_1++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'II P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_bintara_2p++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'II' && ($row->umur>='35' && $row->umur<='45')) {
                $count_bintara_2++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'III P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_bintara_3p++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'III III' && ($row->umur>='35' && $row->umur<='45')) {
                $count_bintara_3++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == ' IV' && ($row->umur>='35' && $row->umur<='45')) {
                $count_bintara_4++;
            }
        }
        $count_tamtama_1 = '';
        $count_tamtama_2p = '';
        $count_tamtama_2 = '';
        $count_tamtama_3p = '';
        $count_tamtama_3 = '';
        $count_tamtama_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'I' && ($row->umur>='35' && $row->umur<='45')) {
                $count_tamtama_1++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'II P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_tamtama_2p++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'II' && ($row->umur>='35' && $row->umur<='45')) {
                $count_tamtama_2++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'III P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_tamtama_3p++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'III III' && ($row->umur>='35' && $row->umur<='45')) {
                $count_tamtama_3++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == ' IV' && ($row->umur>='35' && $row->umur<='45')) {
                $count_tamtama_4++;
            }
        }
       
        $count_gol4a_1 = '';
        $count_gol4a_2p = '';
        $count_gol4a_2 = '';
        $count_gol4a_3p = '';
        $count_gol4a_3 = '';
        $count_gol4a_4 = '';

        foreach ($result as $row) {
            if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'I' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol4a_1++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'II P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol4a_2p++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'II' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol4a_2++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'III P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol4a_3p++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && ($row->statkes == 'III' || $row->statkes == 'III III')  && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol4a_3++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == ' IV' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol4a_4++;
            }
        }
        $count_gol3_1 = '';
        $count_gol3_2p = '';
        $count_gol3_2 = '';
        $count_gol3_3p = '';
        $count_gol3_3 = '';
        $count_gol3_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL III' && $row->statkes == 'I' && ($row->umur>='35' && $row->umur<='45')) {
                $countgol3_1++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'II P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol3_2p++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'II' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol3_2++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'III P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol3_3p++;
            } else if ($row->tingkatan == 'GOL III' && ($row->statkes == 'III' || $row->statkes == 'III III') && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol3_3++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == ' IV' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol3_4++;
            }
        }
        $count_gol2_1 = '';
        $count_gol2_2p = '';
        $count_gol2_2 = '';
        $count_gol2_3p = '';
        $count_gol2_3 = '';
        $count_gol2_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL II' && $row->statkes == 'I' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol2_1++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'II P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol2_2p++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'II' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol2_2++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'III P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol2_3p++;
            } else if ($row->tingkatan == 'GOL II' && ($row->statkes == 'III' || $row->statkes == 'III III') && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol2_3++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == ' IV' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol2_4++;
            }
        }
        $count_gol1_1 = '';
        $count_gol1_2p = '';
        $count_gol1_2 = '';
        $count_gol1_3p = '';
        $count_gol1_3 = '';
        $count_gol1_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL I' && $row->statkes == 'I' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol1_1++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'II P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol1_2p++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'II' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol1_2++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'III P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol1_3p++;
            } else if ($row->tingkatan == 'GOL I' && ($row->statkes == 'III' || $row->statkes == 'III III') && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol1_3++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == ' IV' && ($row->umur>='35' && $row->umur<='45')) {
                $count_gol1_4++;
            }
        }

       
        $count_letkol_1 = '';
        $count_letkol_2 = '';
        $count_letkol_2p = '';
        $count_letkol_3p = '';
        $count_letkol_3 = '';
        $count_letkol_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '3' && $row->statkes == 'III P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_letkol_3p++;
            } else if ($row->urutan == '3' && $row->statkes == 'II P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_letkol_2p++;
            }
            else if ($row->urutan == '3' && $row->statkes == 'II' && ($row->umur>='35' && $row->umur<='45')) {
                $count_letkol_2++;
            }
            else if ($row->urutan == '3' && ($row->statkes == 'III' || $row->statkes == 'III III') && ($row->umur>='35' && $row->umur<='45')) {
                $count_letkol_3++;
            }
            else if ($row->urutan == '3' && $row->statkes == 'I' && ($row->umur>='35' && $row->umur<='45')) {
                $count_letkol_1++;
            }
            else if ($row->urutan == '3' && $row->statkes == ' IV' && ($row->umur>='35' && $row->umur<='45')) {
                $count_letkol_4++;
            }
        }


         $count_mayor_1 = '';
        $count_mayor_2 = '';
        $count_mayor_2p = '';
        $count_mayor_3p = '';
        $count_mayor_3 = '';
        $count_mayor_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '4' && $row->statkes == 'III P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_mayor_3p++;
            } else if ($row->urutan == '4' && $row->statkes == 'II P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_mayor_2p++;
            }
            else if ($row->urutan == '4' && $row->statkes == 'II' && ($row->umur>='35' && $row->umur<='45')) {
                $count_mayor_2++;
            }
            else if ($row->urutan == '4' && ($row->statkes == 'III' || $row->statkes == 'III III') && ($row->umur>='35' && $row->umur<='45')) {
                $count_mayor_3++;
            }
            else if ($row->urutan == '4' && $row->statkes == 'I' && ($row->umur>='35' && $row->umur<='45')) {
                $count_mayor_1++;
            }
            else if ($row->urutan == '4' && $row->statkes == ' IV' && ($row->umur>='35' && $row->umur<='45')) {
                $count_mayor_4++;
            }
        }
         $count_kapten_1 = '';
        $count_kapten_2 = '';
        $count_kapten_2p = '';
        $count_kapten_3p = '';
        $count_kapten_3 = '';
        $count_kapten_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '5' && $row->statkes == 'III P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_kapten_3p++;
            } else if ($row->urutan == '5' && $row->statkes == 'II P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_kapten_2p++;
            }
            else if ($row->urutan == '5' && $row->statkes == 'II' && ($row->umur>='35' && $row->umur<='45')) {
                $count_kapten_2++;
            }
            else if ($row->urutan == '5' && ($row->statkes == 'III' || $row->statkes == 'III III') && ($row->umur>='35' && $row->umur<='45')) {
                $count_kapten_3++;
            }
            else if ($row->urutan == '5' && $row->statkes == 'I' && ($row->umur>='35' && $row->umur<='45')) {
                $count_kapten_1++;
            }
            else if ($row->urutan == '5' && $row->statkes == ' IV' && ($row->umur>='35' && $row->umur<='45')) {
                $count_kapten_4++;
            }
        }
         $count_lettu_1 = '';
        $count_lettu_2 = '';
        $count_lettu_2p = '';
        $count_lettu_3p = '';
        $count_lettu_3 = '';
        $count_lettu_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '6' && $row->statkes == 'III P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_lettu_3p++;
            } else if ($row->urutan == '6' && $row->statkes == 'II P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_lettu_2p++;
            }
            else if ($row->urutan == '6' && $row->statkes == 'II' && ($row->umur>='35' && $row->umur<='45')) {
                $count_lettu_2++;
            }
            else if ($row->urutan == '6' && ($row->statkes == 'III' || $row->statkes == 'III III') && ($row->umur>='35' && $row->umur<='45')) {
                $count_lettu_3++;
            }
            else if ($row->urutan == '6' && $row->statkes == 'I' && ($row->umur>='35' && $row->umur<='45')) {
                $count_lettu_1++;
            }
            else if ($row->urutan == '6' && $row->statkes == ' IV' && ($row->umur>='35' && $row->umur<='45')) {
                $count_lettu_4++;
            }
        }
         $count_letda_1 = '';
        $count_letda_2 = '';
        $count_letda_2p = '';
        $count_letda_3p = '';
        $count_letda_3 = '';
        $count_letda_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '7' && $row->statkes == 'III P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_letda_3p++;
            } else if ($row->urutan == '7' && $row->statkes == 'II P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_letda_2p++;
            }
            else if ($row->urutan == '7' && $row->statkes == 'II' && ($row->umur>='35' && $row->umur<='45')) {
                $count_letda_2++;
            }
            else if ($row->urutan == '7' && ($row->statkes == 'III' || $row->statkes == 'III III') && ($row->umur>='35' && $row->umur<='45')) {
                $count_letda_3++;
            }
            else if ($row->urutan == '7' && $row->statkes == 'I' && ($row->umur>='35' && $row->umur<='45')) {
                $count_letda_1++;
            }
            else if ($row->urutan == '7' && $row->statkes == ' IV' && ($row->umur>='35' && $row->umur<='45')) {
                $count_letda_4++;
            }
        }
        // batas akhir kelompok usia lebih dari sama dengan 35 dan kurang dari sama dengan 45


        $count_bintara_1u = '';
        $count_bintara_2pu = '';
        $count_bintara_2u = '';
        $count_bintara_3pu = '';
        $count_bintara_3u = '';
        $count_bintara_4u = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'BINTARA' && $row->statkes == 'I' && $row->umur<'35') {
                $count_bintara_1u++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'II P' && $row->umur<'35') {
                $count_bintara_2pu++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'II' && $row->umur<'35') {
                $count_bintara_2u++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'III P' && $row->umur<'35') {
                $count_bintara_3pu++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'III III' && $row->umur<'35') {
                $count_bintara_3u++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == ' IV' && $row->umur<'35') {
                $count_bintara_4u++;
            }
        }
        $count_tamtama_1u = '';
        $count_tamtama_2pu = '';
        $count_tamtama_2u = '';
        $count_tamtama_3pu = '';
        $count_tamtama_3u = '';
        $count_tamtama_4u = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'I' && $row->umur<'35') {
                $count_tamtama_1u++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'II P' && $row->umur<'35') {
                $count_tamtama_2pu++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'II' && $row->umur<'35') {
                $count_tamtama_2u++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'III P' && $row->umur<'35') {
                $count_tamtama_3pu++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'III III' && $row->umur<'35') {
                $count_tamtama_3u++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == ' IV' && $row->umur<'35') {
                $count_tamtama_4u++;
            }
        }
       
        $count_gol4a_1u = '';
        $count_gol4a_2pu = '';
        $count_gol4a_2u = '';
        $count_gol4a_3pu = '';
        $count_gol4a_3u = '';
        $count_gol4a_4u = '';

        foreach ($result as $row) {
            if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'I' && $row->umur<'35') {
                $count_gol4a_1u++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'II P' && $row->umur<'35') {
                $count_gol4a_2pu++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'II' && $row->umur<'35') {
                $count_gol4a_2u++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'III P' && $row->umur<'35') {
                $count_gol4a_3pu++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && ($row->statkes == 'III' || $row->statkes == 'III III')  && $row->umur<'35') {
                $count_gol4a_3u++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == ' IV' && $row->umur<'35') {
                $count_gol4a_4u++;
            }
        }
        $count_gol3_1u = '';
        $count_gol3_2pu = '';
        $count_gol3_2u = '';
        $count_gol3_3pu = '';
        $count_gol3_3u = '';
        $count_gol3_4u = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL III' && $row->statkes == 'I' && $row->umur<'35') {
                $countgol3_1u++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'II P' && $row->umur<'35') {
                $count_gol3_2pu++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'II' && $row->umur<'35') {
                $count_gol3_2u++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'III P' && $row->umur<'35') {
                $count_gol3_3pu++;
            } else if ($row->tingkatan == 'GOL III' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur<'35') {
                $count_gol3_3u++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == ' IV' && $row->umur<'35') {
                $count_gol3_4u++;
            }
        }
        $count_gol2_1u = '';
        $count_gol2_2pu = '';
        $count_gol2_2u = '';
        $count_gol2_3pu = '';
        $count_gol2_3u = '';
        $count_gol2_4u = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL II' && $row->statkes == 'I' && $row->umur<'35') {
                $count_gol2_1u++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'II P' && $row->umur<'35') {
                $count_gol2_2pu++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'II' && $row->umur<'35') {
                $count_gol2_2u++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'III P' && $row->umur<'35') {
                $count_gol2_3pu++;
            } else if ($row->tingkatan == 'GOL II' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur<'35') {
                $count_gol2_3u++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == ' IV' && $row->umur<'35') {
                $count_gol2_4u++;
            }
        }
        $count_gol1_1u = '';
        $count_gol1_2pu = '';
        $count_gol1_2u = '';
        $count_gol1_3pu = '';
        $count_gol1_3u = '';
        $count_gol1_4u = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL I' && $row->statkes == 'I' && $row->umur<'35') {
                $count_gol1_1u++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'II P' && $row->umur<'35') {
                $count_gol1_2pu++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'II' && $row->umur<'35') {
                $count_gol1_2u++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'III P' && $row->umur<'35') {
                $count_gol1_3pu++;
            } else if ($row->tingkatan == 'GOL I' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur<'35') {
                $count_gol1_3u++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == ' IV' && $row->umur<'35') {
                $count_gol1_4u++;
            }
        }

       
         $count_letkol_1u = '';
        $count_letkol_2u = '';
        $count_letkol_2pu = '';
        $count_letkol_3pu = '';
        $count_letkol_3u = '';
        $count_letkol_4u = '';

        foreach ($result as $row) {
            if ($row->urutan == '3' && $row->statkes == 'III P' && $row->umur<'35') {
                $count_letkol_3pu++;
            } else if ($row->urutan == '3' && $row->statkes == 'II P' && $row->umur<'35') {
                $count_letkol_2pu++;
            }
            else if ($row->urutan == '3' && $row->statkes == 'II' && $row->umur<'35') {
                $count_letkol_2u++;
            }
            else if ($row->urutan == '3' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur<'35') {
                $count_letkol_3u++;
            }
            else if ($row->urutan == '3' && $row->statkes == 'I' && $row->umur<'35') {
                $count_letkol_1u++;
            }
            else if ($row->urutan == '3' && $row->statkes == ' IV' && $row->umur<'35') {
                $count_letkol_4u++;
            }
        }


         $count_mayor_1u = '';
        $count_mayor_2u = '';
        $count_mayor_2pu = '';
        $count_mayor_3pu = '';
        $count_mayor_3u = '';
        $count_mayor_4u = '';

        foreach ($result as $row) {
            if ($row->urutan == '4' && $row->statkes == 'III P' && $row->umur<'35') {
                $count_mayor_3pu++;
            } else if ($row->urutan == '4' && $row->statkes == 'II P' && $row->umur<'35') {
                $count_mayor_2pu++;
            }
            else if ($row->urutan == '4' && $row->statkes == 'II' && $row->umur<'35') {
                $count_mayor_2u++;
            }
            else if ($row->urutan == '4' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur<'35') {
                $count_mayor_3u++;
            }
            else if ($row->urutan == '4' && $row->statkes == 'I' && $row->umur<'35') {
                $count_mayor_1u++;
            }
            else if ($row->urutan == '4' && $row->statkes == ' IV' && $row->umur<'35') {
                $count_mayor_4u++;
            }
        }
         $count_kapten_1u = '';
        $count_kapten_2u = '';
        $count_kapten_2pu = '';
        $count_kapten_3pu = '';
        $count_kapten_3u = '';
        $count_kapten_4u = '';

        foreach ($result as $row) {
            if ($row->urutan == '5' && $row->statkes == 'III P' && $row->umur<'35') {
                $count_kapten_3pu++;
            } else if ($row->urutan == '5' && $row->statkes == 'II P' && $row->umur<'35') {
                $count_kapten_2pu++;
            }
            else if ($row->urutan == '5' && $row->statkes == 'II' && $row->umur<'35') {
                $count_kapten_2u++;
            }
            else if ($row->urutan == '5' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur<'35') {
                $count_kapten_3u++;
            }
            else if ($row->urutan == '5' && $row->statkes == 'I' && $row->umur<'35') {
                $count_kapten_1u++;
            }
            else if ($row->urutan == '5' && $row->statkes == ' IV' && $row->umur<'35') {
                $count_kapten_4u++;
            }
        }
         $count_lettu_1u = '';
        $count_lettu_2u = '';
        $count_lettu_2pu = '';
        $count_lettu_3pu = '';
        $count_lettu_3u = '';
        $count_lettu_4u = '';

        foreach ($result as $row) {
            if ($row->urutan == '6' && $row->statkes == 'III P' && $row->umur<'35') {
                $count_lettu_3pu++;
            } else if ($row->urutan == '6' && $row->statkes == 'II P' && $row->umur<'35') {
                $count_lettu_2pu++;
            }
            else if ($row->urutan == '6' && $row->statkes == 'II' && $row->umur<'35') {
                $count_lettu_2u++;
            }
            else if ($row->urutan == '6' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur<'35') {
                $count_lettu_3u++;
            }
            else if ($row->urutan == '6' && $row->statkes == 'I' && $row->umur<'35') {
                $count_lettu_1u++;
            }
            else if ($row->urutan == '6' && $row->statkes == ' IV' && $row->umur<'35') {
                $count_lettu_4u++;
            }
        }
         $count_letda_1u = '';
        $count_letda_2u = '';
        $count_letda_2pu = '';
        $count_letda_3pu = '';
        $count_letda_3u = '';
        $count_letda_4u = '';

        foreach ($result as $row) {
            if ($row->urutan == '7' && $row->statkes == 'III P' && $row->umur<'35') {
                $count_letda_3pu++;
            } else if ($row->urutan == '7' && $row->statkes == 'II P' && $row->umur<'35') {
                $count_letda_2pu++;
            }
            else if ($row->urutan == '7' && $row->statkes == 'II' && $row->umur<'35') {
                $count_letda_2u++;
            }
            else if ($row->urutan == '7' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur<'35') {
                $count_letda_3u++;
            }
            else if ($row->urutan == '7' && $row->statkes == 'I' && $row->umur<'35') {
                $count_letda_1u++;
            }
            else if ($row->urutan == '7' && $row->statkes == ' IV' && $row->umur<'35') {
                $count_letda_4u++;
            }
        }
        //Batas akhir data peserta <35 tahun 

        $count_bintara_1t = '';
        $count_bintara_2pt = '';
        $count_bintara_2t = '';
        $count_bintara_3pt = '';
        $count_bintara_3t = '';
        $count_bintara_4t = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'BINTARA' && $row->statkes == 'I' && $row->umur>'45') {
                $count_bintara_1t++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_bintara_2pt++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'II' && $row->umur>'45') {
                $count_bintara_2t++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_bintara_3pt++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'III III' && $row->umur>'45') {
                $count_bintara_3t++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_bintara_4t++;
            }
        }
        $count_tamtama_1t = '';
        $count_tamtama_2pt = '';
        $count_tamtama_2t = '';
        $count_tamtama_3pt = '';
        $count_tamtama_3t = '';
        $count_tamtama_4t = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'I' && $row->umur>'45') {
                $count_tamtama_1t++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_tamtama_2pt++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'II' && $row->umur>'45') {
                $count_tamtama_2t++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_tamtama_3pt++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'III III' && $row->umur>'45') {
                $count_tamtama_3t++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_tamtama_4t++;
            }
        }
       
        $count_gol4a_1t = '';
        $count_gol4a_2pt = '';
        $count_gol4a_2t = '';
        $count_gol4a_3pt = '';
        $count_gol4a_3t = '';
        $count_gol4a_4t = '';

        foreach ($result as $row) {
            if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'I' && $row->umur>'45') {
                $count_gol4a_1t++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'II P' && $row->umur>'45') {
                $count_gol4a_2pt++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'II' && $row->umur>'45') {
                $count_gol4a_2t++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'III P' && $row->umur>'45') {
                $count_gol4a_3pt++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && ($row->statkes == 'III' || $row->statkes == 'III III')  && $row->umur>'45') {
                $count_gol4a_3t++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == ' IV' && $row->umur>'45') {
                $count_gol4a_4t++;
            }
        }
        $count_gol3_2pt = '';
        $count_gol3_1t = '';
        $count_gol3_2t = '';
        $count_gol3_3pt = '';
        $count_gol3_3t = '';
        $count_gol3_4t = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL III' && $row->statkes == 'I' && $row->umur>'45') {
                $countgol3_1t++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_gol3_2pt++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'II' && $row->umur>'45') {
                $count_gol3_2t++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_gol3_3pt++;
            } else if ($row->tingkatan == 'GOL III' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_gol3_3t++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_gol3_4t++;
            }
        }
        $count_gol2_1t = '';
        $count_gol2_2pt = '';
        $count_gol2_2t = '';
        $count_gol2_3pt = '';
        $count_gol2_3t = '';
        $count_gol2_4t = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL II' && $row->statkes == 'I' && $row->umur>'45') {
                $count_gol2_1t++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_gol2_2pt++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'II' && $row->umur>'45') {
                $count_gol2_2t++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_gol2_3pt++;
            } else if ($row->tingkatan == 'GOL II' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_gol2_3t++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_gol2_4t++;
            }
        }
        $count_gol1_1t = '';
        $count_gol1_2pt = '';
        $count_gol1_2t = '';
        $count_gol1_3pt = '';
        $count_gol1_3t = '';
        $count_gol1_4t = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL I' && $row->statkes == 'I' && $row->umur>'45') {
                $count_gol1_1t++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_gol1_2pt++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'II' && $row->umur>'45') {
                $count_gol1_2t++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_gol1_3pt++;
            } else if ($row->tingkatan == 'GOL I' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_gol1_3t++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_gol1_4t++;
            }
        }

       
         $count_letkol_1t = '';
        $count_letkol_2t = '';
        $count_letkol_2pt = '';
        $count_letkol_3pt = '';
        $count_letkol_3t = '';
        $count_letkol_4t = '';

        foreach ($result as $row) {
            if ($row->urutan == '3' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_letkol_3pt++;
            } else if ($row->urutan == '3' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_letkol_2pt++;
            }
            else if ($row->urutan == '3' && $row->statkes == 'II' && $row->umur>'45') {
                $count_letkol_2t++;
            }
            else if ($row->urutan == '3' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_letkol_3t++;
            }
            else if ($row->urutan == '3' && $row->statkes == 'I' && $row->umur>'45') {
                $count_letkol_1t++;
            }
            else if ($row->urutan == '3' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_letkol_4t++;
            }
        }


         $count_mayor_1t = '';
        $count_mayor_2t = '';
        $count_mayor_2pt = '';
        $count_mayor_3pt = '';
        $count_mayor_3t = '';
        $count_mayor_4t = '';

        foreach ($result as $row) {
            if ($row->urutan == '4' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_mayor_3pt++;
            } else if ($row->urutan == '4' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_mayor_2pt++;
            }
            else if ($row->urutan == '4' && $row->statkes == 'II' && $row->umur>'45') {
                $count_mayor_2t++;
            }
            else if ($row->urutan == '4' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_mayor_3t++;
            }
            else if ($row->urutan == '4' && $row->statkes == 'I' && $row->umur>'45') {
                $count_mayor_1t++;
            }
            else if ($row->urutan == '4' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_mayor_4t++;
            }
        }
         $count_kapten_1t = '';
        $count_kapten_2t = '';
        $count_kapten_2pt = '';
        $count_kapten_3pt = '';
        $count_kapten_3t = '';
        $count_kapten_4t = '';

        foreach ($result as $row) {
            if ($row->urutan == '5' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_kapten_3pt++;
            } else if ($row->urutan == '5' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_kapten_2pt++;
            }
            else if ($row->urutan == '5' && $row->statkes == 'II' && $row->umur>'45') {
                $count_kapten_2t++;
            }
            else if ($row->urutan == '5' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_kapten_3t++;
            }
            else if ($row->urutan == '5' && $row->statkes == 'I' && $row->umur>'45') {
                $count_kapten_1t++;
            }
            else if ($row->urutan == '5' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_kapten_4t++;
            }
        }
         $count_lettu_1t = '';
        $count_lettu_2t = '';
        $count_lettu_2pt = '';
        $count_lettu_3pt = '';
        $count_lettu_3t = '';
        $count_lettu_4t = '';

        foreach ($result as $row) {
            if ($row->urutan == '6' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_lettu_3pt++;
            } else if ($row->urutan == '6' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_lettu_2pt++;
            }
            else if ($row->urutan == '6' && $row->statkes == 'II' && $row->umur>'45') {
                $count_lettu_2t++;
            }
            else if ($row->urutan == '6' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_lettu_3t++;
            }
            else if ($row->urutan == '6' && $row->statkes == 'I' && $row->umur>'45') {
                $count_lettu_1t++;
            }
            else if ($row->urutan == '6' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_lettu_4t++;
            }
        }
         $count_letda_1t = '';
        $count_letda_2t = '';
        $count_letda_2pt = '';
        $count_letda_3pt = '';
        $count_letda_3t = '';
        $count_letda_4t = '';

        foreach ($result as $row) {
            if ($row->urutan == '7' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_letda_3pt++;
            } else if ($row->urutan == '7' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_letda_2pt++;
            }
            else if ($row->urutan == '7' && $row->statkes == 'II' && $row->umur>'45') {
                $count_letda_2t++;
            }
            else if ($row->urutan == '7' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_letda_3t++;
            }
            else if ($row->urutan == '7' && $row->statkes == 'I' && $row->umur>'45') {
                $count_letda_1t++;
            }
            else if ($row->urutan == '7' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_letda_4t++;
            }
        }
        //Batas akhir pasien lebih dari 45 tahun


    
        $objPHPExcel->getActiveSheet()->setCellValue('B18', $count_letkol_1);
        $objPHPExcel->getActiveSheet()->setCellValue('B19', $count_letkol_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('B20', $count_letkol_2);
        $objPHPExcel->getActiveSheet()->setCellValue('B21', $count_letkol_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('B22', $count_letkol_3);
        $objPHPExcel->getActiveSheet()->setCellValue('B23', $count_letkol_4);
        
        $objPHPExcel->getActiveSheet()->setCellValue('C18', $count_mayor_1);
        $objPHPExcel->getActiveSheet()->setCellValue('C19', $count_mayor_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('C20', $count_mayor_2);
        $objPHPExcel->getActiveSheet()->setCellValue('C21', $count_mayor_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('C22', $count_mayor_3);
        $objPHPExcel->getActiveSheet()->setCellValue('C23', $count_mayor_4);
        
        $objPHPExcel->getActiveSheet()->setCellValue('D18', $count_kapten_1);
        $objPHPExcel->getActiveSheet()->setCellValue('D19', $count_kapten_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('D20', $count_kapten_2);
        $objPHPExcel->getActiveSheet()->setCellValue('D21', $count_kapten_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('D22', $count_kapten_3);
        $objPHPExcel->getActiveSheet()->setCellValue('D23', $count_kapten_4);

        $objPHPExcel->getActiveSheet()->setCellValue('E18', $count_lettu_1);
        $objPHPExcel->getActiveSheet()->setCellValue('E19', $count_lettu_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('E20', $count_lettu_2);
        $objPHPExcel->getActiveSheet()->setCellValue('E21', $count_lettu_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('E22', $count_lettu_3);
        $objPHPExcel->getActiveSheet()->setCellValue('E23', $count_lettu_4);

        $objPHPExcel->getActiveSheet()->setCellValue('F18', $count_letda_1);
        $objPHPExcel->getActiveSheet()->setCellValue('F19', $count_letda_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('F20', $count_letda_2);
        $objPHPExcel->getActiveSheet()->setCellValue('F21', $count_letda_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('F22', $count_letda_3);
        $objPHPExcel->getActiveSheet()->setCellValue('F23', $count_letda_4);

        $objPHPExcel->getActiveSheet()->setCellValue('G18', $count_bintara_1);
        $objPHPExcel->getActiveSheet()->setCellValue('G19', $count_bintara_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('G20', $count_bintara_2);
        $objPHPExcel->getActiveSheet()->setCellValue('G21', $count_bintara_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('G22', $count_bintara_3);
        $objPHPExcel->getActiveSheet()->setCellValue('G23', $count_bintara_4);

        $objPHPExcel->getActiveSheet()->setCellValue('H18', $count_tamtama_1);
        $objPHPExcel->getActiveSheet()->setCellValue('H19', $count_tamtama_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('H20', $count_tamtama_2);
        $objPHPExcel->getActiveSheet()->setCellValue('H21', $count_tamtama_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('H22', $count_tamtama_3);
        $objPHPExcel->getActiveSheet()->setCellValue('H23', $count_tamtama_4);

        $objPHPExcel->getActiveSheet()->setCellValue('J18', $count_letkol_1u);
        $objPHPExcel->getActiveSheet()->setCellValue('J19', $count_letkol_2pu);
        $objPHPExcel->getActiveSheet()->setCellValue('J20', $count_letkol_2u);
        $objPHPExcel->getActiveSheet()->setCellValue('J21', $count_letkol_3pu);
        $objPHPExcel->getActiveSheet()->setCellValue('J22', $count_letkol_3u);
        $objPHPExcel->getActiveSheet()->setCellValue('J23', $count_letkol_4u);
        
        $objPHPExcel->getActiveSheet()->setCellValue('K18', $count_mayor_1u);
        $objPHPExcel->getActiveSheet()->setCellValue('K19', $count_mayor_2pu);
        $objPHPExcel->getActiveSheet()->setCellValue('K20', $count_mayor_2u);
        $objPHPExcel->getActiveSheet()->setCellValue('K21', $count_mayor_3pu);
        $objPHPExcel->getActiveSheet()->setCellValue('K22', $count_mayor_3u);
        $objPHPExcel->getActiveSheet()->setCellValue('K23', $count_mayor_4u);
        
        $objPHPExcel->getActiveSheet()->setCellValue('L18', $count_kapten_1u);
        $objPHPExcel->getActiveSheet()->setCellValue('L19', $count_kapten_2pu);
        $objPHPExcel->getActiveSheet()->setCellValue('L20', $count_kapten_2u);
        $objPHPExcel->getActiveSheet()->setCellValue('L21', $count_kapten_3pu);
        $objPHPExcel->getActiveSheet()->setCellValue('L22', $count_kapten_3u);
        $objPHPExcel->getActiveSheet()->setCellValue('L23', $count_kapten_4u);

        $objPHPExcel->getActiveSheet()->setCellValue('M18', $count_lettu_1u);
        $objPHPExcel->getActiveSheet()->setCellValue('M19', $count_lettu_2pu);
        $objPHPExcel->getActiveSheet()->setCellValue('M20', $count_lettu_2u);
        $objPHPExcel->getActiveSheet()->setCellValue('M21', $count_lettu_3pu);
        $objPHPExcel->getActiveSheet()->setCellValue('M22', $count_lettu_3u);
        $objPHPExcel->getActiveSheet()->setCellValue('M23', $count_lettu_4u);

        $objPHPExcel->getActiveSheet()->setCellValue('N18', $count_letda_1u);
        $objPHPExcel->getActiveSheet()->setCellValue('N19', $count_letda_2pu);
        $objPHPExcel->getActiveSheet()->setCellValue('N20', $count_letda_2u);
        $objPHPExcel->getActiveSheet()->setCellValue('N21', $count_letda_3pu);
        $objPHPExcel->getActiveSheet()->setCellValue('N22', $count_letda_3u);
        $objPHPExcel->getActiveSheet()->setCellValue('N23', $count_letda_4u);

        $objPHPExcel->getActiveSheet()->setCellValue('O18', $count_bintara_1u);
        $objPHPExcel->getActiveSheet()->setCellValue('O19', $count_bintara_2pu);
        $objPHPExcel->getActiveSheet()->setCellValue('O20', $count_bintara_2u);
        $objPHPExcel->getActiveSheet()->setCellValue('O21', $count_bintara_3pu);
        $objPHPExcel->getActiveSheet()->setCellValue('O22', $count_bintara_3u);
        $objPHPExcel->getActiveSheet()->setCellValue('O23', $count_bintara_4u);

        $objPHPExcel->getActiveSheet()->setCellValue('P18', $count_tamtama_1u);
        $objPHPExcel->getActiveSheet()->setCellValue('P19', $count_tamtama_2pu);
        $objPHPExcel->getActiveSheet()->setCellValue('P20', $count_tamtama_2u);
        $objPHPExcel->getActiveSheet()->setCellValue('P21', $count_tamtama_3pu);
        $objPHPExcel->getActiveSheet()->setCellValue('P22', $count_tamtama_3u);
        $objPHPExcel->getActiveSheet()->setCellValue('P23', $count_tamtama_4u);


       
        $objPHPExcel->getActiveSheet()->setCellValue('R18', $count_gol4a_1);
        $objPHPExcel->getActiveSheet()->setCellValue('R19', $count_gol4a_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('R20', $count_gol4a_2);
        $objPHPExcel->getActiveSheet()->setCellValue('R21', $count_gol4a_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('R22', $count_gol4a_3);
        $objPHPExcel->getActiveSheet()->setCellValue('R23', $count_gol4a_4);

        $objPHPExcel->getActiveSheet()->setCellValue('S18', $count_gol3_1);
        $objPHPExcel->getActiveSheet()->setCellValue('S19', $count_gol3_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('S20', $count_gol3_2);
        $objPHPExcel->getActiveSheet()->setCellValue('S21', $count_gol3_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('S22', $count_gol3_3);
        $objPHPExcel->getActiveSheet()->setCellValue('S23', $count_gol3_4);

        $objPHPExcel->getActiveSheet()->setCellValue('T18', $count_gol2_1);
        $objPHPExcel->getActiveSheet()->setCellValue('T19', $count_gol2_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('T20', $count_gol2_2);
        $objPHPExcel->getActiveSheet()->setCellValue('T21', $count_gol2_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('T22', $count_gol2_3);
        $objPHPExcel->getActiveSheet()->setCellValue('T23', $count_gol2_4);

        $objPHPExcel->getActiveSheet()->setCellValue('U18', $count_gol1_1);
        $objPHPExcel->getActiveSheet()->setCellValue('U19', $count_gol1_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('U20', $count_gol1_2);
        $objPHPExcel->getActiveSheet()->setCellValue('U21', $count_gol1_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('U22', $count_gol1_3);
        $objPHPExcel->getActiveSheet()->setCellValue('U23', $count_gol1_4);


        $objPHPExcel->getActiveSheet()->setCellValue('W18', $count_gol4a_1u);
        $objPHPExcel->getActiveSheet()->setCellValue('W19', $count_gol4a_2pu);
        $objPHPExcel->getActiveSheet()->setCellValue('W20', $count_gol4a_2u);
        $objPHPExcel->getActiveSheet()->setCellValue('W21', $count_gol4a_3pu);
        $objPHPExcel->getActiveSheet()->setCellValue('W22', $count_gol4a_3u);
        $objPHPExcel->getActiveSheet()->setCellValue('W23', $count_gol4a_4u);

        $objPHPExcel->getActiveSheet()->setCellValue('X18', $count_gol3_1u);
        $objPHPExcel->getActiveSheet()->setCellValue('X19', $count_gol3_2pu);
        $objPHPExcel->getActiveSheet()->setCellValue('X20', $count_gol3_2u);
        $objPHPExcel->getActiveSheet()->setCellValue('X21', $count_gol3_3pu);
        $objPHPExcel->getActiveSheet()->setCellValue('X22', $count_gol3_3u);
        $objPHPExcel->getActiveSheet()->setCellValue('X23', $count_gol3_4u);

        $objPHPExcel->getActiveSheet()->setCellValue('Y18', $count_gol2_1u);
        $objPHPExcel->getActiveSheet()->setCellValue('Y19', $count_gol2_2pu);
        $objPHPExcel->getActiveSheet()->setCellValue('Y20', $count_gol2_2u);
        $objPHPExcel->getActiveSheet()->setCellValue('Y21', $count_gol2_3pu);
        $objPHPExcel->getActiveSheet()->setCellValue('Y22', $count_gol2_3u);
        $objPHPExcel->getActiveSheet()->setCellValue('Y23', $count_gol2_4u);

        $objPHPExcel->getActiveSheet()->setCellValue('Z18', $count_gol1_1u);
        $objPHPExcel->getActiveSheet()->setCellValue('Z19', $count_gol1_2pu);
        $objPHPExcel->getActiveSheet()->setCellValue('Z20', $count_gol1_2u);
        $objPHPExcel->getActiveSheet()->setCellValue('Z21', $count_gol1_3pu);
        $objPHPExcel->getActiveSheet()->setCellValue('Z22', $count_gol1_3u);
        $objPHPExcel->getActiveSheet()->setCellValue('Z23', $count_gol1_4u);

        // $objPHPExcel->getActiveSheet()->setCellValue('AB18', $count_letkol_1t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AB19', $count_letkol_2pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AB20', $count_letkol_2t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AB21', $count_letkol_3pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AB22', $count_letkol_3t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AB23', $count_letkol_4t);
        
        // $objPHPExcel->getActiveSheet()->setCellValue('AC18', $count_mayor_1t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AC19', $count_mayor_2pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AC20', $count_mayor_2t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AC21', $count_mayor_3pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AC22', $count_mayor_3t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AC23', $count_mayor_4t);
        
        // $objPHPExcel->getActiveSheet()->setCellValue('AD18', $count_kapten_1t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AD19', $count_kapten_2pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AD20', $count_kapten_2t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AD21', $count_kapten_3pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AD22', $count_kapten_3t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AD23', $count_kapten_4t);

        // $objPHPExcel->getActiveSheet()->setCellValue('AE18', $count_lettu_1t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AE19', $count_lettu_2pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AE20', $count_lettu_2t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AE21', $count_lettu_3pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AE22', $count_lettu_3t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AE23', $count_lettu_4t);

        // $objPHPExcel->getActiveSheet()->setCellValue('AF18', $count_letda_1t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AF19', $count_letda_2pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AF20', $count_letda_2t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AF21', $count_letda_3pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AF22', $count_letda_3t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AF23', $count_letda_4t);

        // $objPHPExcel->getActiveSheet()->setCellValue('AG18', $count_bintara_1t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AG19', $count_bintara_2pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AG20', $count_bintara_2t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AG21', $count_bintara_3pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AG22', $count_bintara_3t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AG23', $count_bintara_4t);

        // $objPHPExcel->getActiveSheet()->setCellValue('AH18', $count_tamtama_1t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AH19', $count_tamtama_2pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AH20', $count_tamtama_2t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AH21', $count_tamtama_3pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AH22', $count_tamtama_3t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AH23', $count_tamtama_4t);


        // $objPHPExcel->getActiveSheet()->setCellValue('AJ18', $count_gol4a_1t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AJ19', $count_gol4a_2pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AJ20', $count_gol4a_2t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AJ21', $count_gol4a_3pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AJ22', $count_gol4a_3t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AJ23', $count_gol4a_4t);

        // $objPHPExcel->getActiveSheet()->setCellValue('AK18', $count_gol3_1t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AK19', $count_gol3_2pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AK20', $count_gol3_2t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AK21', $count_gol3_3pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AK22', $count_gol3_3t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AK23', $count_gol3_4t);

        // $objPHPExcel->getActiveSheet()->setCellValue('AL18', $count_gol2_1t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AL19', $count_gol2_2pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AL20', $count_gol2_2t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AL21', $count_gol2_3pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AL22', $count_gol2_3t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AL23', $count_gol2_4t);

        // $objPHPExcel->getActiveSheet()->setCellValue('AM18', $count_gol1_1t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AM19', $count_gol1_2pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AM20', $count_gol1_2t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AM21', $count_gol1_3pt);
        // $objPHPExcel->getActiveSheet()->setCellValue('AM22', $count_gol1_3t);
        // $objPHPExcel->getActiveSheet()->setCellValue('AM23', $count_gol1_4t);


        $objPHPExcel->getActiveSheet()->setTitle('Kategori Usia dibawah 45 th');  
        
        $objPHPExcel->setActiveSheetIndex(2);  
        // Add some data  
        $objPHPExcel->getActiveSheet()->mergeCells('A2:C2');
        $objPHPExcel->getActiveSheet()->getStyle('A2')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('A3:C3');
        $objPHPExcel->getActiveSheet()->getStyle('A3')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);

        $objPHPExcel->getActiveSheet()->mergeCells('N2:O2');
        $objPHPExcel->getActiveSheet()->getColumnDimension('N')->setAutoSize(true);
        $objPHPExcel->getActiveSheet()->SetCellValue('o3', "R/     / ".$blnrmw." / ".$tahun);
        $objPHPExcel->getActiveSheet()->getStyle('o3')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet()->SetCellValue('o4', " " .$tanggal);
        $objPHPExcel->getActiveSheet()->getStyle('o4')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet()->mergeCells('A6:O6');
        $objPHPExcel->getActiveSheet()->getStyle('A6')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->SetCellValue('H9', "MABESAL");
        $objPHPExcel->getActiveSheet()->SetCellValue('H10', "".$tingkatan);
        $objPHPExcel->getActiveSheet()->SetCellValue('H8', "".date('F Y'));
        $objPHPExcel->getActiveSheet()->mergeCells('A13:O13');
        $objPHPExcel->getActiveSheet()->SetCellValue('A13', "INTENSIF I");
        $objPHPExcel->getActiveSheet()->getStyle('A13')->getFont()->setBold(true);

        $result = $this->Murikes->get_rek_mabesal($param1, $param2)->result();
         $no=1; $rowCount = 14;
        
        foreach($result as $key) {
            $intensif=strtoupper($key->intensif);
            if ($intensif=='INTENSIF I') {
               
            $objPHPExcel->getActiveSheet()->setCellValue('A'.$rowCount, $no++);
            $objPHPExcel->getActiveSheet()->setCellValue('B'.$rowCount, $key->nama);
            $objPHPExcel->getActiveSheet()->setCellValue('C'.$rowCount, $key->umur);
            $objPHPExcel->getActiveSheet()->getStyle('D'.$rowCount)->getAlignment()->setWrapText(TRUE);
            $objPHPExcel->getActiveSheet()->setCellValue('D'.$rowCount, $key->nm_pangkat. "\n".$key->nip);
            $objPHPExcel->getActiveSheet()->setCellValue('E'.$rowCount, $key->kesatuan_gab);
            $objPHPExcel->getActiveSheet()->setCellValue('F'.$rowCount, date('d-m-Y', strtotime($key->tgl_pemeriksaan)));
            $objPHPExcel->getActiveSheet()->setCellValue('G'.$rowCount, $key->sf_umum);
            $objPHPExcel->getActiveSheet()->setCellValue('H'.$rowCount, $key->sf_atas);
            $objPHPExcel->getActiveSheet()->setCellValue('I'.$rowCount, $key->sf_bawah);
            $objPHPExcel->getActiveSheet()->setCellValue('J'.$rowCount, $key->sf_dengar);
            $objPHPExcel->getActiveSheet()->setCellValue('K'.$rowCount, $key->sf_lihat);
            $objPHPExcel->getActiveSheet()->setCellValue('L'.$rowCount, $key->sf_gigi);
            $objPHPExcel->getActiveSheet()->setCellValue('M'.$rowCount, $key->sf_jiwa);
            $objPHPExcel->getActiveSheet()->setCellValue('N'.$rowCount, $key->statkes);
            $objPHPExcel->getActiveSheet()->setCellValue('O'.$rowCount, strip_tags($key->kesimpulan_saran));
             $rowCount++;
            }
       }    
            $objPHPExcel->getActiveSheet()->mergeCells('A'.$rowCount.':O'.$rowCount);
             $objPHPExcel->getActiveSheet()->SetCellValue('A'.$rowCount, "INTENSIF II");
            $objPHPExcel->getActiveSheet()->getStyle('A'.$rowCount)->getFont()->setBold(true);
            $rowCount++;

            $nos=1;
        foreach($result as $key) {
            $intensif=strtoupper($key->intensif);
            if ($intensif=='INTENSIF II') {
               
            $objPHPExcel->getActiveSheet()->setCellValue('A'.$rowCount, $nos++);
            $objPHPExcel->getActiveSheet()->setCellValue('B'.$rowCount, $key->nama);
            $objPHPExcel->getActiveSheet()->setCellValue('C'.$rowCount, $key->umur);
            $objPHPExcel->getActiveSheet()->getStyle('D'.$rowCount)->getAlignment()->setWrapText(TRUE);
            $objPHPExcel->getActiveSheet()->setCellValue('D'.$rowCount, $key->nm_pangkat. "\n".$key->nip);
            $objPHPExcel->getActiveSheet()->setCellValue('E'.$rowCount, $key->kesatuan_gab);
            $objPHPExcel->getActiveSheet()->setCellValue('F'.$rowCount, date('d-m-Y', strtotime($key->tgl_pemeriksaan)));
            $objPHPExcel->getActiveSheet()->setCellValue('G'.$rowCount, $key->sf_umum);
            $objPHPExcel->getActiveSheet()->setCellValue('H'.$rowCount, $key->sf_atas);
            $objPHPExcel->getActiveSheet()->setCellValue('I'.$rowCount, $key->sf_bawah);
            $objPHPExcel->getActiveSheet()->setCellValue('J'.$rowCount, $key->sf_dengar);
            $objPHPExcel->getActiveSheet()->setCellValue('K'.$rowCount, $key->sf_lihat);
            $objPHPExcel->getActiveSheet()->setCellValue('L'.$rowCount, $key->sf_gigi);
            $objPHPExcel->getActiveSheet()->setCellValue('M'.$rowCount, $key->sf_jiwa);
            $objPHPExcel->getActiveSheet()->setCellValue('N'.$rowCount, $key->statkes);
            $objPHPExcel->getActiveSheet()->setCellValue('O'.$rowCount, strip_tags($key->kesimpulan_saran));
             $rowCount++;
            }
            
        }

             $objPHPExcel->getActiveSheet()->mergeCells('A'.$rowCount.':O'.$rowCount);
             $objPHPExcel->getActiveSheet()->SetCellValue('A'.$rowCount, "INTENSIF III");
            $objPHPExcel->getActiveSheet()->getStyle('A'.$rowCount)->getFont()->setBold(true);
            $rowCount++;
            
            $not=1;
        foreach($result as $key) {
            $intensif=strtoupper($key->intensif);
            if ($intensif=='INTENSIF III') {
                
            $objPHPExcel->getActiveSheet()->setCellValue('A'.$rowCount, $not++);
            $objPHPExcel->getActiveSheet()->setCellValue('B'.$rowCount, $key->nama);
            $objPHPExcel->getActiveSheet()->setCellValue('C'.$rowCount, $key->umur);
            $objPHPExcel->getActiveSheet()->getStyle('D'.$rowCount)->getAlignment()->setWrapText(TRUE);
            $objPHPExcel->getActiveSheet()->setCellValue('D'.$rowCount, $key->nm_pangkat. "\n".$key->nip);
            $objPHPExcel->getActiveSheet()->setCellValue('E'.$rowCount, $key->kesatuan_gab);
            $objPHPExcel->getActiveSheet()->setCellValue('F'.$rowCount, date('d-m-Y', strtotime($key->tgl_pemeriksaan)));
            $objPHPExcel->getActiveSheet()->setCellValue('G'.$rowCount, $key->sf_umum);
            $objPHPExcel->getActiveSheet()->setCellValue('H'.$rowCount, $key->sf_atas);
            $objPHPExcel->getActiveSheet()->setCellValue('I'.$rowCount, $key->sf_bawah);
            $objPHPExcel->getActiveSheet()->setCellValue('J'.$rowCount, $key->sf_dengar);
            $objPHPExcel->getActiveSheet()->setCellValue('K'.$rowCount, $key->sf_lihat);
            $objPHPExcel->getActiveSheet()->setCellValue('L'.$rowCount, $key->sf_gigi);
            $objPHPExcel->getActiveSheet()->setCellValue('M'.$rowCount, $key->sf_jiwa);
            $objPHPExcel->getActiveSheet()->setCellValue('N'.$rowCount, $key->statkes);
            $objPHPExcel->getActiveSheet()->setCellValue('O'.$rowCount, strip_tags($key->kesimpulan_saran));
            $rowCount++;
            }
            
        }

        $objPHPExcel->getActiveSheet()->setTitle('Lengkap'); 

        $objPHPExcel->setActiveSheetIndex(1); 
        
        $objPHPExcel->getActiveSheet()->getStyle('A10:A13')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        // $objPHPExcel->getActiveSheet()->getStyle('F10:F13')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        // $objPHPExcel->getActiveSheet()->getStyle('I10:I13')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet()->mergeCells('A15:A16');
        $objPHPExcel->getActiveSheet()->getStyle('A15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('B15:I15');
        $objPHPExcel->getActiveSheet()->getStyle('B15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('B16:H16');
        $objPHPExcel->getActiveSheet()->getStyle('B16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('I16:I17');  
        $objPHPExcel->getActiveSheet()->getStyle('I16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('J15:N15');
        $objPHPExcel->getActiveSheet()->getStyle('J15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('J16:M16');
        $objPHPExcel->getActiveSheet()->getStyle('J16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);  
        $objPHPExcel->getActiveSheet()->mergeCells('N16:N17');  
        $objPHPExcel->getActiveSheet()->getStyle('N16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);       
        $objPHPExcel->getActiveSheet()->mergeCells('O15:O17');  
        $objPHPExcel->getActiveSheet()->getStyle('O15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);      
                

        $result = $this->Murikes->get_rek_mabesal($param1,$param2)->result();

        $count_bintara_1t = '';
        $count_bintara_2pt = '';
        $count_bintara_2t = '';
        $count_bintara_3pt = '';
        $count_bintara_3t = '';
        $count_bintara_4t = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'BINTARA' && $row->statkes == 'I' && $row->umur>'45') {
                $count_bintara_1t++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_bintara_2pt++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'II' && $row->umur>'45') {
                $count_bintara_2t++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_bintara_3pt++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'III III' && $row->umur>'45') {
                $count_bintara_3t++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_bintara_4t++;
            }
        }
        $count_tamtama_1t = '';
        $count_tamtama_2pt = '';
        $count_tamtama_2t = '';
        $count_tamtama_3pt = '';
        $count_tamtama_3t = '';
        $count_tamtama_4t = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'I' && $row->umur>'45') {
                $count_tamtama_1t++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_tamtama_2pt++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'II' && $row->umur>'45') {
                $count_tamtama_2t++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_tamtama_3pt++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'III III' && $row->umur>'45') {
                $count_tamtama_3t++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_tamtama_4t++;
            }
        }
       
        $count_gol4a_1t = '';
        $count_gol4a_2pt = '';
        $count_gol4a_2t = '';
        $count_gol4a_3pt = '';
        $count_gol4a_3t = '';
        $count_gol4a_4t = '';

        foreach ($result as $row) {
            if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'I' && $row->umur>'45') {
                $count_gol4a_1t++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'II P' && $row->umur>'45') {
                $count_gol4a_2pt++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'II' && $row->umur>'45') {
                $count_gol4a_2t++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == 'III P' && $row->umur>'45') {
                $count_gol4a_3pt++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && ($row->statkes == 'III' || $row->statkes == 'III III')  && $row->umur>'45') {
                $count_gol4a_3t++;
            } else if (($row->tingkatan == 'GOL IV/D' || $row->tingkatan == 'GOL IV/C' || $row->tingkatan == 'GOL IV/B' || $row->tingkatan == 'GOL IV/A') && $row->statkes == ' IV' && $row->umur>'45') {
                $count_gol4a_4t++;
            }
        }
        $count_gol3_2pt = '';
        $count_gol3_1t = '';
        $count_gol3_2t = '';
        $count_gol3_3pt = '';
        $count_gol3_3t = '';
        $count_gol3_4t = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL III' && $row->statkes == 'I' && $row->umur>'45') {
                $countgol3_1t++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_gol3_2pt++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'II' && $row->umur>'45') {
                $count_gol3_2t++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_gol3_3pt++;
            } else if ($row->tingkatan == 'GOL III' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_gol3_3t++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_gol3_4t++;
            }
        }
        $count_gol2_1t = '';
        $count_gol2_2pt = '';
        $count_gol2_2t = '';
        $count_gol2_3pt = '';
        $count_gol2_3t = '';
        $count_gol2_4t = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL II' && $row->statkes == 'I' && $row->umur>'45') {
                $count_gol2_1t++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_gol2_2pt++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'II' && $row->umur>'45') {
                $count_gol2_2t++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_gol2_3pt++;
            } else if ($row->tingkatan == 'GOL II' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_gol2_3t++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_gol2_4t++;
            }
        }
        $count_gol1_1t = '';
        $count_gol1_2pt = '';
        $count_gol1_2t = '';
        $count_gol1_3pt = '';
        $count_gol1_3t = '';
        $count_gol1_4t = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL I' && $row->statkes == 'I' && $row->umur>'45') {
                $count_gol1_1t++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_gol1_2pt++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'II' && $row->umur>'45') {
                $count_gol1_2t++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_gol1_3pt++;
            } else if ($row->tingkatan == 'GOL I' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_gol1_3t++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_gol1_4t++;
            }
        }

       
         $count_letkol_1t = '';
        $count_letkol_2t = '';
        $count_letkol_2pt = '';
        $count_letkol_3pt = '';
        $count_letkol_3t = '';
        $count_letkol_4t = '';

        foreach ($result as $row) {
            if ($row->urutan == '3' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_letkol_3pt++;
            } else if ($row->urutan == '3' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_letkol_2pt++;
            }
            else if ($row->urutan == '3' && $row->statkes == 'II' && $row->umur>'45') {
                $count_letkol_2t++;
            }
            else if ($row->urutan == '3' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_letkol_3t++;
            }
            else if ($row->urutan == '3' && $row->statkes == 'I' && $row->umur>'45') {
                $count_letkol_1t++;
            }
            else if ($row->urutan == '3' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_letkol_4t++;
            }
        }


         $count_mayor_1t = '';
        $count_mayor_2t = '';
        $count_mayor_2pt = '';
        $count_mayor_3pt = '';
        $count_mayor_3t = '';
        $count_mayor_4t = '';

        foreach ($result as $row) {
            if ($row->urutan == '4' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_mayor_3pt++;
            } else if ($row->urutan == '4' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_mayor_2pt++;
            }
            else if ($row->urutan == '4' && $row->statkes == 'II' && $row->umur>'45') {
                $count_mayor_2t++;
            }
            else if ($row->urutan == '4' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_mayor_3t++;
            }
            else if ($row->urutan == '4' && $row->statkes == 'I' && $row->umur>'45') {
                $count_mayor_1t++;
            }
            else if ($row->urutan == '4' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_mayor_4t++;
            }
        }
         $count_kapten_1t = '';
        $count_kapten_2t = '';
        $count_kapten_2pt = '';
        $count_kapten_3pt = '';
        $count_kapten_3t = '';
        $count_kapten_4t = '';

        foreach ($result as $row) {
            if ($row->urutan == '5' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_kapten_3pt++;
            } else if ($row->urutan == '5' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_kapten_2pt++;
            }
            else if ($row->urutan == '5' && $row->statkes == 'II' && $row->umur>'45') {
                $count_kapten_2t++;
            }
            else if ($row->urutan == '5' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_kapten_3t++;
            }
            else if ($row->urutan == '5' && $row->statkes == 'I' && $row->umur>'45') {
                $count_kapten_1t++;
            }
            else if ($row->urutan == '5' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_kapten_4t++;
            }
        }
         $count_lettu_1t = '';
        $count_lettu_2t = '';
        $count_lettu_2pt = '';
        $count_lettu_3pt = '';
        $count_lettu_3t = '';
        $count_lettu_4t = '';

        foreach ($result as $row) {
            if ($row->urutan == '6' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_lettu_3pt++;
            } else if ($row->urutan == '6' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_lettu_2pt++;
            }
            else if ($row->urutan == '6' && $row->statkes == 'II' && $row->umur>'45') {
                $count_lettu_2t++;
            }
            else if ($row->urutan == '6' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_lettu_3t++;
            }
            else if ($row->urutan == '6' && $row->statkes == 'I' && $row->umur>'45') {
                $count_lettu_1t++;
            }
            else if ($row->urutan == '6' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_lettu_4t++;
            }
        }
         $count_letda_1t = '';
        $count_letda_2t = '';
        $count_letda_2pt = '';
        $count_letda_3pt = '';
        $count_letda_3t = '';
        $count_letda_4t = '';

        foreach ($result as $row) {
            if ($row->urutan == '7' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_letda_3pt++;
            } else if ($row->urutan == '7' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_letda_2pt++;
            }
            else if ($row->urutan == '7' && $row->statkes == 'II' && $row->umur>'45') {
                $count_letda_2t++;
            }
            else if ($row->urutan == '7' && ($row->statkes == 'III' || $row->statkes == 'III III') && $row->umur>'45') {
                $count_letda_3t++;
            }
            else if ($row->urutan == '7' && $row->statkes == 'I' && $row->umur>'45') {
                $count_letda_1t++;
            }
            else if ($row->urutan == '7' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_letda_4t++;
            }
        }
        //Batas akhir pasien lebih dari 45 tahun
           
        $objPHPExcel->getActiveSheet()->setCellValue('B18', $count_letkol_1t);
        $objPHPExcel->getActiveSheet()->setCellValue('B19', $count_letkol_2pt);
        $objPHPExcel->getActiveSheet()->setCellValue('B20', $count_letkol_2t);
        $objPHPExcel->getActiveSheet()->setCellValue('B21', $count_letkol_3pt);
        $objPHPExcel->getActiveSheet()->setCellValue('B22', $count_letkol_3t);
        $objPHPExcel->getActiveSheet()->setCellValue('B23', $count_letkol_4t);
        
        $objPHPExcel->getActiveSheet()->setCellValue('C18', $count_mayor_1t);
        $objPHPExcel->getActiveSheet()->setCellValue('C19', $count_mayor_2pt);
        $objPHPExcel->getActiveSheet()->setCellValue('C20', $count_mayor_2t);
        $objPHPExcel->getActiveSheet()->setCellValue('C21', $count_mayor_3pt);
        $objPHPExcel->getActiveSheet()->setCellValue('C22', $count_mayor_3t);
        $objPHPExcel->getActiveSheet()->setCellValue('C23', $count_mayor_4t);
        
        $objPHPExcel->getActiveSheet()->setCellValue('D18', $count_kapten_1t);
        $objPHPExcel->getActiveSheet()->setCellValue('D19', $count_kapten_2pt);
        $objPHPExcel->getActiveSheet()->setCellValue('D20', $count_kapten_2t);
        $objPHPExcel->getActiveSheet()->setCellValue('D21', $count_kapten_3pt);
        $objPHPExcel->getActiveSheet()->setCellValue('D22', $count_kapten_3t);
        $objPHPExcel->getActiveSheet()->setCellValue('D23', $count_kapten_4t);

        $objPHPExcel->getActiveSheet()->setCellValue('E18', $count_lettu_1t);
        $objPHPExcel->getActiveSheet()->setCellValue('E19', $count_lettu_2pt);
        $objPHPExcel->getActiveSheet()->setCellValue('E20', $count_lettu_2t);
        $objPHPExcel->getActiveSheet()->setCellValue('E21', $count_lettu_3pt);
        $objPHPExcel->getActiveSheet()->setCellValue('E22', $count_lettu_3t);
        $objPHPExcel->getActiveSheet()->setCellValue('E23', $count_lettu_4t);

        $objPHPExcel->getActiveSheet()->setCellValue('F18', $count_letda_1t);
        $objPHPExcel->getActiveSheet()->setCellValue('F19', $count_letda_2pt);
        $objPHPExcel->getActiveSheet()->setCellValue('F20', $count_letda_2t);
        $objPHPExcel->getActiveSheet()->setCellValue('F21', $count_letda_3pt);
        $objPHPExcel->getActiveSheet()->setCellValue('F22', $count_letda_3t);
        $objPHPExcel->getActiveSheet()->setCellValue('F23', $count_letda_4t);

        $objPHPExcel->getActiveSheet()->setCellValue('G18', $count_bintara_1t);
        $objPHPExcel->getActiveSheet()->setCellValue('G19', $count_bintara_2pt);
        $objPHPExcel->getActiveSheet()->setCellValue('G20', $count_bintara_2t);
        $objPHPExcel->getActiveSheet()->setCellValue('G21', $count_bintara_3pt);
        $objPHPExcel->getActiveSheet()->setCellValue('G22', $count_bintara_3t);
        $objPHPExcel->getActiveSheet()->setCellValue('G23', $count_bintara_4t);

        $objPHPExcel->getActiveSheet()->setCellValue('H18', $count_tamtama_1t);
        $objPHPExcel->getActiveSheet()->setCellValue('H19', $count_tamtama_2pt);
        $objPHPExcel->getActiveSheet()->setCellValue('H20', $count_tamtama_2t);
        $objPHPExcel->getActiveSheet()->setCellValue('H21', $count_tamtama_3pt);
        $objPHPExcel->getActiveSheet()->setCellValue('H22', $count_tamtama_3t);
        $objPHPExcel->getActiveSheet()->setCellValue('H23', $count_tamtama_4t);


        $objPHPExcel->getActiveSheet()->setCellValue('J18', $count_gol4a_1t);
        $objPHPExcel->getActiveSheet()->setCellValue('J19', $count_gol4a_2pt);
        $objPHPExcel->getActiveSheet()->setCellValue('J20', $count_gol4a_2t);
        $objPHPExcel->getActiveSheet()->setCellValue('J21', $count_gol4a_3pt);
        $objPHPExcel->getActiveSheet()->setCellValue('J22', $count_gol4a_3t);
        $objPHPExcel->getActiveSheet()->setCellValue('J23', $count_gol4a_4t);

        $objPHPExcel->getActiveSheet()->setCellValue('K18', $count_gol3_1t);
        $objPHPExcel->getActiveSheet()->setCellValue('K19', $count_gol3_2pt);
        $objPHPExcel->getActiveSheet()->setCellValue('K20', $count_gol3_2t);
        $objPHPExcel->getActiveSheet()->setCellValue('K21', $count_gol3_3pt);
        $objPHPExcel->getActiveSheet()->setCellValue('K22', $count_gol3_3t);
        $objPHPExcel->getActiveSheet()->setCellValue('K23', $count_gol3_4t);

        $objPHPExcel->getActiveSheet()->setCellValue('L18', $count_gol2_1t);
        $objPHPExcel->getActiveSheet()->setCellValue('L19', $count_gol2_2pt);
        $objPHPExcel->getActiveSheet()->setCellValue('L20', $count_gol2_2t);
        $objPHPExcel->getActiveSheet()->setCellValue('L21', $count_gol2_3pt);
        $objPHPExcel->getActiveSheet()->setCellValue('L22', $count_gol2_3t);
        $objPHPExcel->getActiveSheet()->setCellValue('L23', $count_gol2_4t);

        $objPHPExcel->getActiveSheet()->setCellValue('M18', $count_gol1_1t);
        $objPHPExcel->getActiveSheet()->setCellValue('M19', $count_gol1_2pt);
        $objPHPExcel->getActiveSheet()->setCellValue('M20', $count_gol1_2t);
        $objPHPExcel->getActiveSheet()->setCellValue('M21', $count_gol1_3pt);
        $objPHPExcel->getActiveSheet()->setCellValue('M22', $count_gol1_3t);
        $objPHPExcel->getActiveSheet()->setCellValue('M23', $count_gol1_4t);
        
        $objPHPExcel->getActiveSheet()->setTitle('Kategori Usia diatas 45 th');  

        $objPHPExcel->setActiveSheetIndex(3);  
        // Add some data  
        $objPHPExcel->getActiveSheet()->getStyle('A10:A13')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        // $objPHPExcel->getActiveSheet()->getStyle('F10:F13')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        // $objPHPExcel->getActiveSheet()->getStyle('I10:I13')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet()->mergeCells('A15:A16');
        $objPHPExcel->getActiveSheet()->getStyle('A15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER); //statkes
        $objPHPExcel->getActiveSheet()->mergeCells('B15:H15');
        $objPHPExcel->getActiveSheet()->getStyle('B15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);//militer
        $objPHPExcel->getActiveSheet()->mergeCells('B16:D16');
        $objPHPExcel->getActiveSheet()->getStyle('B16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);//pati
        $objPHPExcel->getActiveSheet()->mergeCells('J15:J17');  
        $objPHPExcel->getActiveSheet()->getStyle('J15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);//jml besar
        $objPHPExcel->getActiveSheet()->mergeCells('F16:H16');
        $objPHPExcel->getActiveSheet()->getStyle('F16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);//kolonel
        $objPHPExcel->getActiveSheet()->mergeCells('I16:I17');  
        $objPHPExcel->getActiveSheet()->getStyle('I16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER); //jml
         $objPHPExcel->getActiveSheet()->mergeCells('E16:E17');  
        $objPHPExcel->getActiveSheet()->getStyle('E16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER); //jml
        $objPHPExcel->getActiveSheet()->getStyle('B17:H24')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);


        $result = $this->Murikes->get_rek_mabesal($param1, $param2)->result();
        
        $count_kolonel_1tw = '';
        $count_kolonel_2ptw = '';
        $count_kolonel_2tw = '';
        $count_kolonel_3ptw = '';
        $count_kolonel_3tw = '';
        $count_kolonel_4tw = '';

        foreach ($result as $row) {
            if ($row->urutan == '2' && $row->statkes == 'I' && $row->umur>'45') {
                $count_kolonel_1tw++;
            } else if ($row->urutan == '2' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_kolonel_2ptw++;
            } else if ($row->urutan == '2' && $row->statkes == 'II' && $row->umur>'45') {
                $count_kolonel_2tw++;
            } else if ($row->urutan == '2' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_kolonel_3ptw++;
            } else if ($row->urutan == '2' && $row->statkes == 'III III' && $row->umur>'45') {
                $count_kolonel_3tw++;
            } else if ($row->urutan == '2' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_kolonel_4tw++;
            }
        }
        $count_pati_1tw = '';
        $count_pati_2ptw = '';
        $count_pati_2tw = '';
        $count_pati_3ptw = '';
        $count_pati_3tw = '';
        $count_pati_4tw = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'PATI' && $row->statkes == 'I' && $row->umur>'45') {
                $count_pati_1tw++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'II P' && $row->umur>'45') {
                $count_pati_2ptw++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'II' && $row->umur>'45') {
                $count_pati_2tw++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'III P' && $row->umur>'45') {
                $count_pati_3ptw++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'III III' && $row->umur>'45') {
                $count_pati_3tw++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == ' IV' && $row->umur>'45') {
                $count_pati_4tw++;
            }
        }
        $count_kolonels_1tw = '';
        $count_kolonels_2ptw = '';
        $count_kolonels_2tw = '';
        $count_kolonels_3ptw = '';
        $count_kolonels_3tw = '';
        $count_kolonels_4tw = '';

        foreach ($result as $row) {
            if ($row->urutan == '2' && $row->statkes == 'I' && ($row->umur>='35' && $row->umur<='45')) {
                $count_kolonels_1tw++;
            } else if ($row->urutan == '2' && $row->statkes == 'II P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_kolonels_2ptw++;
            } else if ($row->urutan == '2' && $row->statkes == 'II' && ($row->umur>='35' && $row->umur<='45')) {
                $count_kolonels_2tw++;
            } else if ($row->urutan == '2' && $row->statkes == 'III P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_kolonels_3ptw++;
            } else if ($row->urutan == '2' && $row->statkes == 'III III' && ($row->umur>='35' && $row->umur<='45')) {
                $count_kolonels_3tw++;
            } else if ($row->urutan == '2' && $row->statkes == ' IV' && ($row->umur>='35' && $row->umur<='45')) {
                $count_kolonels_4tw++;
            }
        }
        $count_patis_1tw = '';
        $count_patis_2ptw = '';
        $count_patis_2tw = '';
        $count_patis_3ptw = '';
        $count_patis_3tw = '';
        $count_patis_4tw = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'PATI' && $row->statkes == 'I' && ($row->umur>='35' && $row->umur<='45')) {
                $count_patis_1tw++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'II P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_patis_2ptw++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'II' && ($row->umur>='35' && $row->umur<='45')) {
                $count_patis_2tw++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'III P' && ($row->umur>='35' && $row->umur<='45')) {
                $count_patis_3ptw++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'III III' && ($row->umur>='35' && $row->umur<='45')) {
                $count_patis_3tw++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == ' IV' && ($row->umur>='35' && $row->umur<='45')) {
                $count_patis_4tw++;
            }
        }
        $count_kolonelk_1tw = '';
        $count_kolonelk_2ptw = '';
        $count_kolonelk_2tw = '';
        $count_kolonelk_3ptw = '';
        $count_kolonelk_3tw = '';
        $count_kolonelk_4tw = '';

        foreach ($result as $row) {
            if ($row->urutan == '2' && $row->statkes == 'I' && $row->umur<'35') {
                $count_kolonelk_1tw++;
            } else if ($row->urutan == '2' && $row->statkes == 'II P' && $row->umur<'35') {
                $count_kolonelk_2ptw++;
            } else if ($row->urutan == '2' && $row->statkes == 'II' && $row->umur<'35') {
                $count_kolonelk_2tw++;
            } else if ($row->urutan == '2' && $row->statkes == 'III P' && $row->umur<'35') {
                $count_kolonelk_3ptw++;
            } else if ($row->urutan == '2' && $row->statkes == 'III III' && $row->umur<'35') {
                $count_kolonelk_3tw++;
            } else if ($row->urutan == '2' && $row->statkes == ' IV' && $row->umur<'35') {
                $count_kolonelk_4tw++;
            }
        }
        $count_patik_1tw = '';
        $count_patik_2ptw = '';
        $count_patik_2tw = '';
        $count_patik_3ptw = '';
        $count_patik_3tw = '';
        $count_patik_4tw = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'PATI' && $row->statkes == 'I' && $row->umur<'35') {
                $count_patik_1tw++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'II P' && $row->umur<'35') {
                $count_patik_2ptw++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'II' && $row->umur<'35') {
                $count_patik_2tw++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'III P' && $row->umur<'35') {
                $count_patik_3ptw++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'III III' && $row->umur<'35') {
                $count_patik_3tw++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == ' IV' && $row->umur<'35') {
                $count_patik_4tw++;
            }
        }

        $objPHPExcel->getActiveSheet()->setCellValue('B18', $count_patik_1tw);
        $objPHPExcel->getActiveSheet()->setCellValue('B19', $count_patik_2ptw);
        $objPHPExcel->getActiveSheet()->setCellValue('B20', $count_patik_2tw);
        $objPHPExcel->getActiveSheet()->setCellValue('B21', $count_patik_3ptw);
        $objPHPExcel->getActiveSheet()->setCellValue('B22', $count_patik_3tw);
        $objPHPExcel->getActiveSheet()->setCellValue('B23', $count_patik_4tw);

        $objPHPExcel->getActiveSheet()->setCellValue('C18', $count_patis_1tw);
        $objPHPExcel->getActiveSheet()->setCellValue('C19', $count_patis_2ptw);
        $objPHPExcel->getActiveSheet()->setCellValue('C20', $count_patis_2tw);
        $objPHPExcel->getActiveSheet()->setCellValue('C21', $count_patis_3ptw);
        $objPHPExcel->getActiveSheet()->setCellValue('C22', $count_patis_3tw);
        $objPHPExcel->getActiveSheet()->setCellValue('C23', $count_patis_4tw);

        $objPHPExcel->getActiveSheet()->setCellValue('D18', $count_pati_1tw);
        $objPHPExcel->getActiveSheet()->setCellValue('D19', $count_pati_2ptw);
        $objPHPExcel->getActiveSheet()->setCellValue('D20', $count_pati_2tw);
        $objPHPExcel->getActiveSheet()->setCellValue('D21', $count_pati_3ptw);
        $objPHPExcel->getActiveSheet()->setCellValue('D22', $count_pati_3tw);
        $objPHPExcel->getActiveSheet()->setCellValue('D23', $count_pati_4tw);

        $objPHPExcel->getActiveSheet()->setCellValue('F18', $count_kolonelk_1tw);
        $objPHPExcel->getActiveSheet()->setCellValue('F19', $count_kolonelk_2ptw);
        $objPHPExcel->getActiveSheet()->setCellValue('F20', $count_kolonelk_2tw);
        $objPHPExcel->getActiveSheet()->setCellValue('F21', $count_kolonelk_3ptw);
        $objPHPExcel->getActiveSheet()->setCellValue('F22', $count_kolonelk_3tw);
        $objPHPExcel->getActiveSheet()->setCellValue('F23', $count_kolonelk_4tw);

        $objPHPExcel->getActiveSheet()->setCellValue('G18', $count_kolonels_1tw);
        $objPHPExcel->getActiveSheet()->setCellValue('G19', $count_kolonels_2ptw);
        $objPHPExcel->getActiveSheet()->setCellValue('G20', $count_kolonels_2tw);
        $objPHPExcel->getActiveSheet()->setCellValue('G21', $count_kolonels_3ptw);
        $objPHPExcel->getActiveSheet()->setCellValue('G22', $count_kolonels_3tw);
        $objPHPExcel->getActiveSheet()->setCellValue('G23', $count_kolonels_4tw);

        $objPHPExcel->getActiveSheet()->setCellValue('H18', $count_kolonel_1tw);
        $objPHPExcel->getActiveSheet()->setCellValue('H19', $count_kolonel_2ptw);
        $objPHPExcel->getActiveSheet()->setCellValue('H20', $count_kolonel_2tw);
        $objPHPExcel->getActiveSheet()->setCellValue('H21', $count_kolonel_3ptw);
        $objPHPExcel->getActiveSheet()->setCellValue('H22', $count_kolonel_3tw);
        $objPHPExcel->getActiveSheet()->setCellValue('H23', $count_kolonel_4tw);
            

        $objPHPExcel->getActiveSheet()->setTitle('PATI dan KOLONEL'); 


        
        $filename = "Laporan Rekapitulasi Usia Urikes".date('d F Y', strtotime($param1))." - ".date('d F Y', strtotime($param2));
        header('Content-Disposition: attachment;filename="'.$filename.'.xls"');  
                
        // // Rename worksheet (worksheet, not filename)  
        // $objPHPExcel->getActiveSheet()->setTitle('RSAL Mintohardjo');    
           
        // Redirect output to a client’s web browser (Excel2007)  
        //clean the output buffer  
        ob_end_clean();  
           
        //this is the header given from PHPExcel examples.   
        //but the output seems somewhat corrupted in some cases.  
        //header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');  
        //so, we use this header instead.  
        header('Content-type: application/vnd.ms-excel');  
        header('Cache-Control: max-age=0');  
           
        $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');  
        // $objWriter->save('php://output');  
        $this->SaveViaTempFile($objWriter);

        // $awal = $this->input->post('tanggal_awal');
        // $akhir = $this->input->post('tanggal_akhir');
        // $data_keuangan=$this->Labmlaporan->get_data_keu_tind($awal, $akhir)->result();
        // echo json_encode($data_keuangan);
    }

    // REKAPITULASI URIKES Khusus Mintohardjo dan keseluruhan ex. mabes
    public function download_rekap_bul_minto($param1='',$param2=''){
        ////EXCEL 
        $this->load->library('Excel');  
           
        // Create new PHPExcel object  
        $objPHPExcel = new PHPExcel();   
           
        // Set document properties  
        $objPHPExcel->getProperties()->setCreator("RSAL Mintohardjo")  
                ->setLastModifiedBy("RSAL Mintohardjo")  
                ->setTitle("Laporan Rekapitulasi RSAL Mintohardjo")  
                ->setSubject("Laporan Rekapitulasi RSAL Mintohardjo Document")  
                ->setDescription("Laporan Rekapitulasi RSAL Mintohardjo, generated by HMIS.")  
                ->setKeywords("RSAL Mintohardjo")  
                ->setCategory("Laporan Rekapitulasi Urikkes");  

        //$objReader = PHPExcel_IOFactory::createReader('Excel2007');    
        //$objPHPExcel = $objReader->load("project.xlsx");
           
        $objReader= PHPExcel_IOFactory::createReader('Excel2007');
        $objReader->setReadDataOnly(true);

        // $awal = $this->input->post('tanggal_awal');
        // $akhir = $this->input->post('tanggal_akhir');

        $tahun=date('Y');
        $bulan=date('m');
        switch ($bulan) {
            case '1':
                $blnrmw='I';
                break;
            case '2':
                $blnrmw='II';
                break;
            case '3':
                $blnrmw='III';
                break;
            case '4':
                $blnrmw='IV';
                break;
            case '5':
                $blnrmw='V';
                break;
            case '6':
                $blnrmw='VI';
                break;
            case '7':
                $blnrmw='VII';
                break;
            case '8':
                $blnrmw='VIII';
                break;
            case '9':
                $blnrmw='IX';
                break;
            case '10':
                $blnrmw='X';
                break;
            case '11':
                $blnrmw='XI';
                break;
            case '12':
                $blnrmw='XII';
                break;
            default:
                break;
        }
        $tanggal=date('d F Y'); 
        
        

        // $hasil=array_count_values(array_column($result, 'tingkatan'));
        // echo $hasil['PAMEN'];
        //$data_keuangan=$this->Murikes->data_rekapitulasi($param1, $param2 )->result();
    
        $objPHPExcel=$objReader->load(APPPATH.'third_party/rekapitulasi_urikes.xlsx');
        // Set active sheet index to the first sheet, so Excel opens this as the first sheet  
        $objPHPExcel->setActiveSheetIndex(0);  
        // Add some data  
        
        $objPHPExcel->getActiveSheet()->getStyle('A10:A13')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet()->getStyle('F10:F13')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet()->getStyle('I10:I13')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet()->mergeCells('A15:A17');
        $objPHPExcel->getActiveSheet()->getStyle('A15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('B15:K15');
        $objPHPExcel->getActiveSheet()->getStyle('B15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('L15:S15');
        $objPHPExcel->getActiveSheet()->getStyle('L15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('B16:C16');
        $objPHPExcel->getActiveSheet()->getStyle('B16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('D16:E16');
        $objPHPExcel->getActiveSheet()->getStyle('D16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('F16:J16');
        $objPHPExcel->getActiveSheet()->getStyle('F16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('L16:M16');
        $objPHPExcel->getActiveSheet()->getStyle('L16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('N16:O16');
        $objPHPExcel->getActiveSheet()->getStyle('N16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('P16:R16');
        $objPHPExcel->getActiveSheet()->getStyle('P16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('T15:T17');  
        $objPHPExcel->getActiveSheet()->getStyle('T15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);        
        
      
        $result = $this->Murikes->get_rek_minto($param1,$param2)->result();
        $count_pati_1 = '';
        $count_pati_2p = '';
        $count_pati_2 = '';
        $count_pati_3p = '';
        $count_pati_3 = '';
        $count_pati_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'PATI' && $row->statkes == 'I') {
                $count_pati_1++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'II P') {
                $count_pati_2p++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'II') {
                $count_pati_2++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'III P') {
                $count_pati_3p++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'III') {
                $count_pati_3++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'IV') {
                $count_pati_4++;
            }
        }
        $count_bintara_1 = '';
        $count_bintara_2p = '';
        $count_bintara_2 = '';
        $count_bintara_3p = '';
        $count_bintara_3 = '';
        $count_bintara_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'BINTARA' && $row->statkes == 'I') {
                $count_bintara_1++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'II P') {
                $count_bintara_2p++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'II') {
                $count_bintara_2++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'III P') {
                $count_bintara_3p++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'III') {
                $count_bintara_3++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'IV') {
                $count_bintara_4++;
            }
        }
        $count_tamtama_1 = '';
        $count_tamtama_2p = '';
        $count_tamtama_2 = '';
        $count_tamtama_3p = '';
        $count_tamtama_3 = '';
        $count_tamtama_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'I') {
                $count_tamtama_1++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'II P') {
                $count_tamtama_2p++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'II') {
                $count_tamtama_2++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'III P') {
                $count_tamtama_3p++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'III') {
                $count_tamtama_3++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'IV') {
                $count_tamtama_4++;
            }
        }
        $count_gol4d_1 = '';
        $count_gol4d_2p = '';
        $count_gol4d_2 = '';
        $count_gol4d_3p = '';
        $count_gol4d_3 = '';
        $count_gol4d_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL IV/D' && $row->statkes == 'I') {
                $count_gol4d_1++;
            } else if ($row->tingkatan == 'GOL IV/D' && $row->statkes == 'II P') {
                $count_gol4d_2p++;
            } else if ($row->tingkatan == 'GOL IV/D' && $row->statkes == 'II') {
                $count_gol4d_2++;
            } else if ($row->tingkatan == 'GOL IV/D' && $row->statkes == 'III P') {
                $count_gol4d_3p++;
            } else if ($row->tingkatan == 'GOL IV/D' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_gol4d_3++;
            } else if ($row->tingkatan == 'GOL IV/D' && $row->statkes == ' IV') {
                $count_gol4d_4++;
            }
        }
        $count_gol4c_1 = '';
        $count_gol4c_2p = '';
        $count_gol4c_2 = '';
        $count_gol4c_3p = '';
        $count_gol4c_3 = '';
        $count_gol4c_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL IV/C' && $row->statkes == 'I') {
                $count_gol4c_1++;
            } else if ($row->tingkatan == 'GOL IV/C' && $row->statkes == 'II P') {
                $count_gol4c_2p++;
            } else if ($row->tingkatan == 'GOL IV/C' && $row->statkes == 'II') {
                $count_gol4c_2++;
            } else if ($row->tingkatan == 'GOL IV/C' && $row->statkes == 'III P') {
                $count_gol4c_3p++;
            } else if ($row->tingkatan == 'GOL IV/C' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_gol4c_3++;
            } else if ($row->tingkatan == 'GOL IV/C' && $row->statkes == 'IV') {
                $count_gol4c_4++;
            }
        }
        $count_gol4b_1 = '';
        $count_gol4b_2p = '';
        $count_gol4b_2 = '';
        $count_gol4b_3p = '';
        $count_gol4b_3 = '';
        $count_gol4b_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL IV/B' && $row->statkes == 'I') {
                $count_gol4b_1++;
            } else if ($row->tingkatan == 'GOL IV/B' && $row->statkes == 'II P') {
                $count_gol4b_2p++;
            } else if ($row->tingkatan == 'GOL IV/B' && $row->statkes == 'II') {
                $count_gol4b_2++;
            } else if ($row->tingkatan == 'GOL IV/B' && $row->statkes == 'III P') {
                $count_gol4b_3p++;
            } else if ($row->tingkatan == 'GOL IV/B' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_gol4b_3++;
            } else if ($row->tingkatan == 'GOL IV/B' && $row->statkes == 'IV') {
                $count_gol4b_4++;
            }
        }
        $count_gol4a_1 = '';
        $count_gol4a_2p = '';
        $count_gol4a_2 = '';
        $count_gol4a_3p = '';
        $count_gol4a_3 = '';
        $count_gol4a_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL IV/A' && $row->statkes == 'I') {
                $count_gol4a_1++;
            } else if ($row->tingkatan == 'GOL IV/A' && $row->statkes == 'II P') {
                $count_gol4a_2p++;
            } else if ($row->tingkatan == 'GOL IV/A' && $row->statkes == 'II') {
                $count_gol4a_2++;
            } else if ($row->tingkatan == 'GOL IV/A' && $row->statkes == 'III P') {
                $count_gol4a_3p++;
            } else if ($row->tingkatan == 'GOL IV/A' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_gol4a_3++;
            } else if ($row->tingkatan == 'GOL IV/A' && $row->statkes == 'IV') {
                $count_gol4a_4++;
            }
        }
        $count_gol3_1 = '';
        $count_gol3_2p = '';
        $count_gol3_2 = '';
        $count_gol3_3p = '';
        $count_gol3_3 = '';
        $count_gol3_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL III' && $row->statkes == 'I') {
                $countgol3_1++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'II P') {
                $count_gol3_2p++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'II') {
                $count_gol3_2++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'III P') {
                $count_gol3_3p++;
            } else if ($row->tingkatan == 'GOL III' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_gol3_3++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'IV') {
                $count_gol3_4++;
            }
        }
        $count_gol2_1 = '';
        $count_gol2_2p = '';
        $count_gol2_2 = '';
        $count_gol2_3p = '';
        $count_gol2_3 = '';
        $count_gol2_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL II' && $row->statkes == 'I') {
                $count_gol2_1++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'II P') {
                $count_gol2_2p++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'II') {
                $count_gol2_2++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'III P') {
                $count_gol2_3p++;
            } else if ($row->tingkatan == 'GOL II' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_gol2_3++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == ' IV') {
                $count_gol2_4++;
            }
        }
        $count_gol1_1 = '';
        $count_gol1_2p = '';
        $count_gol1_2 = '';
        $count_gol1_3p = '';
        $count_gol1_3 = '';
        $count_gol1_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL I' && $row->statkes == 'I') {
                $count_gol1_1++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'II P') {
                $count_gol1_2p++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'II') {
                $count_gol1_2++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'III P') {
                $count_gol1_3p++;
            } else if ($row->tingkatan == 'GOL I' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_gol1_3++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == ' IV') {
                $count_gol1_4++;
            }
        }

        $count_kol_1 = '';
        $count_kol_2 = '';
        $count_kol_2p = '';
        $count_kol_3p = '';
        $count_kol_3 = '';
        $count_kol_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '2' && $row->statkes == 'III P') {
                $count_kol_3p++;
            } else if ($row->urutan == '2' && $row->statkes == 'II P') {
                $count_kol_2p++;
            }
            else if ($row->urutan == '2' && $row->statkes == 'II') {
                $count_kol_2++;
            }
            else if ($row->urutan == '2' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_kol_3++;
            }
            else if ($row->urutan == '2' && $row->statkes == 'I') {
                $count_kol_1++;
            }
            else if ($row->urutan == '2' && $row->statkes == 'IV') {
                $count_kol_4++;
            }
        }
         $count_letkol_1 = '';
        $count_letkol_2 = '';
        $count_letkol_2p = '';
        $count_letkol_3p = '';
        $count_letkol_3 = '';
        $count_letkol_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '3' && $row->statkes == 'III P') {
                $count_letkol_3p++;
            } else if ($row->urutan == '3' && $row->statkes == 'II P') {
                $count_letkol_2p++;
            }
            else if ($row->urutan == '3' && $row->statkes == 'II') {
                $count_letkol_2++;
            }
            else if ($row->urutan == '3' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_letkol_3++;
            }
            else if ($row->urutan == '3' && $row->statkes == 'I') {
                $count_letkol_1++;
            }
            else if ($row->urutan == '3' && $row->statkes == 'IV') {
                $count_letkol_4++;
            }
        }


         $count_mayor_1 = '';
        $count_mayor_2 = '';
        $count_mayor_2p = '';
        $count_mayor_3p = '';
        $count_mayor_3 = '';
        $count_mayor_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '4' && $row->statkes == 'III P') {
                $count_mayor_3p++;
            } else if ($row->urutan == '4' && $row->statkes == 'II P') {
                $count_mayor_2p++;
            }
            else if ($row->urutan == '4' && $row->statkes == 'II') {
                $count_mayor_2++;
            }
            else if ($row->urutan == '4' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_mayor_3++;
            }
            else if ($row->urutan == '4' && $row->statkes == 'I') {
                $count_mayor_1++;
            }
            else if ($row->urutan == '4' && $row->statkes == 'IV') {
                $count_mayor_4++;
            }
        }
         $count_kapten_1 = '';
        $count_kapten_2 = '';
        $count_kapten_2p = '';
        $count_kapten_3p = '';
        $count_kapten_3 = '';
        $count_kapten_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '5' && $row->statkes == 'III P') {
                $count_kapten_3p++;
            } else if ($row->urutan == '5' && $row->statkes == 'II P') {
                $count_kapten_2p++;
            }
            else if ($row->urutan == '5' && $row->statkes == 'II') {
                $count_kapten_2++;
            }
            else if ($row->urutan == '5' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_kapten_3++;
            }
            else if ($row->urutan == '5' && $row->statkes == 'I') {
                $count_kapten_1++;
            }
            else if ($row->urutan == '5' && $row->statkes == 'IV') {
                $count_kapten_4++;
            }
        }
         $count_lettu_1 = '';
        $count_lettu_2 = '';
        $count_lettu_2p = '';
        $count_lettu_3p = '';
        $count_lettu_3 = '';
        $count_lettu_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '6' && $row->statkes == 'III P') {
                $count_lettu_3p++;
            } else if ($row->urutan == '6' && $row->statkes == 'II P') {
                $count_lettu_2p++;
            }
            else if ($row->urutan == '6' && $row->statkes == 'II') {
                $count_lettu_2++;
            }
            else if ($row->urutan == '6' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_lettu_3++;
            }
            else if ($row->urutan == '6' && $row->statkes == 'I') {
                $count_lettu_1++;
            }
            else if ($row->urutan == '6' && $row->statkes == 'IV') {
                $count_lettu_4++;
            }
        }
         $count_letda_1 = '';
        $count_letda_2 = '';
        $count_letda_2p = '';
        $count_letda_3p = '';
        $count_letda_3 = '';
        $count_letda_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '7' && $row->statkes == 'III P') {
                $count_letda_3p++;
            } else if ($row->urutan == '7' && $row->statkes == 'II P') {
                $count_letda_2p++;
            }
            else if ($row->urutan == '7' && $row->statkes == 'II') {
                $count_letda_2++;
            }
            else if ($row->urutan == '7' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_letda_3++;
            }
            else if ($row->urutan == '7' && $row->statkes == 'I') {
                $count_letda_1++;
            }
            else if ($row->urutan == '7' && $row->statkes == 'IV') {
                $count_letda_4++;
            }
        }
        
        $objPHPExcel->getActiveSheet()->setCellValue('B18', $count_pati_1);
        $objPHPExcel->getActiveSheet()->setCellValue('B19', $count_pati_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('B20', $count_pati_2);
        $objPHPExcel->getActiveSheet()->setCellValue('B21', $count_pati_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('B22', $count_pati_3);
        $objPHPExcel->getActiveSheet()->setCellValue('B23', $count_pati_4);

        $objPHPExcel->getActiveSheet()->setCellValue('C18', $count_kol_1);
        $objPHPExcel->getActiveSheet()->setCellValue('C19', $count_kol_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('C20', $count_kol_2);
        $objPHPExcel->getActiveSheet()->setCellValue('C21', $count_kol_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('C22', $count_kol_3);
        $objPHPExcel->getActiveSheet()->setCellValue('C23', $count_kol_4);

        $objPHPExcel->getActiveSheet()->setCellValue('D18', $count_letkol_1);
        $objPHPExcel->getActiveSheet()->setCellValue('D19', $count_letkol_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('D20', $count_letkol_2);
        $objPHPExcel->getActiveSheet()->setCellValue('D21', $count_letkol_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('D22', $count_letkol_3);
        $objPHPExcel->getActiveSheet()->setCellValue('D23', $count_letkol_4);
        
        $objPHPExcel->getActiveSheet()->setCellValue('E18', $count_mayor_1);
        $objPHPExcel->getActiveSheet()->setCellValue('E19', $count_mayor_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('E20', $count_mayor_2);
        $objPHPExcel->getActiveSheet()->setCellValue('E21', $count_mayor_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('E22', $count_mayor_3);
        $objPHPExcel->getActiveSheet()->setCellValue('E23', $count_mayor_4);
        
        $objPHPExcel->getActiveSheet()->setCellValue('F18', $count_kapten_1);
        $objPHPExcel->getActiveSheet()->setCellValue('F19', $count_kapten_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('F20', $count_kapten_2);
        $objPHPExcel->getActiveSheet()->setCellValue('F21', $count_kapten_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('F22', $count_kapten_3);
        $objPHPExcel->getActiveSheet()->setCellValue('F23', $count_kapten_4);

        $objPHPExcel->getActiveSheet()->setCellValue('G18', $count_lettu_1);
        $objPHPExcel->getActiveSheet()->setCellValue('G19', $count_lettu_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('G20', $count_lettu_2);
        $objPHPExcel->getActiveSheet()->setCellValue('G21', $count_lettu_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('G22', $count_lettu_3);
        $objPHPExcel->getActiveSheet()->setCellValue('G23', $count_lettu_4);

        $objPHPExcel->getActiveSheet()->setCellValue('H18', $count_letda_1);
        $objPHPExcel->getActiveSheet()->setCellValue('H19', $count_letda_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('H20', $count_letda_2);
        $objPHPExcel->getActiveSheet()->setCellValue('H21', $count_letda_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('H22', $count_letda_3);
        $objPHPExcel->getActiveSheet()->setCellValue('H23', $count_letda_4);

        $objPHPExcel->getActiveSheet()->setCellValue('I18', $count_bintara_1);
        $objPHPExcel->getActiveSheet()->setCellValue('I19', $count_bintara_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('I20', $count_bintara_2);
        $objPHPExcel->getActiveSheet()->setCellValue('I21', $count_bintara_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('I22', $count_bintara_3);
        $objPHPExcel->getActiveSheet()->setCellValue('I23', $count_bintara_4);

        $objPHPExcel->getActiveSheet()->setCellValue('J18', $count_tamtama_1);
        $objPHPExcel->getActiveSheet()->setCellValue('J19', $count_tamtama_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('J20', $count_tamtama_2);
        $objPHPExcel->getActiveSheet()->setCellValue('J21', $count_tamtama_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('J22', $count_tamtama_3);
        $objPHPExcel->getActiveSheet()->setCellValue('J23', $count_tamtama_4);


        $objPHPExcel->getActiveSheet()->setCellValue('L18', $count_gol4d_1);
        $objPHPExcel->getActiveSheet()->setCellValue('L19', $count_gol4d_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('L20', $count_gol4d_2);
        $objPHPExcel->getActiveSheet()->setCellValue('L21', $count_gol4d_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('L22', $count_gol4d_3);
        $objPHPExcel->getActiveSheet()->setCellValue('L23', $count_gol4d_4);
        
        $objPHPExcel->getActiveSheet()->setCellValue('M18', $count_gol4c_1);
        $objPHPExcel->getActiveSheet()->setCellValue('M19', $count_gol4c_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('M20', $count_gol4c_2);
        $objPHPExcel->getActiveSheet()->setCellValue('M21', $count_gol4c_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('M22', $count_gol4c_3);
        $objPHPExcel->getActiveSheet()->setCellValue('M23', $count_gol4c_4);
        
        $objPHPExcel->getActiveSheet()->setCellValue('N18', $count_gol4b_1);
        $objPHPExcel->getActiveSheet()->setCellValue('N19', $count_gol4b_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('N20', $count_gol4b_2);
        $objPHPExcel->getActiveSheet()->setCellValue('N21', $count_gol4b_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('N22', $count_gol4b_3);
        $objPHPExcel->getActiveSheet()->setCellValue('N23', $count_gol4b_4);

        $objPHPExcel->getActiveSheet()->setCellValue('O18', $count_gol4a_1);
        $objPHPExcel->getActiveSheet()->setCellValue('O19', $count_gol4a_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('O20', $count_gol4a_2);
        $objPHPExcel->getActiveSheet()->setCellValue('O21', $count_gol4a_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('O22', $count_gol4a_3);
        $objPHPExcel->getActiveSheet()->setCellValue('O23', $count_gol4a_4);

        $objPHPExcel->getActiveSheet()->setCellValue('P18', $count_gol3_1);
        $objPHPExcel->getActiveSheet()->setCellValue('P19', $count_gol3_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('P20', $count_gol3_2);
        $objPHPExcel->getActiveSheet()->setCellValue('P21', $count_gol3_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('P22', $count_gol3_3);
        $objPHPExcel->getActiveSheet()->setCellValue('P23', $count_gol3_4);

        $objPHPExcel->getActiveSheet()->setCellValue('Q18', $count_gol2_1);
        $objPHPExcel->getActiveSheet()->setCellValue('Q19', $count_gol2_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('Q20', $count_gol2_2);
        $objPHPExcel->getActiveSheet()->setCellValue('Q21', $count_gol2_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('Q22', $count_gol2_3);
        $objPHPExcel->getActiveSheet()->setCellValue('Q23', $count_gol2_4);

        $objPHPExcel->getActiveSheet()->setCellValue('R18', $count_gol1_1);
        $objPHPExcel->getActiveSheet()->setCellValue('R19', $count_gol1_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('R20', $count_gol1_2);
        $objPHPExcel->getActiveSheet()->setCellValue('R21', $count_gol1_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('R22', $count_gol1_3);
        $objPHPExcel->getActiveSheet()->setCellValue('R23', $count_gol1_4);

        $objPHPExcel->getActiveSheet()->setTitle('Khusus Mintohardjo');  

        $objPHPExcel->setActiveSheetIndex(1);


        $objPHPExcel->getActiveSheet()->getStyle('A10:A13')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet()->getStyle('F10:F13')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet()->getStyle('I10:I13')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
        $objPHPExcel->getActiveSheet()->mergeCells('A15:A17');
        $objPHPExcel->getActiveSheet()->getStyle('A15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('B15:K15');
        $objPHPExcel->getActiveSheet()->getStyle('B15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('L15:S15');
        $objPHPExcel->getActiveSheet()->getStyle('L15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('B16:C16');
        $objPHPExcel->getActiveSheet()->getStyle('B16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('D16:E16');
        $objPHPExcel->getActiveSheet()->getStyle('D16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('F16:J16');
        $objPHPExcel->getActiveSheet()->getStyle('F16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('L16:M16');
        $objPHPExcel->getActiveSheet()->getStyle('L16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('N16:O16');
        $objPHPExcel->getActiveSheet()->getStyle('N16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('P16:R16');
        $objPHPExcel->getActiveSheet()->getStyle('P16')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        $objPHPExcel->getActiveSheet()->mergeCells('T15:T17');  
        $objPHPExcel->getActiveSheet()->getStyle('T15')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);        
        
      
        $result = $this->Murikes->get_rek_ex_mabesal($param1,$param2)->result();
        $count_pati_1s = '';
        $count_pati_2ps = '';
        $count_pati_2s = '';
        $count_pati_3ps = '';
        $count_pati_3s = '';
        $count_pati_4s = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'PATI' && $row->statkes == 'I') {
                $count_pati_1s++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'II P') {
                $count_pati_2ps++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'II') {
                $count_pati_2s++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == 'III P') {
                $count_pati_3ps++;
            } else if ($row->tingkatan == 'PATI' && ($row->statkes == 'III' || $row->statkes == 'III III') ) {
                $count_pati_3s++;
            } else if ($row->tingkatan == 'PATI' && $row->statkes == ' IV') {
                $count_pati_4s++;
            }
        }
        $count_bintara_1 = '';
        $count_bintara_2p = '';
        $count_bintara_2 = '';
        $count_bintara_3p = '';
        $count_bintara_3 = '';
        $count_bintara_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'BINTARA' && $row->statkes == 'I') {
                $count_bintara_1++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'II P') {
                $count_bintara_2p++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'II') {
                $count_bintara_2++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == 'III P') {
                $count_bintara_3p++;
            } else if ($row->tingkatan == 'BINTARA' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_bintara_3++;
            } else if ($row->tingkatan == 'BINTARA' && $row->statkes == ' IV') {
                $count_bintara_4++;
            }
        }
        $count_tamtama_1 = '';
        $count_tamtama_2p = '';
        $count_tamtama_2 = '';
        $count_tamtama_3p = '';
        $count_tamtama_3 = '';
        $count_tamtama_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'I') {
                $count_tamtama_1++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'II P') {
                $count_tamtama_2p++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'II') {
                $count_tamtama_2++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == 'III P') {
                $count_tamtama_3p++;
            } else if ($row->tingkatan == 'TAMTAMA' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_tamtama_3++;
            } else if ($row->tingkatan == 'TAMTAMA' && $row->statkes == ' IV') {
                $count_tamtama_4++;
            }
        }
        $count_gol4d_1 = '';
        $count_gol4d_2p = '';
        $count_gol4d_2 = '';
        $count_gol4d_3p = '';
        $count_gol4d_3 = '';
        $count_gol4d_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL IV/D' && $row->statkes == 'I') {
                $count_gol4d_1++;
            } else if ($row->tingkatan == 'GOL IV/D' && $row->statkes == 'II P') {
                $count_gol4d_2p++;
            } else if ($row->tingkatan == 'GOL IV/D' && $row->statkes == 'II') {
                $count_gol4d_2++;
            } else if ($row->tingkatan == 'GOL IV/D' && $row->statkes == 'III P') {
                $count_gol4d_3p++;
            } else if ($row->tingkatan == 'GOL IV/D' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_gol4d_3++;
            } else if ($row->tingkatan == 'GOL IV/D' && $row->statkes == ' IV') {
                $count_gol4d_4++;
            }
        }
        $count_gol4c_1 = '';
        $count_gol4c_2p = '';
        $count_gol4c_2 = '';
        $count_gol4c_3p = '';
        $count_gol4c_3 = '';
        $count_gol4c_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL IV/C' && $row->statkes == 'I') {
                $count_gol4c_1++;
            } else if ($row->tingkatan == 'GOL IV/C' && $row->statkes == 'II P') {
                $count_gol4c_2p++;
            } else if ($row->tingkatan == 'GOL IV/C' && $row->statkes == 'II') {
                $count_gol4c_2++;
            } else if ($row->tingkatan == 'GOL IV/C' && $row->statkes == 'III P') {
                $count_gol4c_3p++;
            } else if ($row->tingkatan == 'GOL IV/C' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_gol4c_3++;
            } else if ($row->tingkatan == 'GOL IV/C' && $row->statkes == ' IV') {
                $count_gol4c_4++;
            }
        }
        $count_gol4b_1 = '';
        $count_gol4b_2p = '';
        $count_gol4b_2 = '';
        $count_gol4b_3p = '';
        $count_gol4b_3 = '';
        $count_gol4b_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL IV/B' && $row->statkes == 'I') {
                $count_gol4b_1++;
            } else if ($row->tingkatan == 'GOL IV/B' && $row->statkes == 'II P') {
                $count_gol4b_2p++;
            } else if ($row->tingkatan == 'GOL IV/B' && $row->statkes == 'II') {
                $count_gol4b_2++;
            } else if ($row->tingkatan == 'GOL IV/B' && $row->statkes == 'III P') {
                $count_gol4b_3p++;
            } else if ($row->tingkatan == 'GOL IV/B' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_gol4b_3++;
            } else if ($row->tingkatan == 'GOL IV/B' && $row->statkes == ' IV') {
                $count_gol4b_4++;
            }
        }
        $count_gol4a_1 = '';
        $count_gol4a_2p = '';
        $count_gol4a_2 = '';
        $count_gol4a_3p = '';
        $count_gol4a_3 = '';
        $count_gol4a_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL IV/A' && $row->statkes == 'I') {
                $count_gol4a_1++;
            } else if ($row->tingkatan == 'GOL IV/A' && $row->statkes == 'II P') {
                $count_gol4a_2p++;
            } else if ($row->tingkatan == 'GOL IV/A' && $row->statkes == 'II') {
                $count_gol4a_2++;
            } else if ($row->tingkatan == 'GOL IV/A' && $row->statkes == 'III P') {
                $count_gol4a_3p++;
            } else if ($row->tingkatan == 'GOL IV/A' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_gol4a_3++;
            } else if ($row->tingkatan == 'GOL IV/A' && $row->statkes == ' IV') {
                $count_gol4a_4++;
            }
        }
        $count_gol3_1 = '';
        $count_gol3_2p = '';
        $count_gol3_2 = '';
        $count_gol3_3p = '';
        $count_gol3_3 = '';
        $count_gol3_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL III' && $row->statkes == 'I') {
                $countgol3_1++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'II P') {
                $count_gol3_2p++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'II') {
                $count_gol3_2++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == 'III P') {
                $count_gol3_3p++;
            } else if ($row->tingkatan == 'GOL III' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_gol3_3++;
            } else if ($row->tingkatan == 'GOL III' && $row->statkes == ' IV') {
                $count_gol3_4++;
            }
        }
        $count_gol2_1 = '';
        $count_gol2_2p = '';
        $count_gol2_2 = '';
        $count_gol2_3p = '';
        $count_gol2_3 = '';
        $count_gol2_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL II' && $row->statkes == 'I') {
                $count_gol2_1++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'II P') {
                $count_gol2_2p++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'II') {
                $count_gol2_2++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == 'III P') {
                $count_gol2_3p++;
            } else if ($row->tingkatan == 'GOL II' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_gol2_3++;
            } else if ($row->tingkatan == 'GOL II' && $row->statkes == ' IV') {
                $count_gol2_4++;
            }
        }
        $count_gol1_1 = '';
        $count_gol1_2p = '';
        $count_gol1_2 = '';
        $count_gol1_3p = '';
        $count_gol1_3 = '';
        $count_gol1_4 = '';

        foreach ($result as $row) {
            if ($row->tingkatan == 'GOL I' && $row->statkes == 'I') {
                $count_gol1_1++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'II P') {
                $count_gol1_2p++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'II') {
                $count_gol1_2++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == 'III P') {
                $count_gol1_3p++;
            } else if ($row->tingkatan == 'GOL I' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_gol1_3++;
            } else if ($row->tingkatan == 'GOL I' && $row->statkes == ' IV') {
                $count_gol1_4++;
            }
        }

        $count_kol_1 = '';
        $count_kol_2 = '';
        $count_kol_2p = '';
        $count_kol_3p = '';
        $count_kol_3 = '';
        $count_kol_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '2' && $row->statkes == 'III P') {
                $count_kol_3p++;
            } else if ($row->urutan == '2' && $row->statkes == 'II P') {
                $count_kol_2p++;
            }
            else if ($row->urutan == '2' && $row->statkes == 'II') {
                $count_kol_2++;
            }
            else if ($row->urutan == '2' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_kol_3++;
            }
            else if ($row->urutan == '2' && $row->statkes == 'I') {
                $count_kol_1++;
            }
            else if ($row->urutan == '2' && $row->statkes == ' IV') {
                $count_kol_4++;
            }
        }
         $count_letkol_1s = '';
        $count_letkol_2s = '';
        $count_letkol_2ps = '';
        $count_letkol_3ps = '';
        $count_letkol_3s = '';
        $count_letkol_4s = '';

        foreach ($result as $row) {
            if ($row->urutan == '3' && $row->statkes == 'III P') {
                $count_letkol_3ps++;
            } else if ($row->urutan == '3' && $row->statkes == 'II P') {
                $count_letkol_2ps++;
            }
            else if ($row->urutan == '3' && $row->statkes == 'II') {
                $count_letkol_2s++;
            }
            else if ($row->urutan == '3' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_letkol_3s++;
            }
            else if ($row->urutan == '3' && $row->statkes == 'I') {
                $count_letkol_1s++;
            }
            else if ($row->urutan == '3' && $row->statkes == ' IV') {
                $count_letkol_4s++;
            }
        }


         $count_mayor_1 = '';
        $count_mayor_2 = '';
        $count_mayor_2p = '';
        $count_mayor_3p = '';
        $count_mayor_3 = '';
        $count_mayor_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '4' && $row->statkes == 'III P') {
                $count_mayor_3p++;
            } else if ($row->urutan == '4' && $row->statkes == 'II P') {
                $count_mayor_2p++;
            }
            else if ($row->urutan == '4' && $row->statkes == 'II') {
                $count_mayor_2++;
            }
            else if ($row->urutan == '4' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_mayor_3++;
            }
            else if ($row->urutan == '4' && $row->statkes == 'I') {
                $count_mayor_1++;
            }
            else if ($row->urutan == '4' && $row->statkes == ' IV') {
                $count_mayor_4++;
            }
        }
         $count_kapten_1 = '';
        $count_kapten_2 = '';
        $count_kapten_2p = '';
        $count_kapten_3p = '';
        $count_kapten_3 = '';
        $count_kapten_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '5' && $row->statkes == 'III P') {
                $count_kapten_3p++;
            } else if ($row->urutan == '5' && $row->statkes == 'II P') {
                $count_kapten_2p++;
            }
            else if ($row->urutan == '5' && $row->statkes == 'II') {
                $count_kapten_2++;
            }
            else if ($row->urutan == '5' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_kapten_3++;
            }
            else if ($row->urutan == '5' && $row->statkes == 'I') {
                $count_kapten_1++;
            }
            else if ($row->urutan == '5' && $row->statkes == ' IV') {
                $count_kapten_4++;
            }
        }
         $count_lettu_1 = '';
        $count_lettu_2 = '';
        $count_lettu_2p = '';
        $count_lettu_3p = '';
        $count_lettu_3 = '';
        $count_lettu_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '6' && $row->statkes == 'III P') {
                $count_lettu_3p++;
            } else if ($row->urutan == '6' && $row->statkes == 'II P') {
                $count_lettu_2p++;
            }
            else if ($row->urutan == '6' && $row->statkes == 'II') {
                $count_lettu_2++;
            }
            else if ($row->urutan == '6' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_lettu_3++;
            }
            else if ($row->urutan == '6' && $row->statkes == 'I') {
                $count_lettu_1++;
            }
            else if ($row->urutan == '6' && $row->statkes == ' IV') {
                $count_lettu_4++;
            }
        }
         $count_letda_1 = '';
        $count_letda_2 = '';
        $count_letda_2p = '';
        $count_letda_3p = '';
        $count_letda_3 = '';
        $count_letda_4 = '';

        foreach ($result as $row) {
            if ($row->urutan == '7' && $row->statkes == 'III P') {
                $count_letda_3p++;
            } else if ($row->urutan == '7' && $row->statkes == 'II P') {
                $count_letda_2p++;
            }
            else if ($row->urutan == '7' && $row->statkes == 'II') {
                $count_letda_2++;
            }
            else if ($row->urutan == '7' && ($row->statkes == 'III' || $row->statkes == 'III III')) {
                $count_letda_3++;
            }
            else if ($row->urutan == '7' && $row->statkes == 'I') {
                $count_letda_1++;
            }
            else if ($row->urutan == '7' && $row->statkes == ' IV') {
                $count_letda_4++;
            }
        }
        
        $objPHPExcel->getActiveSheet()->setCellValue('B18', $count_pati_1s);
        $objPHPExcel->getActiveSheet()->setCellValue('B19', $count_pati_2ps);
        $objPHPExcel->getActiveSheet()->setCellValue('B20', $count_pati_2s);
        $objPHPExcel->getActiveSheet()->setCellValue('B21', $count_pati_3ps);
        $objPHPExcel->getActiveSheet()->setCellValue('B22', $count_pati_3s);
        $objPHPExcel->getActiveSheet()->setCellValue('B23', $count_pati_4s);

        $objPHPExcel->getActiveSheet()->setCellValue('C18', $count_kol_1);
        $objPHPExcel->getActiveSheet()->setCellValue('C19', $count_kol_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('C20', $count_kol_2);
        $objPHPExcel->getActiveSheet()->setCellValue('C21', $count_kol_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('C22', $count_kol_3);
        $objPHPExcel->getActiveSheet()->setCellValue('C23', $count_kol_4);

        $objPHPExcel->getActiveSheet()->setCellValue('D18', $count_letkol_1s);
        $objPHPExcel->getActiveSheet()->setCellValue('D19', $count_letkol_2ps);
        $objPHPExcel->getActiveSheet()->setCellValue('D20', $count_letkol_2s);
        $objPHPExcel->getActiveSheet()->setCellValue('D21', $count_letkol_3ps);
        $objPHPExcel->getActiveSheet()->setCellValue('D22', $count_letkol_3s);
        $objPHPExcel->getActiveSheet()->setCellValue('D23', $count_letkol_4s);
        
        $objPHPExcel->getActiveSheet()->setCellValue('E18', $count_mayor_1);
        $objPHPExcel->getActiveSheet()->setCellValue('E19', $count_mayor_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('E20', $count_mayor_2);
        $objPHPExcel->getActiveSheet()->setCellValue('E21', $count_mayor_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('E22', $count_mayor_3);
        $objPHPExcel->getActiveSheet()->setCellValue('E23', $count_mayor_4);
        
        $objPHPExcel->getActiveSheet()->setCellValue('F18', $count_kapten_1);
        $objPHPExcel->getActiveSheet()->setCellValue('F19', $count_kapten_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('F20', $count_kapten_2);
        $objPHPExcel->getActiveSheet()->setCellValue('F21', $count_kapten_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('F22', $count_kapten_3);
        $objPHPExcel->getActiveSheet()->setCellValue('F23', $count_kapten_4);

        $objPHPExcel->getActiveSheet()->setCellValue('G18', $count_lettu_1);
        $objPHPExcel->getActiveSheet()->setCellValue('G19', $count_lettu_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('G20', $count_lettu_2);
        $objPHPExcel->getActiveSheet()->setCellValue('G21', $count_lettu_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('G22', $count_lettu_3);
        $objPHPExcel->getActiveSheet()->setCellValue('G23', $count_lettu_4);

        $objPHPExcel->getActiveSheet()->setCellValue('H18', $count_letda_1);
        $objPHPExcel->getActiveSheet()->setCellValue('H19', $count_letda_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('H20', $count_letda_2);
        $objPHPExcel->getActiveSheet()->setCellValue('H21', $count_letda_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('H22', $count_letda_3);
        $objPHPExcel->getActiveSheet()->setCellValue('H23', $count_letda_4);

        $objPHPExcel->getActiveSheet()->setCellValue('I18', $count_bintara_1);
        $objPHPExcel->getActiveSheet()->setCellValue('I19', $count_bintara_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('I20', $count_bintara_2);
        $objPHPExcel->getActiveSheet()->setCellValue('I21', $count_bintara_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('I22', $count_bintara_3);
        $objPHPExcel->getActiveSheet()->setCellValue('I23', $count_bintara_4);

        $objPHPExcel->getActiveSheet()->setCellValue('J18', $count_tamtama_1);
        $objPHPExcel->getActiveSheet()->setCellValue('J19', $count_tamtama_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('J20', $count_tamtama_2);
        $objPHPExcel->getActiveSheet()->setCellValue('J21', $count_tamtama_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('J22', $count_tamtama_3);
        $objPHPExcel->getActiveSheet()->setCellValue('J23', $count_tamtama_4);


        $objPHPExcel->getActiveSheet()->setCellValue('L18', $count_gol4d_1);
        $objPHPExcel->getActiveSheet()->setCellValue('L19', $count_gol4d_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('L20', $count_gol4d_2);
        $objPHPExcel->getActiveSheet()->setCellValue('L21', $count_gol4d_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('L22', $count_gol4d_3);
        $objPHPExcel->getActiveSheet()->setCellValue('L23', $count_gol4d_4);
        
        $objPHPExcel->getActiveSheet()->setCellValue('M18', $count_gol4c_1);
        $objPHPExcel->getActiveSheet()->setCellValue('M19', $count_gol4c_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('M20', $count_gol4c_2);
        $objPHPExcel->getActiveSheet()->setCellValue('M21', $count_gol4c_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('M22', $count_gol4c_3);
        $objPHPExcel->getActiveSheet()->setCellValue('M23', $count_gol4c_4);
        
        $objPHPExcel->getActiveSheet()->setCellValue('N18', $count_gol4b_1);
        $objPHPExcel->getActiveSheet()->setCellValue('N19', $count_gol4b_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('N20', $count_gol4b_2);
        $objPHPExcel->getActiveSheet()->setCellValue('N21', $count_gol4b_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('N22', $count_gol4b_3);
        $objPHPExcel->getActiveSheet()->setCellValue('N23', $count_gol4b_4);

        $objPHPExcel->getActiveSheet()->setCellValue('O18', $count_gol4a_1);
        $objPHPExcel->getActiveSheet()->setCellValue('O19', $count_gol4a_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('O20', $count_gol4a_2);
        $objPHPExcel->getActiveSheet()->setCellValue('O21', $count_gol4a_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('O22', $count_gol4a_3);
        $objPHPExcel->getActiveSheet()->setCellValue('O23', $count_gol4a_4);

        $objPHPExcel->getActiveSheet()->setCellValue('P18', $count_gol3_1);
        $objPHPExcel->getActiveSheet()->setCellValue('P19', $count_gol3_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('P20', $count_gol3_2);
        $objPHPExcel->getActiveSheet()->setCellValue('P21', $count_gol3_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('P22', $count_gol3_3);
        $objPHPExcel->getActiveSheet()->setCellValue('P23', $count_gol3_4);

        $objPHPExcel->getActiveSheet()->setCellValue('Q18', $count_gol2_1);
        $objPHPExcel->getActiveSheet()->setCellValue('Q19', $count_gol2_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('Q20', $count_gol2_2);
        $objPHPExcel->getActiveSheet()->setCellValue('Q21', $count_gol2_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('Q22', $count_gol2_3);
        $objPHPExcel->getActiveSheet()->setCellValue('Q23', $count_gol2_4);

        $objPHPExcel->getActiveSheet()->setCellValue('R18', $count_gol1_1);
        $objPHPExcel->getActiveSheet()->setCellValue('R19', $count_gol1_2p);
        $objPHPExcel->getActiveSheet()->setCellValue('R20', $count_gol1_2);
        $objPHPExcel->getActiveSheet()->setCellValue('R21', $count_gol1_3p);
        $objPHPExcel->getActiveSheet()->setCellValue('R22', $count_gol1_3);
        $objPHPExcel->getActiveSheet()->setCellValue('R23', $count_gol1_4);

        
          
        $filename = "Laporan Khusus Mintohardjo".date('d F Y', strtotime($param1))." - ".date('d F Y', strtotime($param2));
        header('Content-Disposition: attachment;filename="'.$filename.'.xls"');  
                
        // Rename worksheet (worksheet, not filename)  
        $objPHPExcel->getActiveSheet()->setTitle('Keseluruhan ex. Mabes');    
           
        // Redirect output to a client’s web browser (Excel2007)  
        //clean the output buffer  
        ob_end_clean();  
           
        //this is the header given from PHPExcel examples.   
        //but the output seems somewhat corrupted in some cases.  
        //header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');  
        //so, we use this header instead.  
        header('Content-type: application/vnd.ms-excel');  
        header('Cache-Control: max-age=0');  
           
        $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');  
        // $objWriter->save('php://output');  
        $this->SaveViaTempFile($objWriter);

        // $awal = $this->input->post('tanggal_awal');
        // $akhir = $this->input->post('tanggal_akhir');
        // $data_keuangan=$this->Labmlaporan->get_data_keu_tind($awal, $akhir)->result();
        // echo json_encode($data_keuangan);
    }


}
                  
?>
