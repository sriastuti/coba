-- View structure for dashboard_kunj_poli
-- ----------------------------
DROP VIEW IF EXISTS `dashboard_kunj_poli`;
CREATE   VIEW `dashboard_kunj_poli` AS select left(`c`.`tgl_kunjungan`,10) AS `tgl_kunjungan`,`c`.`cara_bayar` AS `cara_bayar`,`c`.`no_register` AS `no_register`,`b`.`nama` AS `nama`,left(`b`.`tgl_lahir`,10) AS `tgl_lahir`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) < 6),1,0) AS `usia1`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 6 and 11),1,0) AS `usia2`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 12 and 16),1,0) AS `usia3`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 17 and 25),1,0) AS `usia4`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 26 and 35),1,0) AS `usia5`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 36 and 45),1,0) AS `usia6`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 46 and 55),1,0) AS `usia7`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 56 and 65),1,0) AS `usia8`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) > 65),1,0) AS `usia9`,`b`.`no_cm` AS `no_cm`,`c`.`id_poli` AS `id_poli`,`a`.`nm_poli` AS `nm_poli`,`d`.`id_diagnosa` AS `id_diagnosa`,`d`.`diagnosa` AS `diagnosa`,`p`.`pangkat` AS `pangkat`,if((`b`.`sex` = 'L'),1,'') AS `L`,if((`b`.`sex` = 'P'),1,'') AS `P`,if((`c`.`jns_kunj` = 'BARU'),1,'') AS `BARU`,if((`c`.`jns_kunj` = 'LAMA'),1,'') AS `LAMA`,timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) AS `age`,if((`c`.`cara_bayar` = 'UMUM'),1,'') AS `umum`,if((`c`.`id_kontraktor` = '2'),1,'') AS `tni_al_m`,if((`c`.`id_kontraktor` = '5'),1,'') AS `tni_al_s`,if((`c`.`id_kontraktor` = '7'),1,'') AS `tni_al_k`,if((`c`.`id_kontraktor` in ('1','3')),1,'') AS `tni_n_al_m`,if((`c`.`id_kontraktor` = '6'),1,'') AS `tni_n_al_s`,if((`c`.`id_kontraktor` = '8'),1,'') AS `tni_n_al_k`,if((`c`.`id_kontraktor` = '4'),1,'') AS `pol`,if((`c`.`id_kontraktor` = '9'),1,'') AS `pol_k`,if((`c`.`id_kontraktor` = '10'),1,'') AS `askes_al`,if((`c`.`id_kontraktor` = '11'),1,'') AS `askes_n_al`,if((`c`.`id_kontraktor` = '12'),1,'') AS `bpjs_kes`,if((`c`.`id_kontraktor` = '13'),1,'') AS `kjs`,if((`c`.`id_kontraktor` = '14'),1,'') AS `pbi`,if((`c`.`id_kontraktor` = '15'),1,'') AS `bpjs_ket`,if((`c`.`id_kontraktor` = '16'),1,'') AS `phl`,if((`c`.`id_kontraktor` = '17'),1,'') AS `jam_per`,if(((`c`.`id_kontraktor` not in ('14','15','16','17')) and (`k`.`jamsoskes` = '0')),1,'') AS `kerjasama`,`b`.`nrp_sbg` AS `nrp_sbg`,`b`.`no_nrp` AS `no_nrp`,`c`.`id_kontraktor` AS `id_kontraktor`,`c`.`ket_pulang` AS `ket_pulang` from (((((`daftar_ulang_irj` `c` join `data_pasien` `b` on((`b`.`no_medrec` = `c`.`no_medrec`))) left join `tni_pangkat` `p` on((`b`.`pkt_id` = `p`.`pangkat_id`))) join `poliklinik` `a` on((`a`.`id_poli` = `c`.`id_poli`))) left join `kontraktor` `k` on((`c`.`id_kontraktor` = `k`.`id_kontraktor`))) left join `diagnosa_pasien` `d` on(((`c`.`no_register` = `d`.`no_register`) and (`d`.`klasifikasi_diagnos` = 'utama')))) ;

-- ----------------------------
-- View structure for dashboard_pendapatan
-- ----------------------------
DROP VIEW IF EXISTS `dashboard_pendapatan`;
CREATE   VIEW `dashboard_pendapatan` AS select 'rawat jalan' AS `jenis`,`a`.`no_register` AS `no_register`,`a`.`id_poli` AS `id_poli`,sum(`a`.`vtot`) AS `sum_vtot`,`a`.`bayar` AS `bayar`,`a`.`bpjs` AS `bpjs`,left(`b`.`tgl_kunjungan`,10) AS `tgl_kunjungan`,`b`.`cara_bayar` AS `cara_bayar` from (`pelayanan_poli` `a` left join `daftar_ulang_irj` `b` on((`a`.`no_register` = `b`.`no_register`))) where (((`b`.`cara_bayar` <> 'BPJS') or (`a`.`bpjs` <> 0)) and (`a`.`id_poli` <> 'BA00') and (`a`.`id_poli` <> 'BK01')) group by `a`.`no_register` union select 'rawat darurat' AS `jenis`,`a`.`no_register` AS `no_register`,`a`.`id_poli` AS `id_poli`,sum(`a`.`vtot`) AS `sum_vtot`,`a`.`bayar` AS `bayar`,`a`.`bpjs` AS `bpjs`,left(`b`.`tgl_kunjungan`,10) AS `tgl_kunjungan`,`b`.`cara_bayar` AS `cara_bayar` from (`pelayanan_poli` `a` left join `daftar_ulang_irj` `b` on((`a`.`no_register` = `b`.`no_register`))) where (((`b`.`cara_bayar` <> 'BPJS') or (`a`.`bpjs` <> 0)) and (`a`.`id_poli` = 'BA00')) group by `a`.`no_register` union select 'penunjang' AS `jenis`,`a`.`no_register` AS `no_register`,'fisio' AS `id_poli`,sum(`a`.`vtot`) AS `sum_vtot`,`a`.`bayar` AS `bayar`,`a`.`bpjs` AS `bpjs`,left(`b`.`tgl_kunjungan`,10) AS `tgl_kunjungan`,`b`.`cara_bayar` AS `cara_bayar` from (`pelayanan_poli` `a` left join `daftar_ulang_irj` `b` on((`a`.`no_register` = `b`.`no_register`))) where (((`b`.`cara_bayar` <> 'BPJS') or (`a`.`bpjs` <> 0)) and (`a`.`id_poli` = 'BK01')) group by `a`.`no_register` union select 'penunjang' AS `jenis`,`a`.`no_lab` AS `no_register`,'lab' AS `id_poli`,sum(`a`.`vtot`) AS `sum_vtot`,`a`.`cetak_kwitansi` AS `cetak_kwitansi`,'1' AS `bpjs`,left(`a`.`tgl_kunjungan`,10) AS `tgl_kunjungan`,`a`.`cara_bayar` AS `cara_bayar` from `pemeriksaan_laboratorium` `a` where (`a`.`no_lab` is not null) group by `a`.`no_lab` union select 'penunjang' AS `jenis`,`a`.`no_rad` AS `no_register`,'rad' AS `id_poli`,sum(`a`.`vtot`) AS `sum_vtot`,`a`.`cetak_kwitansi` AS `cetak_kwitansi`,'1' AS `bpjs`,left(`a`.`tgl_kunjungan`,10) AS `tgl_kunjungan`,`a`.`cara_bayar` AS `cara_bayar` from `pemeriksaan_radiologi` `a` where (`a`.`no_rad` is not null) group by `a`.`no_rad` union select 'penunjang' AS `jenis`,`a`.`no_pa` AS `no_register`,'pa' AS `id_poli`,sum(`a`.`vtot`) AS `sum_vtot`,`a`.`cetak_kwitansi` AS `cetak_kwitansi`,'1' AS `bpjs`,left(`a`.`tgl_kunjungan`,10) AS `tgl_kunjungan`,`a`.`cara_bayar` AS `cara_bayar` from `pemeriksaan_patologianatomi` `a` where (`a`.`no_pa` is not null) group by `a`.`no_pa` union select 'rawat inap' AS `jenis`,`a`.`no_ipd` AS `no_register`,'inap' AS `id_poli`,sum(`a`.`vtot`) AS `sum_vtot`,`b`.`cetak_kwitansi` AS `bayar`,'1' AS `bpjs`,left(`b`.`tgl_keluar`,10) AS `tgl_kunjungan`,`b`.`carabayar` AS `carabayar` from (`pelayanan_iri` `a` left join `pasien_iri` `b` on((`a`.`no_ipd` = `b`.`no_ipd`))) where (`b`.`tgl_keluar` is not null) group by `a`.`no_ipd` ;

-- ----------------------------
-- View structure for data_alamat
-- ----------------------------
DROP VIEW IF EXISTS `data_alamat`;
CREATE   VIEW `data_alamat` AS select `data_pasien`.`no_cm` AS `no_cm`,`data_pasien`.`nama` AS `nama`,`data_pasien`.`alamat` AS `alamat`,`data_pasien`.`kelurahandesa` AS `kelurahandesa`,`data_pasien`.`kecamatan` AS `kecamatan`,`data_pasien`.`kotakabupaten` AS `kotakabupaten`,`data_pasien`.`provinsi` AS `provinsi`,`data_pasien`.`tgl_daftar` AS `tgl_daftar` from `data_pasien` where ((`data_pasien`.`no_cm` <> '') and (convert(left(`data_pasien`.`tgl_daftar`,4) using utf8mb4) = '2017')) order by `data_pasien`.`tgl_daftar` desc ;

-- ----------------------------
-- View structure for data_diagnosa_ird
-- ----------------------------
DROP VIEW IF EXISTS `data_diagnosa_ird`;
CREATE   VIEW `data_diagnosa_ird` AS select left(`diagnosa_pasien`.`tgl_kunjungan`,10) AS `tgl_kunjungan`,`diagnosa_pasien`.`id_diagnosa` AS `id_diagnosa`,`diagnosa_pasien`.`diagnosa` AS `nm_diagnosa`,count(`diagnosa_pasien`.`no_register`) AS `jumlah` from `diagnosa_pasien` where ((`diagnosa_pasien`.`klasifikasi_diagnos` = 'utama') and (`diagnosa_pasien`.`id_poli` = 'BA00')) group by left(`diagnosa_pasien`.`tgl_kunjungan`,10),`diagnosa_pasien`.`id_diagnosa`,`diagnosa_pasien`.`diagnosa` ;

-- ----------------------------
-- View structure for data_diagnosa_iri
-- ----------------------------
DROP VIEW IF EXISTS `data_diagnosa_iri`;
CREATE   VIEW `data_diagnosa_iri` AS select `pasien_iri`.`tgl_keluar` AS `tgl_kunjungan`,`pasien_iri`.`diagnosa1` AS `id_diagnosa`,`icd1`.`nm_diagnosa` AS `nm_diagnosa`,count(`pasien_iri`.`no_ipd`) AS `jumlah` from (`pasien_iri` join `icd1`) where (`pasien_iri`.`diagnosa1` = `icd1`.`id_icd`) group by left(`pasien_iri`.`tgl_keluar`,10),`pasien_iri`.`diagnosa1`,`icd1`.`nm_diagnosa` ;

-- ----------------------------
-- View structure for data_diagnosa_irj
-- ----------------------------
DROP VIEW IF EXISTS `data_diagnosa_irj`;
CREATE   VIEW `data_diagnosa_irj` AS select left(`diagnosa_pasien`.`tgl_kunjungan`,10) AS `tgl_kunjungan`,`diagnosa_pasien`.`id_diagnosa` AS `id_diagnosa`,`diagnosa_pasien`.`diagnosa` AS `nm_diagnosa`,count(`diagnosa_pasien`.`no_register`) AS `jumlah` from `diagnosa_pasien` where ((`diagnosa_pasien`.`klasifikasi_diagnos` = 'utama') and (`diagnosa_pasien`.`id_poli` <> 'BA00')) group by left(`diagnosa_pasien`.`tgl_kunjungan`,10),`diagnosa_pasien`.`id_diagnosa`,`diagnosa_pasien`.`diagnosa` ;

-- ----------------------------
-- View structure for data_double
-- ----------------------------
DROP VIEW IF EXISTS `data_double`;
CREATE   VIEW `data_double` AS select `data_pasien`.`no_cm` AS `no_cm`,count(`data_pasien`.`no_cm`) AS `data_aja` from `data_pasien` group by `data_pasien`.`no_cm` order by `data_pasien`.`no_cm` ;

-- ----------------------------
-- View structure for data_kamar
-- ----------------------------
DROP VIEW IF EXISTS `data_kamar`;
CREATE   VIEW `data_kamar` AS select `a`.`bed` AS `bed`,`b`.`nmruang` AS `nmruang`,`a`.`kelas` AS `kelas`,`a`.`idrg` AS `idrg`,`a`.`isi` AS `isi`,`b`.`lokasi` AS `lokasi` from (`bed` `a` left join `ruang` `b` on((`a`.`idrg` = `b`.`idrg`))) ;

-- ----------------------------
-- View structure for data_keuangan
-- ----------------------------
DROP VIEW IF EXISTS `data_keuangan`;
CREATE  SQL SECURITY DEFINER  VIEW `data_keuangan` AS select `a`.`rencana_penggunaan` AS `rencana_penggunaan`,`a`.`mata_anggaran` AS `mata_anggaran`,`a`.`ma_child` AS `ma_child`,`a`.`jenis_penggunaan` AS `jenis_penggunaan`,`b`.`nm_manggaran` AS `nm_manggaran`,`c`.`nm_manggaran` AS `detail`,`a`.`sumber_dana` AS `sumber_dana`,left(`a`.`created_date`,10) AS `tgl`,sum(`a`.`nominal`) AS `nominal` from ((`penggunaan_dana` `a` left join `mata_anggaran` `b` on((`a`.`mata_anggaran` = `b`.`kode_manggaran`))) left join `mata_anggaran` `c` on((`a`.`ma_child` = `c`.`kode_manggaran`))) group by `a`.`ma_child`,`a`.`sumber_dana`,`a`.`rencana_penggunaan`,`a`.`jenis_penggunaan` order by `a`.`mata_anggaran`,`a`.`ma_child` ;

-- ----------------------------
-- View structure for data_kunjungan_poli
-- ----------------------------
DROP VIEW IF EXISTS `data_kunjungan_poli`;
CREATE   VIEW `data_kunjungan_poli` AS select `a`.`tgl_kunjungan` AS `tgl_kunjungan`,`a`.`id_poli` AS `id_poli`,`b`.`nm_poli` AS `nm_poli`,count(`a`.`no_register`) AS `jumlah` from (`daftar_ulang_irj` `a` join `poliklinik` `b`) where (`a`.`id_poli` = `b`.`id_poli`) group by `a`.`tgl_kunjungan`,`a`.`id_poli` ;

-- ----------------------------
-- View structure for data_pasien_cara_bayar
-- ----------------------------
DROP VIEW IF EXISTS `data_pasien_cara_bayar`;
CREATE   VIEW `data_pasien_cara_bayar` AS select `irddaftar_ulang`.`no_register` AS `no_register`,`irddaftar_ulang`.`cara_bayar` AS `cara_bayar`,left(`irddaftar_ulang`.`tgl_kunjungan`,10) AS `tgl`,(((`irddaftar_ulang`.`vtot` + `irddaftar_ulang`.`vtot_lab`) + `irddaftar_ulang`.`vtot_obat`) + `irddaftar_ulang`.`vtot_rad`) AS `total` from `irddaftar_ulang` union select `daftar_ulang_irj`.`no_register` AS `no_register`,`daftar_ulang_irj`.`cara_bayar` AS `cara_bayar`,left(`daftar_ulang_irj`.`tgl_kunjungan`,10) AS `tgl`,(((`daftar_ulang_irj`.`vtot` + `daftar_ulang_irj`.`vtot_lab`) + `daftar_ulang_irj`.`vtot_obat`) + `daftar_ulang_irj`.`vtot_rad`) AS `total` from `daftar_ulang_irj` union select `pasien_iri`.`no_ipd` AS `no_register`,`pasien_iri`.`carabayar` AS `cara_bayar`,left(`pasien_iri`.`tgldaftarri`,10) AS `tgl`,(((`pasien_iri`.`vtot` + `pasien_iri`.`vtot_lab`) + `pasien_iri`.`vtot_obat`) + `pasien_iri`.`vtot_rad`) AS `total` from `pasien_iri` ;

-- ----------------------------
-- View structure for data_pendapatan_keseluruhan
-- ----------------------------
DROP VIEW IF EXISTS `data_pendapatan_keseluruhan`;
CREATE   VIEW `data_pendapatan_keseluruhan` AS select 'RAWAT JALAN' AS `label`,sum(`pelayanan_poli`.`vtot`) AS `value`,left(`pelayanan_poli`.`tgl_kunjungan`,10) AS `tgl` from `pelayanan_poli` where ((`pelayanan_poli`.`id_poli` <> 'BA00') and (`pelayanan_poli`.`bayar` = 1) and (`pelayanan_poli`.`bpjs` = 0)) group by left(`pelayanan_poli`.`tgl_kunjungan`,10) union select 'RAWAT DARURAT' AS `label`,sum(`pelayanan_poli`.`vtot`) AS `value`,left(`pelayanan_poli`.`tgl_kunjungan`,10) AS `tgl` from `pelayanan_poli` where ((`pelayanan_poli`.`id_poli` = 'BA00') and (`pelayanan_poli`.`bayar` = 1) and (`pelayanan_poli`.`bpjs` = 0)) group by left(`pelayanan_poli`.`tgl_kunjungan`,10) union select 'RAWAT INAP' AS `label`,sum(`pelayanan_iri`.`vtot`) AS `value`,left(`pelayanan_iri`.`tgl_layanan`,10) AS `tgl` from `pelayanan_iri` group by left(`pelayanan_iri`.`tgl_layanan`,10) union select 'RAWAT INAP' AS `label`,sum(`pasien_iri`.`vtot_ruang`) AS `value`,left(`pasien_iri`.`tgl_keluar`,10) AS `tgl` from `pasien_iri` where ((`pasien_iri`.`tgl_keluar` is not null) and (`pasien_iri`.`cetak_kwitansi` = 1)) group by `pasien_iri`.`tgl_keluar` union select 'FARMASI' AS `label`,sum(`resep_pasien`.`vtot`) AS `value`,left(`resep_pasien`.`tgl_kunjungan`,10) AS `tgl` from `resep_pasien` where ((`resep_pasien`.`cara_bayar` <> 'BPJS') and (`resep_pasien`.`cetak_kwitansi` = 1)) group by left(`resep_pasien`.`tgl_kunjungan`,10) union select 'PATOLOGI ANATOMI' AS `label`,sum(`pemeriksaan_patologianatomi`.`vtot`) AS `value`,left(`pemeriksaan_patologianatomi`.`tgl_kunjungan`,10) AS `tgl` from `pemeriksaan_patologianatomi` where ((`pemeriksaan_patologianatomi`.`cara_bayar` <> 'BPJS') and (`pemeriksaan_patologianatomi`.`cetak_kwitansi` = 1)) group by left(`pemeriksaan_patologianatomi`.`tgl_kunjungan`,10) union select 'LABORATORIUM' AS `label`,sum(`pemeriksaan_laboratorium`.`vtot`) AS `value`,left(`pemeriksaan_laboratorium`.`tgl_kunjungan`,10) AS `tgl` from `pemeriksaan_laboratorium` where ((`pemeriksaan_laboratorium`.`cara_bayar` <> 'BPJS') and (`pemeriksaan_laboratorium`.`cetak_kwitansi` = 1)) group by left(`pemeriksaan_laboratorium`.`tgl_kunjungan`,10) union select 'RADIOLOGI' AS `label`,sum(`pemeriksaan_radiologi`.`vtot`) AS `value`,left(`pemeriksaan_radiologi`.`tgl_kunjungan`,10) AS `tgl` from `pemeriksaan_radiologi` where ((`pemeriksaan_radiologi`.`cara_bayar` <> 'BPJS') and (`pemeriksaan_radiologi`.`cetak_kwitansi` = 1)) group by left(`pemeriksaan_radiologi`.`tgl_kunjungan`,10) order by `tgl` desc ;

-- ----------------------------
-- View structure for data_pendapatan_keseluruhan_old
-- ----------------------------
DROP VIEW IF EXISTS `data_pendapatan_keseluruhan_old`;
CREATE   VIEW `data_pendapatan_keseluruhan_old` AS select 'RAWAT JALAN' AS `label`,sum(`daftar_ulang_irj`.`vtot`) AS `value`,left(`daftar_ulang_irj`.`tgl_kunjungan`,10) AS `tgl` from `daftar_ulang_irj` where (`daftar_ulang_irj`.`id_poli` <> 'BA00') group by left(`daftar_ulang_irj`.`tgl_kunjungan`,10) union select 'RAWAT DARURAT' AS `label`,sum(`daftar_ulang_irj`.`vtot`) AS `value`,left(`daftar_ulang_irj`.`tgl_kunjungan`,10) AS `tgl` from `daftar_ulang_irj` where (`daftar_ulang_irj`.`id_poli` = 'BA00') group by left(`daftar_ulang_irj`.`tgl_kunjungan`,10) union select 'RAWAT INAP' AS `label`,(ifnull(`a`.`vtot`,0) + ifnull((select sum((`pelayanan_iri`.`vtot` + `pelayanan_iri`.`tarifalkes`)) from `pelayanan_iri` where (`pelayanan_iri`.`no_ipd` = `a`.`no_ipd`) group by `pelayanan_iri`.`no_ipd`),0)) AS `value`,`c`.`tgl_keluar` AS `tgl` from (`ruang_iri` `a` join `pasien_iri` `c`) where (`a`.`no_ipd` = `c`.`no_ipd`) group by `a`.`no_ipd` union select 'FARMASI' AS `label`,sum(`resep_pasien`.`vtot`) AS `value`,left(`resep_pasien`.`tgl_kunjungan`,10) AS `tgl` from `resep_pasien` group by left(`resep_pasien`.`tgl_kunjungan`,10) union select 'PATOLOGI ANATOMI' AS `label`,sum(`pemeriksaan_patologianatomi`.`vtot`) AS `value`,left(`pemeriksaan_patologianatomi`.`tgl_kunjungan`,10) AS `tgl` from `pemeriksaan_patologianatomi` group by left(`pemeriksaan_patologianatomi`.`tgl_kunjungan`,10) union select 'LABORATORIUM' AS `label`,sum(`pemeriksaan_laboratorium`.`vtot`) AS `value`,left(`pemeriksaan_laboratorium`.`tgl_kunjungan`,10) AS `tgl` from `pemeriksaan_laboratorium` group by left(`pemeriksaan_laboratorium`.`tgl_kunjungan`,10) union select 'RADIOLOGI' AS `label`,sum(`pemeriksaan_radiologi`.`vtot`) AS `value`,left(`pemeriksaan_radiologi`.`tgl_kunjungan`,10) AS `tgl` from `pemeriksaan_radiologi` group by left(`pemeriksaan_radiologi`.`tgl_kunjungan`,10) order by `tgl` desc ;

-- ----------------------------
-- View structure for detail_jumlah_kunjungan
-- ----------------------------
DROP VIEW IF EXISTS `detail_jumlah_kunjungan`;
CREATE   VIEW `detail_jumlah_kunjungan` AS select left(`a`.`tgl_kunjungan`,10) AS `tanggal`,count(`a`.`no_register`) AS `irj`,0 AS `ird`,0 AS `iri_masuk_1`,0 AS `iri_masuk_2`,0 AS `iri_masuk_3`,0 AS `iri_keluar_1`,0 AS `iri_keluar_2`,0 AS `iri_keluar_3` from `daftar_ulang_irj` `a` group by left(`a`.`tgl_kunjungan`,10) union all select left(`a`.`tgl_kunjungan`,10) AS `tanggal`,0 AS `irj`,count(`a`.`no_register`) AS `ird`,0 AS `iri_masuk_1`,0 AS `iri_masuk_2`,0 AS `iri_masuk_3`,0 AS `iri_keluar_1`,0 AS `iri_keluar_2`,0 AS `iri_keluar_3` from `irddaftar_ulang` `a` group by left(`a`.`tgl_kunjungan`,10) union all select left(`a`.`tgl_masuk`,10) AS `tanggal`,0 AS `irj`,0 AS `ird`,count(`a`.`no_ipd`) AS `iri_masuk_1`,0 AS `iri_masuk_2`,0 AS `iri_masuk_3`,0 AS `iri_keluar_1`,0 AS `iri_keluar_2`,0 AS `iri_keluar_3` from `pasien_iri` `a` where (left(`a`.`idrg`,1) = '1') group by left(`a`.`tgl_masuk`,10) union all select left(`a`.`tgl_masuk`,10) AS `tanggal`,0 AS `irj`,0 AS `ird`,0 AS `iri_masuk_1`,count(`a`.`no_ipd`) AS `iri_masuk_2`,0 AS `iri_masuk_3`,0 AS `iri_keluar_1`,0 AS `iri_keluar_2`,0 AS `iri_keluar_3` from `pasien_iri` `a` where (left(`a`.`idrg`,1) = '2') group by left(`a`.`tgl_masuk`,10) union all select left(`a`.`tgl_masuk`,10) AS `tanggal`,0 AS `irj`,0 AS `ird`,0 AS `iri_masuk_1`,0 AS `iri_masuk_2`,count(`a`.`no_ipd`) AS `iri_masuk_3`,0 AS `iri_keluar_1`,0 AS `iri_keluar_2`,0 AS `iri_keluar_3` from `pasien_iri` `a` where (left(`a`.`idrg`,1) = '3') group by left(`a`.`tgl_masuk`,10) union all select left(`a`.`tgl_keluar`,10) AS `tanggal`,0 AS `irj`,0 AS `ird`,0 AS `iri_masuk_1`,0 AS `iri_masuk_2`,0 AS `iri_masuk_3`,count(`a`.`no_ipd`) AS `iri_keluar_1`,0 AS `iri_keluar_2`,0 AS `iri_keluar_3` from `pasien_iri` `a` where (left(`a`.`idrg`,1) = '1') group by left(`a`.`tgl_keluar`,10) union all select left(`a`.`tgl_keluar`,10) AS `tanggal`,0 AS `irj`,0 AS `ird`,0 AS `iri_masuk_1`,0 AS `iri_masuk_2`,0 AS `iri_masuk_3`,0 AS `iri_keluar_1`,count(`a`.`no_ipd`) AS `iri_keluar_2`,0 AS `iri_keluar_3` from `pasien_iri` `a` where (left(`a`.`idrg`,1) = '2') group by left(`a`.`tgl_keluar`,10) union all select left(`a`.`tgl_keluar`,10) AS `tanggal`,0 AS `irj`,0 AS `ird`,0 AS `iri_masuk_1`,0 AS `iri_masuk_2`,0 AS `iri_masuk_3`,0 AS `iri_keluar_1`,0 AS `iri_keluar_2`,count(`a`.`no_ipd`) AS `iri_keluar_3` from `pasien_iri` `a` where (left(`a`.`idrg`,1) = '3') group by left(`a`.`tgl_keluar`,10) ;

-- ----------------------------
-- View structure for detail_recorddiet
-- ----------------------------
DROP VIEW IF EXISTS `detail_recorddiet`;
CREATE   VIEW `detail_recorddiet` AS select `a`.`idpokdiet` AS `idpokdiet`,`b`.`pokdiet` AS `pokdiet`,`a`.`xcreate` AS `xcreate`,left(`a`.`xcreate`,7) AS `bulan`,`a`.`rawat` AS `rawat`,`a`.`no_medrec` AS `no_medrec`,`c`.`no_cm` AS `no_cm`,`c`.`nama` AS `nama` from ((`record_diet` `a` join `kelompok_diet` `b` on((`a`.`idpokdiet` = `b`.`idpokdiet`))) join `data_pasien` `c` on((`c`.`no_medrec` = `a`.`no_medrec`))) group by left(`a`.`xcreate`,7),`b`.`idpokdiet` ;

-- ----------------------------
-- View structure for diagnosa_iri_v2
-- ----------------------------
DROP VIEW IF EXISTS `diagnosa_iri_v2`;
CREATE   VIEW `diagnosa_iri_v2` AS (select `pasien_iri`.`tgl_masuk` AS `tgl_masuk`,`pasien_iri`.`tgl_keluar` AS `tgl_keluar`,`pasien_iri`.`klsiri` AS `klsiri`,`b`.`lokasi` AS `lokasi`,`pasien_iri`.`diagnosa1` AS `diagnosa1`,`c`.`nm_diagnosa` AS `nm_diagnosa`,`d`.`sex` AS `sex`,if((`pasien_iri`.`status_pulang` = 'PULANG SENDIRI'),1,0) AS `pulang_1`,if(((`pasien_iri`.`status_pulang` = 'MENINGGAL') and (`pasien_iri`.`kondisi_meninggal` = 'LEBIH 48 JAM')),1,0) AS `pulang_2`,if(((`pasien_iri`.`status_pulang` = 'MENINGGAL') and (`pasien_iri`.`kondisi_meninggal` = 'KURANG 48 JAM')),1,0) AS `pulang_3`,if((`d`.`sex` = 'L'),1,0) AS `L`,if((`d`.`sex` = 'P'),1,0) AS `P`,if((timestampdiff(YEAR,`d`.`tgl_lahir`,left(`pasien_iri`.`tgl_masuk`,10)) < 6),1,0) AS `usia1`,if((timestampdiff(YEAR,`d`.`tgl_lahir`,curdate()) between 6 and 11),1,0) AS `usia2`,if((timestampdiff(YEAR,`d`.`tgl_lahir`,curdate()) between 12 and 16),1,0) AS `usia3`,if((timestampdiff(YEAR,`d`.`tgl_lahir`,curdate()) between 17 and 25),1,0) AS `usia4`,if((timestampdiff(YEAR,`d`.`tgl_lahir`,curdate()) between 26 and 35),1,0) AS `usia5`,if((timestampdiff(YEAR,`d`.`tgl_lahir`,curdate()) between 36 and 45),1,0) AS `usia6`,if((timestampdiff(YEAR,`d`.`tgl_lahir`,curdate()) between 46 and 55),1,0) AS `usia7`,if((timestampdiff(YEAR,`d`.`tgl_lahir`,curdate()) between 56 and 65),1,0) AS `usia8`,if((timestampdiff(YEAR,`d`.`tgl_lahir`,curdate()) > 65),1,0) AS `usia9`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301')) and (`d`.`nrp_sbg` = 'T')),1,0) AS `stat1`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` = '351') and (`d`.`nrp_sbg` = 'T')),1,0) AS `stat2`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`d`.`nrp_sbg` <> 'T') and (`d`.`nrp_sbg` <> '') and (`d`.`nrp_sbg` is not null)),1,0) AS `stat3`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('303','304','328'))),1,0) AS `stat4`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` not in ('299','301','351','303','304','328'))),1,0) AS `stat5`,if((`pasien_iri`.`carabayar` <> 'BPJS'),1,0) AS `stat6`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and ((`d`.`nrp_sbg` = '') or isnull(`d`.`nrp_sbg`))),1,0) AS `stat7` from (((`pasien_iri` left join `data_pasien` `d` on((`d`.`no_medrec` = `pasien_iri`.`no_cm`))) left join `ruang` `b` on((`b`.`idrg` = `pasien_iri`.`idrg`))) left join `icd1` `c` on((`c`.`id_icd` = `pasien_iri`.`diagnosa1`))) where ((`pasien_iri`.`diagnosa1` is not null) and (`pasien_iri`.`diagnosa1` <> ''))) ;

-- ----------------------------
-- View structure for diagnosa_irj
-- ----------------------------
DROP VIEW IF EXISTS `diagnosa_irj`;
CREATE   VIEW `diagnosa_irj` AS select `a`.`id_diagnosa` AS `id_diagnosa`,`c`.`tgl_kunjungan` AS `tgl_kunjungan`,`a`.`diagnosa` AS `diagnosa`,`c`.`cara_bayar` AS `cara_bayar`,`b`.`no_cm` AS `no_cm`,`c`.`id_poli` AS `id_poli`,`b`.`sex` AS `sex`,`b`.`nrp_sbg` AS `nrp_sbg`,`c`.`id_kontraktor` AS `id_kontraktor`,if((`c`.`id_kontraktor` is not null),(select `kontraktor`.`nmkontraktor` from `kontraktor` where (`kontraktor`.`id_kontraktor` = `c`.`id_kontraktor`)),NULL) AS `nmkontraktor`,timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) AS `age` from ((`diagnosa_pasien` `a` join `data_pasien` `b`) join `daftar_ulang_irj` `c`) where ((`a`.`klasifikasi_diagnos` = 'utama') and (`a`.`id_diagnosa` <> '') and (`a`.`no_register` = `c`.`no_register`) and (`b`.`no_medrec` = `c`.`no_medrec`)) ;

-- ----------------------------
-- View structure for diagnosa_irj_detail
-- ----------------------------
DROP VIEW IF EXISTS `diagnosa_irj_detail`;
CREATE   VIEW `diagnosa_irj_detail` AS select `diagnosa_irj`.`id_diagnosa` AS `id_diagnosa`,`diagnosa_irj`.`diagnosa` AS `diagnosa`,`diagnosa_irj`.`tgl_kunjungan` AS `tgl_kunjungan`,if((`diagnosa_irj`.`sex` = 'L'),1,0) AS `L`,if((`diagnosa_irj`.`sex` = 'P'),1,0) AS `P`,if((`diagnosa_irj`.`age` < 1),1,0) AS `usia1`,if((`diagnosa_irj`.`age` between 1 and 4),1,0) AS `usia2`,if((`diagnosa_irj`.`age` between 5 and 14),1,0) AS `usia3`,if((`diagnosa_irj`.`age` between 15 and 24),1,0) AS `usia4`,if((`diagnosa_irj`.`age` between 25 and 44),1,0) AS `usia5`,if((`diagnosa_irj`.`age` between 45 and 64),1,0) AS `usia6`,if((`diagnosa_irj`.`age` >= 65),1,0) AS `usia7`,if(((`diagnosa_irj`.`cara_bayar` = 'BPJS') and (`diagnosa_irj`.`id_kontraktor` in ('299','301')) and (`diagnosa_irj`.`nrp_sbg` = 'T')),1,0) AS `stat1`,if(((`diagnosa_irj`.`cara_bayar` = 'BPJS') and (`diagnosa_irj`.`id_kontraktor` = '351') and (`diagnosa_irj`.`nrp_sbg` = 'T')),1,0) AS `stat2`,if(((`diagnosa_irj`.`cara_bayar` = 'BPJS') and (`diagnosa_irj`.`id_kontraktor` in ('299','301','351')) and (`diagnosa_irj`.`nrp_sbg` <> 'T') and (`diagnosa_irj`.`nrp_sbg` <> '') and (`diagnosa_irj`.`nrp_sbg` is not null)),1,0) AS `stat3`,if(((`diagnosa_irj`.`cara_bayar` = 'BPJS') and (`diagnosa_irj`.`id_kontraktor` in ('303','304','328'))),1,0) AS `stat4`,if(((`diagnosa_irj`.`cara_bayar` = 'BPJS') and (`diagnosa_irj`.`id_kontraktor` not in ('299','301','351','303','304','328'))),1,0) AS `stat5`,if((`diagnosa_irj`.`cara_bayar` <> 'BPJS'),1,0) AS `stat6`,if(((`diagnosa_irj`.`cara_bayar` = 'BPJS') and (`diagnosa_irj`.`id_kontraktor` in ('299','301','351')) and ((`diagnosa_irj`.`nrp_sbg` = '') or isnull(`diagnosa_irj`.`nrp_sbg`))),1,0) AS `stat7` from `diagnosa_irj` ;

-- ----------------------------
-- View structure for diagnosa_irj_v2
-- ----------------------------
DROP VIEW IF EXISTS `diagnosa_irj_v2`;
CREATE   VIEW `diagnosa_irj_v2` AS (select `a`.`id_diagnosa` AS `id_diagnosa`,`a`.`diagnosa` AS `diagnosa`,left(`c`.`tgl_kunjungan`,10) AS `tgl`,`c`.`id_poli` AS `id_poli`,if((`b`.`sex` = 'L'),1,0) AS `L`,if((`b`.`sex` = 'P'),1,0) AS `P`,if((`c`.`jns_kunj` = 'BARU'),1,0) AS `baru`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) < 6),1,0) AS `usia1`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 6 and 11),1,0) AS `usia2`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 12 and 16),1,0) AS `usia3`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 17 and 25),1,0) AS `usia4`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 26 and 35),1,0) AS `usia5`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 36 and 45),1,0) AS `usia6`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 46 and 55),1,0) AS `usia7`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 56 and 65),1,0) AS `usia8`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) > 65),1,0) AS `usia9`,if(((`c`.`cara_bayar` = 'BPJS') and (`c`.`id_kontraktor` in ('299','301')) and (`b`.`nrp_sbg` = 'T')),1,0) AS `stat1`,if(((`c`.`cara_bayar` = 'BPJS') and (`c`.`id_kontraktor` = '351') and (`b`.`nrp_sbg` = 'T')),1,0) AS `stat2`,if(((`c`.`cara_bayar` = 'BPJS') and (`c`.`id_kontraktor` in ('299','301','351')) and (`b`.`nrp_sbg` <> 'T') and (`b`.`nrp_sbg` <> '') and (`b`.`nrp_sbg` is not null)),1,0) AS `stat3`,if(((`c`.`cara_bayar` = 'BPJS') and (`c`.`id_kontraktor` in ('303','304','328'))),1,0) AS `stat4`,if(((`c`.`cara_bayar` = 'BPJS') and (`c`.`id_kontraktor` not in ('299','301','351','303','304','328'))),1,0) AS `stat5`,if((`c`.`cara_bayar` <> 'BPJS'),1,0) AS `stat6`,if(((`c`.`cara_bayar` = 'BPJS') and (`c`.`id_kontraktor` in ('299','301','351')) and ((`b`.`nrp_sbg` = '') or isnull(`b`.`nrp_sbg`))),1,0) AS `stat7` from ((`diagnosa_pasien` `a` join `data_pasien` `b`) join `daftar_ulang_irj` `c`) where ((`a`.`klasifikasi_diagnos` = 'utama') and (`a`.`id_diagnosa` <> '') and (`a`.`no_register` = `c`.`no_register`) and (`b`.`no_medrec` = `c`.`no_medrec`))) ;

-- ----------------------------
-- View structure for jenis_tindakan_lab
-- ----------------------------
DROP VIEW IF EXISTS `jenis_tindakan_lab`;
CREATE   VIEW `jenis_tindakan_lab` AS SELECT
	`jenis_tindakan`.`idtindakan` AS `idtindakan`,
	`jenis_tindakan`.`nmtindakan` AS `nmtindakan`,
	`jenis_tindakan`.`idpok1` AS `idpok1`
FROM
	`jenis_tindakan`
WHERE
	(
		`jenis_tindakan`.`idpok1` LIKE 'H%'
	) ;

-- ----------------------------
-- View structure for pemeriksaan_pa
-- ----------------------------
DROP VIEW IF EXISTS `pemeriksaan_pa`;
CREATE   VIEW `pemeriksaan_pa` AS select `daftar_ulang_irj`.`no_register` AS `no_register`,`daftar_ulang_irj`.`no_medrec` AS `no_medrec`,`daftar_ulang_irj`.`tgl_kunjungan` AS `tgl_kunjungan`,`daftar_ulang_irj`.`jadwal_pa` AS `jadwal_pa`,`daftar_ulang_irj`.`kelas_pasien` AS `kelas`,`daftar_ulang_irj`.`pa` AS `pa`,`daftar_ulang_irj`.`waktu_masuk_pa` AS `waktu_masuk_pa`,(select `poliklinik`.`nm_poli` from `poliklinik` where (`poliklinik`.`id_poli` = `daftar_ulang_irj`.`id_poli`)) AS `idrg`,'' AS `bed`,`daftar_ulang_irj`.`cara_bayar` AS `cara_bayar` from `daftar_ulang_irj` where (`daftar_ulang_irj`.`pa` = 1) union select `pasien_iri`.`no_ipd` AS `no_register`,`pasien_iri`.`no_cm` AS `no_medrec`,sysdate() AS `tgl_kunjungan`,sysdate() AS `jadwal_pa`,`pasien_iri`.`klsiri` AS `kelas`,`pasien_iri`.`pa` AS `pa`,'' AS `waktu_masuk_pa`,(select `ruang`.`nmruang` from `ruang` where (`ruang`.`idrg` = `pasien_iri`.`idrg`)) AS `idrg`,right(`pasien_iri`.`bed`,2) AS `bed`,`pasien_iri`.`carabayar` AS `cara_bayar` from `pasien_iri` where (`pasien_iri`.`pa` = 1) union select `pasien_luar`.`no_register` AS `no_register`,`pasien_luar`.`no_cm` AS `no_medrec`,`pasien_luar`.`tgl_kunjungan` AS `tgl_kunjungan`,`pasien_luar`.`tgl_kunjungan` AS `jadwal_lab`,'II' AS `kelas`,`pasien_luar`.`pa` AS `pa`,`pasien_luar`.`tgl_kunjungan` AS `waktu_masuk_pa`,'Pasien Langsung/Luar' AS `idrg`,'Pasien Langsung/Luar' AS `bed`,'UMUM' AS `cara_bayar` from `pasien_luar` where (`pasien_luar`.`pa` = 1) ;

-- ----------------------------
-- View structure for pemeriksaan_rad
-- ----------------------------
DROP VIEW IF EXISTS `pemeriksaan_rad`;
CREATE   VIEW `pemeriksaan_rad` AS select `daftar_ulang_irj`.`no_register` AS `no_register`,`daftar_ulang_irj`.`no_medrec` AS `no_medrec`,`daftar_ulang_irj`.`tgl_kunjungan` AS `tgl_kunjungan`,`daftar_ulang_irj`.`jadwal_rad` AS `jadwal_rad`,`daftar_ulang_irj`.`kelas_pasien` AS `kelas`,`daftar_ulang_irj`.`rad` AS `rad`,(select `poliklinik`.`nm_poli` from `poliklinik` where (`poliklinik`.`id_poli` = `daftar_ulang_irj`.`id_poli`)) AS `idrg`,'' AS `bed`,`daftar_ulang_irj`.`cara_bayar` AS `cara_bayar` from `daftar_ulang_irj` where (`daftar_ulang_irj`.`rad` = 1) union select `pasien_iri`.`no_ipd` AS `no_register`,`pasien_iri`.`no_cm` AS `no_medrec`,sysdate() AS `tgl_kunjungan`,sysdate() AS `jadwal_rad`,`pasien_iri`.`klsiri` AS `kelas`,`pasien_iri`.`lab` AS `lab`,(select `ruang`.`nmruang` from `ruang` where (`ruang`.`idrg` = `pasien_iri`.`idrg`)) AS `idrg`,`pasien_iri`.`bed` AS `bed`,`pasien_iri`.`carabayar` AS `cara_bayar` from `pasien_iri` where (`pasien_iri`.`rad` = 1) ;

-- ----------------------------
-- View structure for pendapatan_farmasi
-- ----------------------------
DROP VIEW IF EXISTS `pendapatan_farmasi`;
CREATE   VIEW `pendapatan_farmasi` AS select `a`.`id_resep_pasien` AS `id_resep_pasien`,`a`.`tgl_kunjungan` AS `tgl_kunjungan`,`a`.`no_resep` AS `no_resep`,`a`.`no_register` AS `no_register`,`a`.`no_medrec` AS `no_medrec`,`a`.`cara_bayar` AS `cara_bayar`,if((left(`a`.`no_register`,2) = 'RJ'),(select `kontraktor`.`nmkontraktor` from `kontraktor` where (`kontraktor`.`id_kontraktor` = `c`.`id_kontraktor`)),(select `kontraktor`.`nmkontraktor` from `kontraktor` where (`kontraktor`.`id_kontraktor` = `d`.`id_kontraktor`))) AS `kontraktor`,`b`.`nm_dokter` AS `dokter`,`a`.`idrg` AS `ruangan`,`a`.`bed` AS `status`,`a`.`nama_obat` AS `obat`,`a`.`biaya_obat` AS `harga`,`a`.`qty` AS `jumlah`,`a`.`vtot` AS `total_obat`,`a`.`tuslah` AS `tuslah`,(`a`.`vtot` + `a`.`tuslah`) AS `sub_total`,`b`.`diskon` AS `diskon`,`a`.`racikan` AS `racikan` from (((`resep_pasien` `a` left join `resep_header` `b` on((`a`.`no_resep` = `b`.`no_resep`))) left join `daftar_ulang_irj` `c` on((`a`.`no_register` = `c`.`no_register`))) left join `pasien_iri` `d` on((`a`.`no_register` = `d`.`no_ipd`))) ;

-- ----------------------------
-- View structure for pendapatan_lab
-- ----------------------------
DROP VIEW IF EXISTS `pendapatan_lab`;
CREATE   VIEW `pendapatan_lab` AS select left(`a`.`tgl_kunjungan`,10) AS `tgl_kunjungan`,`a`.`no_lab` AS `no_lab`,`a`.`no_register` AS `no_register`,`a`.`no_medrec` AS `no_medrec`,`a`.`kelas` AS `kelas`,`a`.`idrg` AS `idrg`,`a`.`bed` AS `bed`,`a`.`cara_bayar` AS `cara_bayar`,if((left(`a`.`no_register`,2) = 'RJ'),(select `kontraktor`.`nmkontraktor` from `kontraktor` where (`kontraktor`.`id_kontraktor` = `b`.`id_kontraktor`)),(select `kontraktor`.`nmkontraktor` from `kontraktor` where (`kontraktor`.`id_kontraktor` = `c`.`id_kontraktor`))) AS `kontraktor`,`a`.`jenis_tindakan` AS `jenis_tindakan`,`a`.`biaya_lab` AS `biaya_lab`,`a`.`qty` AS `qty`,`a`.`vtot` AS `vtot`,`a`.`cetak_kwitansi` AS `status` from ((`pemeriksaan_laboratorium` `a` left join `daftar_ulang_irj` `b` on((`a`.`no_register` = `b`.`no_register`))) left join `pasien_iri` `c` on((`a`.`no_register` = `c`.`no_ipd`))) ;

-- ----------------------------
-- View structure for pendapatan_ok
-- ----------------------------
DROP VIEW IF EXISTS `pendapatan_ok`;
CREATE   VIEW `pendapatan_ok` AS select left(`a`.`tgl_kunjungan`,10) AS `tgl_kunjungan`,`a`.`no_ok` AS `no_ok`,`a`.`no_register` AS `no_register`,`a`.`no_medrec` AS `no_medrec`,`a`.`kelas` AS `kelas`,`a`.`idrg` AS `idrg`,`a`.`bed` AS `bed`,`a`.`cara_bayar` AS `cara_bayar`,if((left(`a`.`no_register`,2) = 'RJ'),(select `kontraktor`.`nmkontraktor` from `kontraktor` where (`kontraktor`.`id_kontraktor` = `b`.`id_kontraktor`)),(select `kontraktor`.`nmkontraktor` from `kontraktor` where (`kontraktor`.`id_kontraktor` = `c`.`id_kontraktor`))) AS `kontraktor`,`a`.`jenis_tindakan` AS `jenis_tindakan`,`a`.`biaya_ok` AS `biaya_ok`,`a`.`qty` AS `qty`,`a`.`vtot` AS `vtot` from ((`pemeriksaan_operasi` `a` left join `daftar_ulang_irj` `b` on((`a`.`no_register` = `b`.`no_register`))) left join `pasien_iri` `c` on((`a`.`no_register` = `c`.`no_ipd`))) ;

-- ----------------------------
-- View structure for pendapatan_pa
-- ----------------------------
DROP VIEW IF EXISTS `pendapatan_pa`;
CREATE   VIEW `pendapatan_pa` AS select left(`a`.`tgl_kunjungan`,10) AS `tgl_kunjungan`,`a`.`no_pa` AS `no_pa`,`a`.`no_register` AS `no_register`,`a`.`no_medrec` AS `no_medrec`,`a`.`kelas` AS `kelas`,`a`.`idrg` AS `idrg`,`a`.`bed` AS `bed`,`a`.`cara_bayar` AS `cara_bayar`,if((left(`a`.`no_register`,2) = 'RJ'),(select `kontraktor`.`nmkontraktor` from `kontraktor` where (`kontraktor`.`id_kontraktor` = `b`.`id_kontraktor`)),(select `kontraktor`.`nmkontraktor` from `kontraktor` where (`kontraktor`.`id_kontraktor` = `c`.`id_kontraktor`))) AS `kontraktor`,`a`.`jenis_tindakan` AS `jenis_tindakan`,`a`.`biaya_pa` AS `biaya_pa`,`a`.`qty` AS `qty`,`a`.`vtot` AS `vtot`,`a`.`cetak_kwitansi` AS `status` from ((`pemeriksaan_patologianatomi` `a` left join `daftar_ulang_irj` `b` on((`a`.`no_register` = `b`.`no_register`))) left join `pasien_iri` `c` on((`a`.`no_register` = `c`.`no_ipd`))) ;

-- ----------------------------
-- View structure for pendapatan_rad
-- ----------------------------
DROP VIEW IF EXISTS `pendapatan_rad`;
CREATE   VIEW `pendapatan_rad` AS select left(`a`.`tgl_kunjungan`,10) AS `tgl_kunjungan`,`a`.`no_rad` AS `no_rad`,`a`.`no_register` AS `no_register`,`a`.`no_medrec` AS `no_medrec`,`a`.`kelas` AS `kelas`,`a`.`idrg` AS `idrg`,`a`.`bed` AS `bed`,`a`.`cara_bayar` AS `cara_bayar`,if((left(`a`.`no_register`,2) = 'RJ'),(select `kontraktor`.`nmkontraktor` from `kontraktor` where (`kontraktor`.`id_kontraktor` = `b`.`id_kontraktor`)),(select `kontraktor`.`nmkontraktor` from `kontraktor` where (`kontraktor`.`id_kontraktor` = `c`.`id_kontraktor`))) AS `kontraktor`,`a`.`jenis_tindakan` AS `jenis_tindakan`,`a`.`biaya_rad` AS `biaya_rad`,`a`.`qty` AS `qty`,`a`.`vtot` AS `vtot`,`a`.`cetak_kwitansi` AS `status` from ((`pemeriksaan_radiologi` `a` left join `daftar_ulang_irj` `b` on((`a`.`no_register` = `b`.`no_register`))) left join `pasien_iri` `c` on((`a`.`no_register` = `c`.`no_ipd`))) ;

-- ----------------------------
-- View structure for procedure_irj
-- ----------------------------
DROP VIEW IF EXISTS `procedure_irj`;
CREATE   VIEW `procedure_irj` AS select `a`.`id_procedure` AS `id_procedure`,`a`.`nm_procedure` AS `nm_procedure`,left(`c`.`tgl_kunjungan`,10) AS `tgl`,`c`.`id_poli` AS `id_poli`,if((`c`.`jns_kunj` = 'BARU'),1,0) AS `baru`,if((`b`.`sex` = 'L'),1,0) AS `L`,if((`b`.`sex` = 'P'),1,0) AS `P`,if((timestampdiff(DAY,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) < 7),1,0) AS `usia06`,if((timestampdiff(DAY,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 7 and 27),1,0) AS `usia728`,if(((timestampdiff(DAY,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) > 27) and (timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) < 1)),1,0) AS `usia1`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 1 and 4),1,0) AS `usia2`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 5 and 14),1,0) AS `usia3`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 15 and 24),1,0) AS `usia4`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 25 and 44),1,0) AS `usia5`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) between 45 and 64),1,0) AS `usia6`,if((timestampdiff(YEAR,`b`.`tgl_lahir`,left(`c`.`tgl_kunjungan`,10)) >= 65),1,0) AS `usia7`,if((`c`.`cara_bayar` = 'UMUM'),1,0) AS `stat1`,if((`c`.`cara_bayar` = 'BPJS'),1,0) AS `stat2`,if((`c`.`cara_bayar` = 'JAMSOSKES'),1,0) AS `stat3`,if((`c`.`cara_bayar` = 'DIJAMIN'),1,0) AS `stat4` from ((`icd9cm_irj` `a` join `data_pasien` `b`) join `daftar_ulang_irj` `c`) where ((`a`.`klasifikasi_procedure` = 'utama') and (`a`.`id_procedure` <> '') and (`a`.`no_register` = `c`.`no_register`) and (`b`.`no_medrec` = `c`.`no_medrec`)) ;

-- ----------------------------
-- View structure for rekap_iri_v2
-- ----------------------------
DROP VIEW IF EXISTS `rekap_iri_v2`;
CREATE   VIEW `rekap_iri_v2` AS (select `pasien_iri`.`no_ipd` AS `no_ipd`,`pasien_iri`.`tgl_masuk` AS `tgl_masuk`,`pasien_iri`.`tgl_keluar` AS `tgl_keluar`,`b`.`lokasi` AS `lokasi`,`pasien_iri`.`status_pulang` AS `status_pulang`,if((`pasien_iri`.`status_pulang` <> 'MENINGGAL'),1,0) AS `pulang_1`,if(((`pasien_iri`.`status_pulang` = 'MENINGGAL') and (`pasien_iri`.`kondisi_meninggal` = 'LEBIH 48 JAM')),1,0) AS `pulang_2`,if(((`pasien_iri`.`status_pulang` = 'MENINGGAL') and (`pasien_iri`.`kondisi_meninggal` = 'KURANG 48 JAM')),1,0) AS `pulang_3`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301')) and (`pasien_iri`.`klsiri` = 'VVIP') and (`a`.`nrp_sbg` = 'T')),1,0) AS `stat1_vvip_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301')) and (`pasien_iri`.`klsiri` = 'VVIP') and (`a`.`nrp_sbg` = 'T')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat1_vvip_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301')) and (`pasien_iri`.`klsiri` = 'VIP') and (`a`.`nrp_sbg` = 'T')),1,0) AS `stat1_vip_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301')) and (`pasien_iri`.`klsiri` = 'VIP') and (`a`.`nrp_sbg` = 'T')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat1_vip_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301')) and (`pasien_iri`.`klsiri` = 'UTAMA') and (`a`.`nrp_sbg` = 'T')),1,0) AS `stat1_utama_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301')) and (`pasien_iri`.`klsiri` = 'UTAMA') and (`a`.`nrp_sbg` = 'T')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat1_utama_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301')) and (`pasien_iri`.`klsiri` = 'I') and (`a`.`nrp_sbg` = 'T')),1,0) AS `stat1_I_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301')) and (`pasien_iri`.`klsiri` = 'I') and (`a`.`nrp_sbg` = 'T')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat1_I_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301')) and (`pasien_iri`.`klsiri` = 'II') and (`a`.`nrp_sbg` = 'T')),1,0) AS `stat1_II_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301')) and (`pasien_iri`.`klsiri` = 'II') and (`a`.`nrp_sbg` = 'T')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat1_II_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301')) and (`pasien_iri`.`klsiri` = 'III') and (`a`.`nrp_sbg` = 'T')),1,0) AS `stat1_III_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301')) and (`pasien_iri`.`klsiri` = 'III') and (`a`.`nrp_sbg` = 'T')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat1_III_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` = '351') and (`pasien_iri`.`klsiri` = 'VVIP') and (`a`.`nrp_sbg` = 'T')),1,0) AS `stat2_vvip_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` = '351') and (`pasien_iri`.`klsiri` = 'VVIP') and (`a`.`nrp_sbg` = 'T')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat2_vvip_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` = '351') and (`pasien_iri`.`klsiri` = 'VIP') and (`a`.`nrp_sbg` = 'T')),1,0) AS `stat2_vip_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` = '351') and (`pasien_iri`.`klsiri` = 'VIP') and (`a`.`nrp_sbg` = 'T')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat2_vip_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` = '351') and (`pasien_iri`.`klsiri` = 'UTAMA') and (`a`.`nrp_sbg` = 'T')),1,0) AS `stat2_utama_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` = '351') and (`pasien_iri`.`klsiri` = 'UTAMA') and (`a`.`nrp_sbg` = 'T')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat2_utama_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` = '351') and (`pasien_iri`.`klsiri` = 'I') and (`a`.`nrp_sbg` = 'T')),1,0) AS `stat2_I_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` = '351') and (`pasien_iri`.`klsiri` = 'I') and (`a`.`nrp_sbg` = 'T')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat2_I_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` = '351') and (`pasien_iri`.`klsiri` = 'II') and (`a`.`nrp_sbg` = 'T')),1,0) AS `stat2_II_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` = '351') and (`pasien_iri`.`klsiri` = 'II') and (`a`.`nrp_sbg` = 'T')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat2_II_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` = '351') and (`pasien_iri`.`klsiri` = 'III') and (`a`.`nrp_sbg` = 'T')),1,0) AS `stat2_III_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` = '351') and (`pasien_iri`.`klsiri` = 'III') and (`a`.`nrp_sbg` = 'T')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat2_III_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'VVIP') and (`a`.`nrp_sbg` <> 'T') and (`a`.`nrp_sbg` <> '') and (`a`.`nrp_sbg` is not null)),1,0) AS `stat3_vvip_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'VVIP') and (`a`.`nrp_sbg` <> 'T') and (`a`.`nrp_sbg` <> '') and (`a`.`nrp_sbg` is not null)),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat3_vvip_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'VIP') and (`a`.`nrp_sbg` <> 'T') and (`a`.`nrp_sbg` <> '') and (`a`.`nrp_sbg` is not null)),1,0) AS `stat3_vip_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'VIP') and (`a`.`nrp_sbg` <> 'T') and (`a`.`nrp_sbg` <> '') and (`a`.`nrp_sbg` is not null)),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat3_vip_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'UTAMA') and (`a`.`nrp_sbg` <> 'T') and (`a`.`nrp_sbg` <> '') and (`a`.`nrp_sbg` is not null)),1,0) AS `stat3_utama_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'UTAMA') and (`a`.`nrp_sbg` <> 'T') and (`a`.`nrp_sbg` <> '') and (`a`.`nrp_sbg` is not null)),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat3_utama_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'I') and (`a`.`nrp_sbg` <> 'T') and (`a`.`nrp_sbg` <> '') and (`a`.`nrp_sbg` is not null)),1,0) AS `stat3_I_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'I') and (`a`.`nrp_sbg` <> 'T') and (`a`.`nrp_sbg` <> '') and (`a`.`nrp_sbg` is not null)),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat3_I_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'II') and (`a`.`nrp_sbg` <> 'T') and (`a`.`nrp_sbg` <> '') and (`a`.`nrp_sbg` is not null)),1,0) AS `stat3_II_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'II') and (`a`.`nrp_sbg` <> 'T') and (`a`.`nrp_sbg` <> '') and (`a`.`nrp_sbg` is not null)),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat3_II_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'III') and (`a`.`nrp_sbg` <> 'T') and (`a`.`nrp_sbg` <> '') and (`a`.`nrp_sbg` is not null)),1,0) AS `stat3_III_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'III') and (`a`.`nrp_sbg` <> 'T') and (`a`.`nrp_sbg` <> '') and (`a`.`nrp_sbg` is not null)),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat3_III_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('303','304','328')) and (`pasien_iri`.`klsiri` = 'VVIP')),1,0) AS `stat4_vvip_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('303','304','328')) and (`pasien_iri`.`klsiri` = 'VVIP')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat4_vvip_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('303','304','328')) and (`pasien_iri`.`klsiri` = 'VIP')),1,0) AS `stat4_vip_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('303','304','328')) and (`pasien_iri`.`klsiri` = 'VIP')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat4_vip_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('303','304','328')) and (`pasien_iri`.`klsiri` = 'UTAMA')),1,0) AS `stat4_utama_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('303','304','328')) and (`pasien_iri`.`klsiri` = 'UTAMA')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat4_utama_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('303','304','328')) and (`pasien_iri`.`klsiri` = 'I')),1,0) AS `stat4_I_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('303','304','328')) and (`pasien_iri`.`klsiri` = 'I')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat4_I_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('303','304','328')) and (`pasien_iri`.`klsiri` = 'II')),1,0) AS `stat4_II_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('303','304','328')) and (`pasien_iri`.`klsiri` = 'II')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat4_II_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('303','304','328')) and (`pasien_iri`.`klsiri` = 'III')),1,0) AS `stat4_III_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('303','304','328')) and (`pasien_iri`.`klsiri` = 'III')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat4_III_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` not in ('299','301','351','303','304','328')) and (`pasien_iri`.`klsiri` = 'VVIP')),1,0) AS `stat5_vvip_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` not in ('299','301','351','303','304','328')) and (`pasien_iri`.`klsiri` = 'VVIP')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat5_vvip_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` not in ('299','301','351','303','304','328')) and (`pasien_iri`.`klsiri` = 'VIP')),1,0) AS `stat5_vip_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` not in ('299','301','351','303','304','328')) and (`pasien_iri`.`klsiri` = 'VIP')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat5_vip_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` not in ('299','301','351','303','304','328')) and (`pasien_iri`.`klsiri` = 'UTAMA')),1,0) AS `stat5_utama_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` not in ('299','301','351','303','304','328')) and (`pasien_iri`.`klsiri` = 'UTAMA')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat5_utama_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` not in ('299','301','351','303','304','328')) and (`pasien_iri`.`klsiri` = 'I')),1,0) AS `stat5_I_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` not in ('299','301','351','303','304','328')) and (`pasien_iri`.`klsiri` = 'I')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat5_I_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` not in ('299','301','351','303','304','328')) and (`pasien_iri`.`klsiri` = 'II')),1,0) AS `stat5_II_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` not in ('299','301','351','303','304','328')) and (`pasien_iri`.`klsiri` = 'II')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat5_II_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` not in ('299','301','351','303','304','328')) and (`pasien_iri`.`klsiri` = 'III')),1,0) AS `stat5_III_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` not in ('299','301','351','303','304','328')) and (`pasien_iri`.`klsiri` = 'III')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat5_III_hr`,if(((`pasien_iri`.`carabayar` <> 'BPJS') and (`pasien_iri`.`klsiri` = 'VVIP')),1,0) AS `stat6_vvip_ps`,if(((`pasien_iri`.`carabayar` <> 'BPJS') and (`pasien_iri`.`klsiri` = 'VVIP')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat6_vvip_hr`,if(((`pasien_iri`.`carabayar` <> 'BPJS') and (`pasien_iri`.`klsiri` = 'VIP')),1,0) AS `stat6_vip_ps`,if(((`pasien_iri`.`carabayar` <> 'BPJS') and (`pasien_iri`.`klsiri` = 'VIP')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat6_vip_hr`,if(((`pasien_iri`.`carabayar` <> 'BPJS') and (`pasien_iri`.`klsiri` = 'UTAMA')),1,0) AS `stat6_utama_ps`,if(((`pasien_iri`.`carabayar` <> 'BPJS') and (`pasien_iri`.`klsiri` = 'UTAMA')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat6_utama_hr`,if(((`pasien_iri`.`carabayar` <> 'BPJS') and (`pasien_iri`.`klsiri` = 'I')),1,0) AS `stat6_I_ps`,if(((`pasien_iri`.`carabayar` <> 'BPJS') and (`pasien_iri`.`klsiri` = 'I')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat6_I_hr`,if(((`pasien_iri`.`carabayar` <> 'BPJS') and (`pasien_iri`.`klsiri` = 'II')),1,0) AS `stat6_II_ps`,if(((`pasien_iri`.`carabayar` <> 'BPJS') and (`pasien_iri`.`klsiri` = 'II')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat6_II_hr`,if(((`pasien_iri`.`carabayar` <> 'BPJS') and (`pasien_iri`.`klsiri` = 'III')),1,0) AS `stat6_III_ps`,if(((`pasien_iri`.`carabayar` <> 'BPJS') and (`pasien_iri`.`klsiri` = 'III')),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat6_III_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'VVIP') and ((`a`.`nrp_sbg` = '') or isnull(`a`.`nrp_sbg`))),1,0) AS `stat7_vvip_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'VVIP') and ((`a`.`nrp_sbg` = '') or isnull(`a`.`nrp_sbg`))),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat7_vvip_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'VIP') and ((`a`.`nrp_sbg` = '') or isnull(`a`.`nrp_sbg`))),1,0) AS `stat7_vip_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'VIP') and ((`a`.`nrp_sbg` = '') or isnull(`a`.`nrp_sbg`))),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat7_vip_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'UTAMA') and ((`a`.`nrp_sbg` = '') or isnull(`a`.`nrp_sbg`))),1,0) AS `stat7_utama_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'UTAMA') and ((`a`.`nrp_sbg` = '') or isnull(`a`.`nrp_sbg`))),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat7_utama_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'I') and ((`a`.`nrp_sbg` = '') or isnull(`a`.`nrp_sbg`))),1,0) AS `stat7_I_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'I') and ((`a`.`nrp_sbg` = '') or isnull(`a`.`nrp_sbg`))),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat7_I_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'II') and ((`a`.`nrp_sbg` = '') or isnull(`a`.`nrp_sbg`))),1,0) AS `stat7_II_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'II') and ((`a`.`nrp_sbg` = '') or isnull(`a`.`nrp_sbg`))),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat7_II_hr`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'III') and ((`a`.`nrp_sbg` = '') or isnull(`a`.`nrp_sbg`))),1,0) AS `stat7_III_ps`,if(((`pasien_iri`.`carabayar` = 'BPJS') and (`pasien_iri`.`id_kontraktor` in ('299','301','351')) and (`pasien_iri`.`klsiri` = 'III') and ((`a`.`nrp_sbg` = '') or isnull(`a`.`nrp_sbg`))),(to_days(`pasien_iri`.`tgl_keluar`) - to_days(`pasien_iri`.`tgl_masuk`)),0) AS `stat7_III_hr` from ((`pasien_iri` left join `data_pasien` `a` on((`a`.`no_medrec` = `pasien_iri`.`no_cm`))) left join `ruang` `b` on((`b`.`idrg` = `pasien_iri`.`idrg`))) where (`pasien_iri`.`tgl_keluar` is not null)) ;

-- ----------------------------
-- View structure for ruang_kelas
-- ----------------------------
DROP VIEW IF EXISTS `ruang_kelas`;
CREATE   VIEW `ruang_kelas` AS select `a`.`lokasi` AS `lokasi`,`b`.`kelas` AS `kelas` from (`ruang` `a` join `bed` `b` on((`a`.`idrg` = `b`.`idrg`))) where (`a`.`aktif` = 'Active') group by `a`.`lokasi`,`b`.`kelas` ;

-- ----------------------------
-- View structure for sensus_iri_dalam_perawatan
-- ----------------------------
DROP VIEW IF EXISTS `sensus_iri_dalam_perawatan`;
CREATE   VIEW `sensus_iri_dalam_perawatan` AS select `a`.`idrgiri` AS `idrgiri`,`a`.`no_ipd` AS `no_ipd`,`a`.`idrg` AS `idrg`,`a`.`bed` AS `bed`,`e`.`nmruang` AS `ruang`,`e`.`lokasi` AS `lokasi`,`a`.`kelas` AS `kelas`,`b`.`nama` AS `nama`,`c`.`no_cm` AS `no_cm`,`c`.`sex` AS `sex`,timestampdiff(YEAR,`c`.`tgl_lahir`,left(`a`.`tglmasukrg`,10)) AS `umur`,`b`.`diagnosa1` AS `id_diagnosa`,`d`.`nm_diagnosa` AS `nm_diagnosa`,`b`.`carabayar` AS `cara_bayar`,`b`.`id_kontraktor` AS `id_kontraktor`,`c`.`nrp_sbg` AS `nrp_sbg`,`b`.`keadaanpulang` AS `keadaanpulang`,`b`.`tgl_masuk` AS `tgl_masuk`,ifnull(`a`.`tglkeluarrg`,left((now() + interval 1 day),10)) AS `tgl_keluar` from ((((`ruang_iri` `a` left join `pasien_iri` `b` on((`b`.`no_ipd` = `a`.`no_ipd`))) left join `data_pasien` `c` on((`c`.`no_medrec` = `b`.`no_cm`))) left join `icd1` `d` on((`d`.`id_icd` = `b`.`diagnosa1`))) left join `ruang` `e` on((`e`.`idrg` = `a`.`idrg`))) ;

-- ----------------------------
-- View structure for sensus_iri_keluar_hidup
-- ----------------------------
DROP VIEW IF EXISTS `sensus_iri_keluar_hidup`;
CREATE   VIEW `sensus_iri_keluar_hidup` AS select `a`.`idrgiri` AS `idrgiri`,`a`.`no_ipd` AS `no_ipd`,`a`.`idrg` AS `idrg`,`e`.`nmruang` AS `ruang`,`e`.`lokasi` AS `lokasi`,`a`.`kelas` AS `kelas`,`a`.`tglkeluarrg` AS `tgl`,`a`.`statkeluarrg` AS `ket`,`b`.`nama` AS `nama`,`c`.`no_cm` AS `no_cm`,`c`.`sex` AS `sex`,timestampdiff(YEAR,`c`.`tgl_lahir`,left(`a`.`tglmasukrg`,10)) AS `umur`,`b`.`diagnosa1` AS `id_diagnosa`,`d`.`nm_diagnosa` AS `nm_diagnosa`,`b`.`carabayar` AS `cara_bayar`,`b`.`id_kontraktor` AS `id_kontraktor`,`c`.`nrp_sbg` AS `nrp_sbg`,`b`.`keadaanpulang` AS `keadaanpulang`,`b`.`tgl_masuk` AS `tgl_masuk`,`b`.`tgl_keluar` AS `tgl_keluar`,((to_days(`b`.`tgl_keluar`) - to_days(`b`.`tgl_masuk`)) + 1) AS `hp` from ((((`ruang_iri` `a` left join `pasien_iri` `b` on((`b`.`no_ipd` = `a`.`no_ipd`))) left join `data_pasien` `c` on((`c`.`no_medrec` = `b`.`no_cm`))) left join `icd1` `d` on((`d`.`id_icd` = `b`.`diagnosa1`))) left join `ruang` `e` on((`e`.`idrg` = `a`.`idrg`))) where ((`a`.`statkeluarrg` = 'keluar') and ((`b`.`keadaanpulang` <> 'MENINGGAL') or (`b`.`keadaanpulang` <> 'DIRUJUK RS LAIN'))) ;

-- ----------------------------
-- View structure for sensus_iri_keluar_meninggal
-- ----------------------------
DROP VIEW IF EXISTS `sensus_iri_keluar_meninggal`;
CREATE   VIEW `sensus_iri_keluar_meninggal` AS select `a`.`idrgiri` AS `idrgiri`,`a`.`no_ipd` AS `no_ipd`,`a`.`idrg` AS `idrg`,`e`.`nmruang` AS `ruang`,`e`.`lokasi` AS `lokasi`,`a`.`kelas` AS `kelas`,`a`.`tglkeluarrg` AS `tgl`,`a`.`statkeluarrg` AS `ket`,`b`.`nama` AS `nama`,`c`.`no_cm` AS `no_cm`,`c`.`sex` AS `sex`,timestampdiff(YEAR,`c`.`tgl_lahir`,left(`a`.`tglmasukrg`,10)) AS `umur`,`b`.`diagnosa1` AS `id_diagnosa`,`d`.`nm_diagnosa` AS `nm_diagnosa`,`b`.`carabayar` AS `cara_bayar`,`b`.`id_kontraktor` AS `id_kontraktor`,`c`.`nrp_sbg` AS `nrp_sbg`,`b`.`keadaanpulang` AS `keadaanpulang`,`b`.`tgl_masuk` AS `tgl_masuk`,`b`.`tgl_keluar` AS `tgl_keluar`,((to_days(`b`.`tgl_keluar`) - to_days(`b`.`tgl_masuk`)) + 1) AS `hp` from ((((`ruang_iri` `a` left join `pasien_iri` `b` on((`b`.`no_ipd` = `a`.`no_ipd`))) left join `data_pasien` `c` on((`c`.`no_medrec` = `b`.`no_cm`))) left join `icd1` `d` on((`d`.`id_icd` = `b`.`diagnosa1`))) left join `ruang` `e` on((`e`.`idrg` = `a`.`idrg`))) where ((`a`.`statkeluarrg` = 'keluar') and (`b`.`keadaanpulang` = 'MENINGGAL')) ;

-- ----------------------------
-- View structure for sensus_iri_masuk
-- ----------------------------
DROP VIEW IF EXISTS `sensus_iri_masuk`;
CREATE   VIEW `sensus_iri_masuk` AS select `a`.`idrgiri` AS `idrgiri`,`a`.`no_ipd` AS `no_ipd`,`a`.`idrg` AS `idrg`,`e`.`nmruang` AS `ruang`,`e`.`lokasi` AS `lokasi`,`a`.`kelas` AS `kelas`,`a`.`tglmasukrg` AS `tgl`,`a`.`statmasukrg` AS `ket`,`b`.`nama` AS `nama`,`c`.`no_cm` AS `no_cm`,`c`.`sex` AS `sex`,timestampdiff(YEAR,`c`.`tgl_lahir`,left(`a`.`tglmasukrg`,10)) AS `umur`,`b`.`diagmasuk` AS `id_diagnosa`,`d`.`nm_diagnosa` AS `nm_diagnosa`,`b`.`carabayar` AS `cara_bayar`,`b`.`id_kontraktor` AS `id_kontraktor`,`c`.`nrp_sbg` AS `nrp_sbg` from ((((`ruang_iri` `a` left join `pasien_iri` `b` on((`b`.`no_ipd` = `a`.`no_ipd`))) left join `data_pasien` `c` on((`c`.`no_medrec` = `b`.`no_cm`))) left join `icd1` `d` on((`d`.`id_icd` = `b`.`diagmasuk`))) left join `ruang` `e` on((`e`.`idrg` = `a`.`idrg`))) where (`a`.`statmasukrg` = 'masuk') ;

-- ----------------------------
-- View structure for sensus_iri_pindah_dari
-- ----------------------------
DROP VIEW IF EXISTS `sensus_iri_pindah_dari`;
CREATE   VIEW `sensus_iri_pindah_dari` AS select `a`.`idrgiri` AS `idrgiri`,`a`.`no_ipd` AS `no_ipd`,`a`.`idrg` AS `idrg`,`e`.`nmruang` AS `ruang`,`e`.`lokasi` AS `lokasi`,`a`.`kelas` AS `kelas`,`a`.`tglmasukrg` AS `tgl`,`a`.`statmasukrg` AS `ket`,`f`.`nmruang` AS `ruang_dari`,`f`.`lokasi` AS `lokasi_dari`,`b`.`nama` AS `nama`,`c`.`no_cm` AS `no_cm`,`c`.`sex` AS `sex`,timestampdiff(YEAR,`c`.`tgl_lahir`,left(`a`.`tglmasukrg`,10)) AS `umur`,`b`.`diagmasuk` AS `id_diagnosa`,`d`.`nm_diagnosa` AS `nm_diagnosa`,`b`.`carabayar` AS `cara_bayar`,`b`.`id_kontraktor` AS `id_kontraktor`,`c`.`nrp_sbg` AS `nrp_sbg` from (((((`ruang_iri` `a` left join `pasien_iri` `b` on((`b`.`no_ipd` = `a`.`no_ipd`))) left join `data_pasien` `c` on((`c`.`no_medrec` = `b`.`no_cm`))) left join `icd1` `d` on((`d`.`id_icd` = `b`.`diagmasuk`))) left join `ruang` `e` on((`e`.`idrg` = `a`.`idrg`))) left join `ruang` `f` on((`f`.`idrg` = `a`.`statmasukrg`))) where (`a`.`statmasukrg` <> 'masuk') ;

-- ----------------------------
-- View structure for sensus_iri_pindah_ke
-- ----------------------------
DROP VIEW IF EXISTS `sensus_iri_pindah_ke`;
CREATE   VIEW `sensus_iri_pindah_ke` AS select `a`.`idrgiri` AS `idrgiri`,`a`.`no_ipd` AS `no_ipd`,`a`.`idrg` AS `idrg`,`e`.`nmruang` AS `ruang`,`e`.`lokasi` AS `lokasi`,`a`.`kelas` AS `kelas`,`a`.`tglkeluarrg` AS `tgl`,`a`.`statkeluarrg` AS `ket`,`f`.`nmruang` AS `ruang_ke`,`f`.`lokasi` AS `lokasi_ke`,`b`.`nama` AS `nama`,`c`.`no_cm` AS `no_cm`,`c`.`sex` AS `sex`,timestampdiff(YEAR,`c`.`tgl_lahir`,left(`a`.`tglkeluarrg`,10)) AS `umur`,`b`.`diagmasuk` AS `id_diagnosa`,`d`.`nm_diagnosa` AS `nm_diagnosa`,`b`.`carabayar` AS `cara_bayar`,`b`.`id_kontraktor` AS `id_kontraktor`,`c`.`nrp_sbg` AS `nrp_sbg` from (((((`ruang_iri` `a` left join `pasien_iri` `b` on((`b`.`no_ipd` = `a`.`no_ipd`))) left join `data_pasien` `c` on((`c`.`no_medrec` = `b`.`no_cm`))) left join `icd1` `d` on((`d`.`id_icd` = `b`.`diagmasuk`))) left join `ruang` `e` on((`e`.`idrg` = `a`.`idrg`))) left join `ruang` `f` on((`f`.`idrg` = `a`.`statkeluarrg`))) where (`a`.`statkeluarrg` <> 'keluar') ;

-- ----------------------------
-- View structure for sensus_iri_rujuk_rs_lain
-- ----------------------------
DROP VIEW IF EXISTS `sensus_iri_rujuk_rs_lain`;
CREATE   VIEW `sensus_iri_rujuk_rs_lain` AS select `a`.`idrgiri` AS `idrgiri`,`a`.`no_ipd` AS `no_ipd`,`a`.`idrg` AS `idrg`,`e`.`nmruang` AS `ruang`,`e`.`lokasi` AS `lokasi`,`a`.`kelas` AS `kelas`,`a`.`tglkeluarrg` AS `tgl`,`a`.`statkeluarrg` AS `ket`,`b`.`nama` AS `nama`,`c`.`no_cm` AS `no_cm`,`c`.`sex` AS `sex`,timestampdiff(YEAR,`c`.`tgl_lahir`,left(`a`.`tglmasukrg`,10)) AS `umur`,`b`.`diagnosa1` AS `id_diagnosa`,`d`.`nm_diagnosa` AS `nm_diagnosa`,`b`.`carabayar` AS `cara_bayar`,`b`.`id_kontraktor` AS `id_kontraktor`,`c`.`nrp_sbg` AS `nrp_sbg`,`b`.`keadaanpulang` AS `keadaanpulang`,`b`.`tgl_masuk` AS `tgl_masuk`,`b`.`tgl_keluar` AS `tgl_keluar`,((to_days(`b`.`tgl_keluar`) - to_days(`b`.`tgl_masuk`)) + 1) AS `hp` from ((((`ruang_iri` `a` left join `pasien_iri` `b` on((`b`.`no_ipd` = `a`.`no_ipd`))) left join `data_pasien` `c` on((`c`.`no_medrec` = `b`.`no_cm`))) left join `icd1` `d` on((`d`.`id_icd` = `b`.`diagnosa1`))) left join `ruang` `e` on((`e`.`idrg` = `a`.`idrg`))) where ((`a`.`statkeluarrg` = 'keluar') and (`b`.`keadaanpulang` = 'DIRUJUK RS LAIN')) ;

-- ----------------------------
-- View structure for tindakan_all
-- ----------------------------
DROP VIEW IF EXISTS `tindakan_all`;
CREATE   VIEW `tindakan_all` AS select left(`pp`.`tgl_kunjungan`,10) AS `tgl`,`p`.`nama` AS `nama`,lpad(`p`.`no_medrec`,10,'0') AS `no_medrec`,`p`.`no_cm` AS `no_cm`,`pp`.`idtindakan` AS `idtindakan`,`pp`.`nmtindakan` AS `nmtindakan`,`pp`.`id_dokter` AS `id_dokter`,`pp`.`nm_dokter` AS `nm_dokter`,`pp`.`id_poli` AS `idrg`,`pp`.`vtot` AS `vtot`,'IRJ' AS `instalasi`,`du`.`cara_bayar` AS `cara_bayar` from ((`pelayanan_poli` `pp` left join `daftar_ulang_irj` `du` on((`du`.`no_register` = `pp`.`no_register`))) left join `data_pasien` `p` on((`p`.`no_medrec` = `du`.`no_medrec`))) where (substr(`pp`.`idtindakan`,1,2) <> 'BA') union all select left(`ti`.`tgl_kunjungan`,10) AS `tgl`,`p`.`nama` AS `nama`,lpad(`p`.`no_medrec`,10,'0') AS `no_medrec`,`p`.`no_cm` AS `no_cm`,`ti`.`idtindakan` AS `idtindakan`,`jt`.`nmtindakan` AS `nmtindakan`,`ti`.`id_dokter` AS `id_dokter`,`dd`.`nm_dokter` AS `nm_dokter`,'-' AS `idrg`,`ti`.`vtot` AS `vtot`,'IRD' AS `instalasi`,`id`.`cara_bayar` AS `cara_bayar` from ((((`tindakan_ird` `ti` left join `irddaftar_ulang` `id` on((`id`.`no_register` = `ti`.`no_register`))) left join `data_pasien` `p` on((`p`.`no_medrec` = `id`.`no_medrec`))) left join `data_dokter` `dd` on((`dd`.`id_dokter` = `ti`.`id_dokter`))) left join `jenis_tindakan` `jt` on((`jt`.`idtindakan` = `ti`.`idtindakan`))) where (substr(`ti`.`idtindakan`,1,2) <> 'BA') union all select left(`pi`.`tgl_layanan`,10) AS `tgl`,`p`.`nama` AS `nama`,lpad(`p`.`no_medrec`,10,'0') AS `no_medrec`,`p`.`no_cm` AS `no_cm`,`pi`.`id_tindakan` AS `id_tindakan`,`jt`.`nmtindakan` AS `nmtindakan`,`pi`.`idoprtr` AS `id_dokter`,`dd`.`nm_dokter` AS `nm_dokter`,`pi`.`idrg` AS `idrg`,`pi`.`vtot` AS `vtot`,'IRI' AS `instalasi`,`piri`.`carabayar` AS `carabayar` from ((((`pelayanan_iri` `pi` left join `data_pasien` `p` on((`p`.`no_medrec` = `pi`.`nomederec`))) left join `data_dokter` `dd` on((`dd`.`id_dokter` = `pi`.`idoprtr`))) left join `jenis_tindakan` `jt` on((`jt`.`idtindakan` = `pi`.`id_tindakan`))) left join `pasien_iri` `piri` on((`piri`.`no_ipd` = `pi`.`no_ipd`))) where (substr(`pi`.`id_tindakan`,1,2) <> 'BA') ;

-- ----------------------------
-- View structure for tindakan_lab
-- ----------------------------
DROP VIEW IF EXISTS `tindakan_lab`;
CREATE   VIEW `tindakan_lab` AS select `jenis_tindakan`.`idtindakan` AS `idtindakan`,`jenis_tindakan`.`nmtindakan` AS `nmtindakan`,`jenis_tindakan`.`cito` AS `cito`,`jenis_tindakan`.`idpok1` AS `idpok1`,`jenis_tindakan`.`idpok2` AS `idpok2`,`jenis_tindakan`.`id` AS `id`,`jenis_tindakan`.`idpatria` AS `idpatria`,`jenis_tindakan`.`paket` AS `paket`,`jenis_tindakan`.`idkel_tind` AS `idkel_tind` from `jenis_tindakan` where (`jenis_tindakan`.`idtindakan` like 'H%') ;

-- ----------------------------
-- View structure for urikes_laporan
-- ----------------------------
DROP VIEW IF EXISTS `urikes_laporan`;
CREATE   VIEW `urikes_laporan` AS select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'PATI' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`tingkatan` = 'PATI')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'PATI' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`tingkatan` = 'PATI')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'PATI' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`tingkatan` = 'PATI')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'PATI' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`tingkatan` = 'PATI')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'PATI' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`tingkatan` = 'PATI')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'PATI' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`tingkatan` = 'PATI')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KOLONEL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`pangkat` = 'KOLONEL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KOLONEL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`pangkat` = 'KOLONEL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KOLONEL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`pangkat` = 'KOLONEL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KOLONEL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`pangkat` = 'KOLONEL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KOLONEL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`pangkat` = 'KOLONEL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KOLONEL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`pangkat` = 'KOLONEL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETKOL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`pangkat` = 'LETKOL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETKOL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`pangkat` = 'LETKOL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETKOL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`pangkat` = 'LETKOL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETKOL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`pangkat` = 'LETKOL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETKOL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`pangkat` = 'LETKOL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETKOL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`pangkat` = 'LETKOL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'MAYOR' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`pangkat` = 'MAYOR')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'MAYOR' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`pangkat` = 'MAYOR')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'MAYOR' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`pangkat` = 'MAYOR')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'MAYOR' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`pangkat` = 'MAYOR')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'MAYOR' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`pangkat` = 'MAYOR')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'MAYOR' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`pangkat` = 'MAYOR')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KAPTEN' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`pangkat` = 'KAPTEN')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KAPTEN' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`pangkat` = 'KAPTEN')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KAPTEN' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`pangkat` = 'KAPTEN')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KAPTEN' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`pangkat` = 'KAPTEN')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KAPTEN' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`pangkat` = 'KAPTEN')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KAPTEN' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`pangkat` = 'KAPTEN')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KOLONEL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`pangkat` = 'KOLONEL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KOLONEL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`pangkat` = 'KOLONEL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KOLONEL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`pangkat` = 'KOLONEL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KOLONEL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`pangkat` = 'KOLONEL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KOLONEL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`pangkat` = 'KOLONEL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KOLONEL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`pangkat` = 'KOLONEL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETKOL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`pangkat` = 'LETKOL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETKOL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`pangkat` = 'LETKOL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETKOL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`pangkat` = 'LETKOL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETKOL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`pangkat` = 'LETKOL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETKOL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`pangkat` = 'LETKOL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETKOL' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`pangkat` = 'LETKOL')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'MAYOR' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`pangkat` = 'MAYOR')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'MAYOR' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`pangkat` = 'MAYOR')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'MAYOR' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`pangkat` = 'MAYOR')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'MAYOR' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`pangkat` = 'MAYOR')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'MAYOR' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`pangkat` = 'MAYOR')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'MAYOR' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`pangkat` = 'MAYOR')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KAPTEN' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`pangkat` = 'KAPTEN')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KAPTEN' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`pangkat` = 'KAPTEN')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KAPTEN' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`pangkat` = 'KAPTEN')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KAPTEN' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`pangkat` = 'KAPTEN')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KAPTEN' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`pangkat` = 'KAPTEN')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'KAPTEN' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`pangkat` = 'KAPTEN')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETTU' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`pangkat` = 'LETTU')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETTU' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`pangkat` = 'LETTU')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETTU' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`pangkat` = 'LETTU')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETTU' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`pangkat` = 'LETTU')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETTU' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`pangkat` = 'LETTU')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETTU' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`pangkat` = 'LETTU')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETDA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`pangkat` = 'LETDA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETDA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`pangkat` = 'LETDA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETDA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`pangkat` = 'LETDA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETDA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`pangkat` = 'LETDA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETDA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`pangkat` = 'LETDA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'LETDA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`pangkat` = 'LETDA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'BINTARA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`tingkatan` = 'BINTARA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'BINTARA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`tingkatan` = 'BINTARA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'BINTARA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`tingkatan` = 'BINTARA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'BINTARA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`tingkatan` = 'BINTARA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'BINTARA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`tingkatan` = 'BINTARA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'BINTARA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`tingkatan` = 'BINTARA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'TAMTAMA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`tingkatan` = 'TAMTAMA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'TAMTAMA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`tingkatan` = 'TAMTAMA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'TAMTAMA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`tingkatan` = 'TAMTAMA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'TAMTAMA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`tingkatan` = 'TAMTAMA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'TAMTAMA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`tingkatan` = 'TAMTAMA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'TAMTAMA' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`tingkatan` = 'TAMTAMA')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/D' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`tingkatan` = 'GOL IV/D')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/D' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`tingkatan` = 'GOL IV/D')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/D' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`tingkatan` = 'GOL IV/D')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/D' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`tingkatan` = 'GOL IV/D')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/D' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`tingkatan` = 'GOL IV/D')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/D' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`tingkatan` = 'GOL IV/D')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/C' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`tingkatan` = 'GOL IV/C')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/C' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`tingkatan` = 'GOL IV/C')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/C' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`tingkatan` = 'GOL IV/C')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/C' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`tingkatan` = 'GOL IV/C')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/C' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`tingkatan` = 'GOL IV/C')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/C' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`tingkatan` = 'GOL IV/C')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/B' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`tingkatan` = 'GOL IV/B')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/B' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`tingkatan` = 'GOL IV/B')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/B' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`tingkatan` = 'GOL IV/B')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/B' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`tingkatan` = 'GOL IV/B')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/B' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`tingkatan` = 'GOL IV/B')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/B' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`tingkatan` = 'GOL IV/B')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/A' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`tingkatan` = 'GOL IV/A')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/A' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`tingkatan` = 'GOL IV/A')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/A' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`tingkatan` = 'GOL IV/A')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/A' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`tingkatan` = 'GOL IV/A')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/A' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`tingkatan` = 'GOL IV/A')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL IV/A' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`tingkatan` = 'GOL IV/A')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL III' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`tingkatan` = 'GOL III')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL III' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`tingkatan` = 'GOL III')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL III' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`tingkatan` = 'GOL III')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL III' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`tingkatan` = 'GOL III')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL III' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`tingkatan` = 'GOL III')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL III' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`tingkatan` = 'GOL III')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL II' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`tingkatan` = 'GOL II')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL II' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`tingkatan` = 'GOL II')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL II' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`tingkatan` = 'GOL II')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL II' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`tingkatan` = 'GOL II')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL II' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`tingkatan` = 'GOL II')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL II' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`tingkatan` = 'GOL II')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'I' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL I' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'I') and (`tni_pangkat`.`tingkatan` = 'GOL I')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL I' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'II') and (`tni_pangkat`.`tingkatan` = 'GOL I')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'II P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL I' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'II P') and (`tni_pangkat`.`tingkatan` = 'GOL I')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL I' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'III ') and (`tni_pangkat`.`tingkatan` = 'GOL I')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'III P' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL I' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(2)) = 'III P') and (`tni_pangkat`.`tingkatan` = 'GOL I')) union select `urikkes_pasien`.`tgl_pemeriksaan` AS `tgl_pemeriksaan`,'IV' AS `klasifikasi`,if((count(0) = 0),'-',count(0)) AS `total`,'GOL I' AS `pangkat` from (`urikkes_pasien` join `tni_pangkat` on((`urikkes_pasien`.`kdpangkat` = `tni_pangkat`.`pangkat_id`))) where ((substring_index(`urikkes_pasien`.`golongan`,' ',-(1)) = 'IV') and (`tni_pangkat`.`tingkatan` = 'GOL I')) group by `urikkes_pasien`.`tgl_pemeriksaan` ;

-- ----------------------------
-- View structure for v_nip_pns
-- ----------------------------
DROP VIEW IF EXISTS `v_nip_pns`;
CREATE   VIEW `v_nip_pns` AS select `xocp_persons_extended`.`person_id` AS `person_id`,upper(`xocp_persons_extended`.`nip`) AS `no_nrp` from `xocp_persons_extended` where ((not((upper(`xocp_persons_extended`.`nip`) like '%/P'))) and (not((`xocp_persons_extended`.`nip` like '% %'))) and (`xocp_persons_extended`.`nip` is not null) and (length(`xocp_persons_extended`.`nip`) > 12)) ;

-- ----------------------------
-- View structure for v_nrp_bintamtama
-- ----------------------------
DROP VIEW IF EXISTS `v_nrp_bintamtama`;
CREATE   VIEW `v_nrp_bintamtama` AS select `xocp_ehr_patient_extend`.`patient_id` AS `patient_id`,`xocp_ehr_patient_extend`.`person_id` AS `person_id`,`xocp_ehr_patient_extend`.`nip` AS `nip` from `xocp_ehr_patient_extend` where ((`xocp_ehr_patient_extend`.`nip` is not null) and (not((`xocp_ehr_patient_extend`.`nip` like '%/P%'))) and (not((`xocp_ehr_patient_extend`.`nip` like '% %'))) and (`xocp_ehr_patient_extend`.`nip` not in ('UMUM','PC','KJS',',','.','SKTRM','SKM','SIKIB','RSMTH','SKTM','PURN','PT','GAKIN','POLRI','PHL','PCMUM','MOW','LAND','BPJS','KOAS','AVIVA','BNI')) and (length(`xocp_ehr_patient_extend`.`nip`) < 6)) ;

-- ----------------------------
-- View structure for v_nrp_perwira
-- ----------------------------
DROP VIEW IF EXISTS `v_nrp_perwira`;
CREATE   VIEW `v_nrp_perwira` AS select `xocp_ehr_patient_extend`.`patient_id` AS `patient_id`,`xocp_ehr_patient_extend`.`person_id` AS `person_id`,`xocp_ehr_patient_extend`.`nip` AS `nip` from `xocp_ehr_patient_extend` where ((`xocp_ehr_patient_extend`.`nip` like '%/P%') and (`xocp_ehr_patient_extend`.`nip` <> 'UMUM/PC')) ;

-- ----------------------------
-- View structure for v_nrp_perwira_person
-- ----------------------------
DROP VIEW IF EXISTS `v_nrp_perwira_person`;
CREATE   VIEW `v_nrp_perwira_person` AS select `xocp_persons_extended`.`person_id` AS `person_id`,upper(`xocp_persons_extended`.`nip`) AS `no_nrp` from `xocp_persons_extended` where (`xocp_persons_extended`.`nip` like '%/P') ;

-- ----------------------------
-- View structure for v_pendapatan_rawat_jalan
-- ----------------------------
DROP VIEW IF EXISTS `v_pendapatan_rawat_jalan`;
CREATE  SQL SECURITY DEFINER  VIEW `v_pendapatan_rawat_jalan` AS select `a`.`tgl_kunjungan` AS `tanggal`,`a`.`id_poli` AS `id_poli`,`b`.`nm_poli` AS `nm_poli`,count(`a`.`no_register`) AS `jumlah_os`,sum(`a`.`vtot`) AS `penerimaan` from (`pelayanan_poli` `a` join `poliklinik` `b`) where ((`a`.`idtindakan` <> '1B0105') and (`a`.`id_poli` = `b`.`id_poli`)) group by `a`.`tgl_kunjungan`,`a`.`id_poli`,`b`.`nm_poli` ;